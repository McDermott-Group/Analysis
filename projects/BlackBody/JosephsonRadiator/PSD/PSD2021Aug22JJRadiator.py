"""
PSD for Q1, Q2, Q4 at different J2 Bias
Data: Z:\mcdermott-group\data\BlackBody\Circmon\LIU\CW20180514A_Ox2\JJRadiatorQPT_2021Aug19_HighDensity
"""
import numpy as np
import matplotlib.pyplot as plt
from scipy.constants import *
from scipy.optimize import curve_fit
import copy

Q1 = np.array([
 [35000, 2151.223913248844], [35500, 2212.1656848799466], [36000, 2210.6574240381337],
 [36500, 2505.4571345263657], [37000, 2476.81769375745], [37500, 2460.352627326202],
 [38000, 2547.056816688122], [38500, 2240.5164922270956], [39000, 2298.917427895766],
 [39500, 2373.33672018704], [40000, 2402.582961873969], [40500, 2409.6929980971454],
 [41000, 2431.4450793571127], [41500, 2454.681333194384], [42000, 3342.8996226659888],
 [42500, 3804.064263013104], [43000, 4921.923457298181], [43500, 4856.5358651455535],
 [44000, 6058.774274178694], [44500, 5150.483195504591], [45000, 5163.339804285264],
 [45500, 4497.183960012082], [46000, 38454.9916849363], [46500, 75118.8202307727],
 [47000, 75624.20520594664], [47500, 60809.833059361], [48000, 52456.69380908812],
 [48500, 9823.755238004393], [49000, 5271.415795676567], [49500, 10913.935697352423],
 [50000, 9002.090344239683], [50500, 12279.284146689764], [51000, 7593.130292355607],
 [51500, 10338.52422091379], [52000, 5994.199719559468], [52500, 5923.988099607556],
 [53000, 5231.913680999602], [53500, 4958.314602997899], [54000, 5072.522315107639],
 [54500, 5595.507511959154], [55000, 5768.81275927217], [55500, 5607.441650849237],
 [56000, 4874.764489718989], [56500, 4871.679858878061], [57000, 4439.6226785101035],
 [57500, 4399.829642594042], [58000, 4841.670206532665], [58500, 5458.040068802446],
 [59000, 5277.54405195877], [59500, 6468.613298415768], [60000, 6252.289738901227],
 [60500, 4839.290484625988], [61000, 4506.9804560554985], [61500, 5296.17861876259],
 [62000, 5651.082506030512], [62500, 5643.39140022365], [63000, 5637.8738500907575],
 [63500, 5936.783165786847], [64000, 6315.344294867166], [64500, 6376.494221674982],
 [65000, 7191.0519948047695], [65500, 6778.68090593393], [66000, 6303.0775289617895],
 [66500, 6626.8870381143115], [67000, 5411.973391255383], [67500, 4751.568432284155],
 [68000, 5708.731420634559], [68500, 5881.936362495081], [69000, 5658.120374161776],
 [69500, 5334.820476347001], [70000, 5479.888136249025], [70500, 5571.635206200236],
 [71000, 5411.446261011446], [71500, 7589.244228857892], [72000, 7451.641395364322],
 [72500, 6628.031660988422], [73000, 6235.253347483311], [73500, 6609.898197091883],
 [74000, 6193.484171147575], [74500, 5559.171746441616], [75000, 4772.366745561292],
 [75500, 5694.614685790008], [76000, 5663.420582366908], [76500, 5815.42345283711],
 [77000, 5101.326641018132], [77500, 4698.811888645155], [78000, 4767.915216163436],
 [78500, 4937.57574245636], [79000, 5068.209734947231], [79500, 4853.949826477204],
 [80000, 4637.415673165757]
])

Q2 = np.array([
 [35000, 53.46666650665031], [35500, 52.38743969407632], [36000, 51.65051889637061],
 [36500, 51.88259747946914], [37000, 54.16301862218547], [37500, 53.3239318904122],
 [38000, 55.39767246431867], [38500, 53.1118443243885], [39000, 53.27240067857254],
 [39500, 51.77959434284173], [40000, 53.91593205671808], [40500, 51.5293092607057],
 [41000, 52.99901982415338], [41500, 54.637304373883374], [42000, 52.75609797718846],
 [42500, 56.243304811270875], [43000, 57.366833987220616], [43500, 59.9317726892171],
 [44000, 69.33086857967835], [44500, 85.98032488911001], [45000, 117.75907313658547],
 [45500, 155.62910982765177], [46000, 189.99712239985251], [46500, 232.97499466399248],
 [47000, 279.8842824424175], [47500, 306.4090446832212], [48000, 305.1479555257371],
 [48500, 312.95059269636454], [49000, 300.96407941985706], [49500, 303.69823446477926],
 [50000, 285.8053244336719], [50500, 275.7685511633699], [51000, 284.04199315176345],
 [51500, 289.3252595959402], [52000, 270.3705880712379], [52500, 231.34697743295445],
 [53000, 205.28945649346608], [53500, 202.86436831783945], [54000, 213.19366147575184],
 [54500, 222.57126263630914], [55000, 221.84911531022513], [55500, 220.75242956607985],
 [56000, 230.13029911453265], [56500, 249.34523847562355], [57000, 286.93139980153217],
 [57500, 318.2324412493984], [58000, 345.63878921645676], [58500, 388.98601826853616],
 [59000, 463.04710146575167], [59500, 474.78631638718815], [60000, 489.6039380151282],
 [60500, 452.17591588629017], [61000, 447.30831967207826], [61500, 469.38690309112076],
 [62000, 496.50603634118363], [62500, 488.9404863048678], [63000, 466.07391784814183],
 [63500, 454.8636838082383], [64000, 501.84725071312226], [64500, 558.3502495425737],
 [65000, 579.3083308043841], [65500, 603.7537687876137], [66000, 614.0338091366775],
 [66500, 264.0114179289266], [67000, 264.08314729527217], [67500, 442.87429287671176],
 [68000, 464.2155812637689], [68500, 448.1715843412454], [69000, 454.4815945438941],
 [69500, 506.0669447991975], [70000, 561.5524121347078], [70500, 560.8611102683113],
 [71000, 544.6504933204286], [71500, 538.2703946679122], [72000, 531.6217331424541],
 [72500, 519.806371320987], [73000, 472.13034760822296], [73500, 449.8957257840262],
 [74000, 412.77716201000004], [74500, 400.9543105179909], [75000, 409.29465869073516],
 [75500, 405.8607958200277], [76000, 374.93448374410144], [76500, 344.33711864743987],
 [77000, 333.9629785986813], [77500, 382.4622736384103], [78000, 420.585455451075],
 [78500, 442.55405939683726], [79000, 417.7564759411919], [79500, 370.7638020163264],
 [80000, 346.5050670606225]
])

Q4 = np.array([
 [35000, 601.630219534346], [35500, 605.795324723355], [36000, 604.401373229408],
 [36500, 607.696450549826], [37000, 616.3692372297074], [37500, 610.5662128801921],
 [38000, 601.1130989420179], [38500, 609.3826036294797], [39000, 603.6821932129361],
 [39500, 615.9690867615493], [40000, 624.182030976476], [40500, 620.333023699948],
 [41000, 635.2234079314684], [41500, 618.0149328253738], [42000, 606.2725772368011],
 [42500, 609.5205828763409], [43000, 624.7825231797883], [43500, 641.9239121743178],
 [44000, 757.0731726653825], [44500, 878.8824332374088], [45000, 1109.9943024477373],
 [45500, 1311.4062356993218], [46000, 1417.2809296370092], [46500, 1552.8076764652096],
 [47000, 1602.095893325842], [47500, 1669.7827556812101], [48000, 1647.7620177165259],
 [48500, 1642.2938374100424], [49000, 1604.2851178926649], [49500, 1667.483879691195],
 [50000, 2021.316298892738], [50500, 2190.7446540224123], [51000, 2582.2447243851675],
 [51500, 2589.612917324268], [52000, 2223.4999878797657], [52500, 2085.6059664664112],
 [53000, 2051.070875219451], [53500, 2354.526967608225], [54000, 2598.9500258939047],
 [54500, 3141.8819609879147], [55000, 3265.4074632119855], [55500, 3195.103382435114],
 [56000, 2915.633183391033], [56500, 2617.297017383379], [57000, 2574.6523962467763],
 [57500, 2781.414129408141], [58000, 3249.4915949964147], [58500, 3533.0399207644327],
 [59000, 4410.687875700129], [59500, 4398.748106075939], [60000, 4949.094806473707],
 [60500, 5068.133901407311], [61000, 5066.655874089237], [61500, 5310.593199152688],
 [62000, 5721.89725957691], [62500, 5921.815475744155], [63000, 6103.653511679669],
 [63500, 6202.169770689075], [64000, 6605.187813589553], [64500, 6234.856012069277],
 [65000, 5962.131922532773], [65500, 5953.633437669427], [66000, 6168.4605317109335],
 [66500, 6318.93439498317], [67000, 6510.929619347546], [67500, 5889.855948181577],
 [68000, 6016.465699128736], [68500, 6290.145819577267], [69000, 6266.6038425976685],
 [69500, 6370.4267782098605], [70000, 6099.07466037772], [70500, 6178.985316485085],
 [71000, 6552.546134319791], [71500, 7558.316774578503], [72000, 8104.952146890219],
 [72500, 8766.371284889348], [73000, 7722.287745281628], [73500, 7709.926005384103],
 [74000, 7980.774276264403], [74500, 7852.559960048882], [75000, 8307.83558368852],
 [75500, 7411.395311356693], [76000, 6205.195264859387], [76500, 6641.013965300139],
 [77000, 5862.060740378402], [77500, 5667.788442228118], [78000, 5610.981923804451],
 [78500, 5497.883594208294], [79000, 5495.6070390445875], [79500, 5369.581815794456],
 [80000, 5037.0796664490235]
])

### J2 Bias offset
J2_Offset = 19200
Q1[:, 0] = (Q1[:, 0]-J2_Offset)/1000
Q2[:, 0] = (Q2[:, 0]-J2_Offset)/1000
Q4[:, 0] = (Q4[:, 0]-J2_Offset)/1000

plt.plot(Q1[:, 0], Q1[:, 1], label='Q1')
plt.plot(Q2[:, 0], Q2[:, 1], label='Q2')
plt.plot(Q4[:, 0], Q4[:, 1], label='Q4')
plt.xlabel('J2 Bias (mDAC)')
plt.ylabel('QPT (Hz)')
plt.yscale('log')
plt.grid()
plt.legend()
plt.draw()
plt.show()

# plt.plot(Q1[:, 0]*4.8, Q1[:, 1], 'b', label='Q1')
# plt.plot(Q2[:, 0]*4.8, Q2[:, 1], 'r', label='Q2')
# plt.plot(Q4[:, 0]*4.8, Q4[:, 1], 'y', label='Q4')
# plt.xlabel('J2 Bias (GHz)')
# plt.ylabel('QPT (Hz)')
# plt.yscale('log')
# plt.grid()
# plt.legend()
# plt.draw()
# plt.show()
