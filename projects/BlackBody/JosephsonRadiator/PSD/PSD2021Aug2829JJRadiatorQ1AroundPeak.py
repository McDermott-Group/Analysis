"""
PSD for Q1 different J2 Bias
Data: Z:\mcdermott-group\data\BlackBody\Circmon\LIU\CW20180514A_Ox2\JJRadiatorQPT_Q1_AroundPeak_2021Aug28
Data: Z:\mcdermott-group\data\BlackBody\Circmon\LIU\CW20180514A_Ox2\JJRadiatorQPT_Q1_AroundPeak_2021Aug29
"""
import numpy as np
import matplotlib.pyplot as plt
from scipy.constants import *
from scipy.optimize import curve_fit
import copy

Q1 = np.array([
 [20000, 1996.9756131245645], [20500, 2071.9886902246317], [21000, 2215.8361684145625],
 [21500, 2250.7375710072765], [22000, 2217.248263539881], [22500, 2575.9836593367963],
 [23000, 2795.988277848256], [23500, 3791.423052140047], [24000, 4898.611521529102],
 [24500, 5208.858819320278], [25000, 6310.35409651801], [25500, 6434.505600510416],
 [26000, 4181.9735903207575], [26500, 6225.361859165009], [27000, 6710.854116727418],
 [27500, 6720.545921471013], [28000, 9933.310655191954], [28500, 7295.436623819907],
 [29000, 8306.698655444574], [29500, 7102.164567030806], [30000, 6027.09594802035],
 [30500, 5042.8615333307025], [31000, 5022.543899290427], [31500, 6425.060156491959],
 [32000, 5119.48791421246], [32500, 6186.887377709461], [33000, 6069.5094649839975],
 [33500, 5668.82263850093], [34000, 5353.216910207076], [34500, 5296.745915073345],
 [35000, 5115.806383742996], [35500, 5018.1509866947545], [36000, 5476.198591590001],
 [36500, 5672.344083860175], [37000, 5634.032612962461], [37500, 5579.873435952626]
])

Q1_25us = np.array([
 [20000, 2528.616002643253], [20500, 2576.4047287081376], [21000, 2639.9756101026214],
 [21500, 2613.0635624465403], [22000, 2716.7815025913224], [22500, 2911.4272451283045],
 [23000, 3712.512538802446], [23500, 5668.6968650251565], [24000, 8915.681207567659],
 [24500, 10472.464285461341], [25000, 12559.65975645397], [25500, 17358.143470086685],
 [26000, 8985.58358556857], [26500, 6620.323041064103], [27000, 8365.747131466862],
 [27500, 8906.081936865188], [28000, 7596.378471071468], [28500, 8525.081678362132],
 [29000, 9128.332562485002], [29500, 10001.62830116189], [30000, 9186.851271611595],
 [30500, 8978.556179368246], [31000, 7914.405112477464], [31500, 7794.876463193964],
 [32000, 8091.057622044779], [32500, 8332.562059436877], [33000, 8584.753146089452],
 [33500, 7792.102225602153], [34000, 8311.163423521884], [34500, 7955.877425970005],
 [35000, 6819.894287205108], [35500, 7673.841322332407], [36000, 8189.3819273198615],
 [36500, 7551.880655221508], [37000, 7078.251279620181], [37500, 6842.345267876021]
])


"""
5us Serniak's method
[20000, 6518.719702692059], [20500, 6114.057121699991], [21000, 5582.584443790445], [215
00, 6948.300438075432], [22000, 6607.950248326954], [22500, 6812.9657938438095], [23000, 9193.3105771528
35], [23500, 16896.160781663973], [24000, 35153.81867461225], [24500, 46251.04402832115], [25000, 55478.
29913146839], [25500, 57272.317198284625], [26000, 43546.703267241945], [26500, 43360.50044605418], [270
00, 43454.482709950826], [27500, 43664.825732304766], [28000, 43817.33014429711], [28500, 43830.47534656
728], [29000, 43701.45710322319], [29500, 36997.20766977889], [30000, 34812.82533455058], [30500, 33191.
39479515594], [31000, 32926.649630791646], [31500, 33844.08462334368], [32000, 32682.562505892074], [325
00, 31805.26077536895], [33000, 31290.391214321964], [33500, 30623.98782120495], [34000, 29328.129529466
754], [34500, 27985.669477321484], [35000, 27495.833937634172], [35500, 27811.54700529683], [36000, 2793
6.610957796653], [36500, 25693.310770018008], [37000, 24448.718127811313], [37500, 23768.786437215284]]
"""


### J2 Bias offset
Q1[:, 0] = (Q1[:, 0])/1000
Q1_25us[:, 0] = (Q1_25us[:, 0])/1000

# plt.plot(Q1[:, 0], Q1[:, 1], label='Q1')
# plt.xlabel('J2 Bias (mDAC)')
# plt.ylabel('QPT (Hz)')
# plt.yscale('log')
# plt.grid()
# plt.legend()
# plt.draw()
# plt.show()

plt.plot(Q1[:, 0]*4.8, Q1[:, 1], 'b', label='Q1')
plt.plot(Q1_25us[:, 0]*4.8, Q1_25us[:, 1], '-', label='Q1_25us')
plt.xlabel('J2 Bias (GHz)')
plt.ylabel('QPT (Hz)')
plt.yscale('log')
plt.grid()
plt.legend()
plt.draw()
plt.show()
