"""
PSD for Q3 at different J1 Bias with Sim slow bias
Data:
Z:\mcdermott-group\data\Antenna\Circmon\Liu\CW20180514A_Ox2\2021Nov12_QB12_PSD_J6Radiator_Sim
Z:\mcdermott-group\data\Antenna\Circmon\Liu\CW20180514A_Ox2\2021Nov16_QB4_PSD_J6Radiator_Sim
Fitting method Chris' no white noise verison

"""
# import noiselib
import matplotlib.pyplot as plt
import numpy as np


Q1 = np.array([
    [100, 1052.05], [101, 994.09], [102, 1130.75], [103, 1177.19],
    [104, 1278.78], [105, 990.39], [106, 956.49], [107, 998.57],
    [108, 1175.44], [109, 1168.94], [110, 1187.73], [111, 1360.43],
    [112, 1511.22], [113, 2437.21], [114, 3103.57], [115, 3213.09],
    [116, 3886.75], [117, 4354.14], [118, 4494.0], [119, 5019.75],
    [120, 4235.29], [121, 4525.35], [122, 4703.88], [123, 4993.07],
    [124, 5314.9], [125, 5298.74], [126, 5463.93], [127, 5372.58],
    [128, 5101.32], [129, 4812.31], [130, 4808.29], [131, 4847.66],
    [132, 4391.1], [133, 4412.66], [134, 4451.26], [135, 4334.86],
    [136, 4637.48], [137, 4317.38], [138, 4234.5], [139, 4221.08],
    [140, 4103.44], [141, 3901.47], [142, 3238.21], [143, 2785.98],
    [144, 2808.73], [145, 2562.81], [146, 2923.52], [147, 3015.6],
    [148, 2574.13], [149, 2773.08], [150, 2355.77], [151, 2236.91],
    [152, 2448.48], [153, 2581.39], [154, 2904.8], [155, 3137.19],
    [156, 2960.03], [157, 2958.74], [158, 2360.0], [159, 2332.91]
])

Q1_more = np.array([
    [110, 1607.39], [111, 1982.19], [112, 2403.21], [113, 3770.99],
    [114, 4438.01], [115, 5040.58], [116, 5487.61], [117, 6104.62],
    [118, 6889.66], [119, 6926.0], [120, 6935.57], [121, 6977.97],
    [122, 7031.74], [123, 7393.72], [124, 8293.37], [125, 8413.91],
    [126, 8576.31], [127, 7407.82], [128, 7559.76], [129, 6466.41],
    [130, 6776.87], [131, 6170.39], [132, 5307.77], [133, 5266.28],
    [134, 5535.83], [135, 6109.87], [136, 6413.39], [137, 6528.2],
    [138, 6189.99], [139, 6113.66], [140, 5435.17], [141, 4902.14],
    [142, 4432.39], [143, 3696.85], [144, 3601.12], [145, 3400.63],
    [146, 3633.08], [147, 3747.35], [148, 3253.48], [149, 2580.76],
    [190, 2712.98], [191, 3343.63], [192, 3965.66], [193, 3526.7],
    [194, 4057.34], [195, 3731.98], [196, 4412.84], [197, 4059.0],
    [198, 5000.0], [199, 4065.36], [200, 3707.33], [201, 3754.03],
    [202, 3601.05], [203, 4212.21], [204, 3717.53], [205, 3950.32],
    [206, 3712.01], [207, 2978.32], [208, 4187.41], [209, 3703.97],
    [210, 3717.2], [211, 3657.37], [212, 3867.26], [213, 3649.75],
    [214, 3671.54], [215, 4066.59], [216, 3852.64], [217, 4007.28],
    [218, 3665.95], [219, 4156.61], [220, 4662.99], [221, 4729.31],
    [222, 4593.08], [223, 5000.0], [224, 3746.5], [225, 5000.0],
    [226, 3715.21], [227, 5000.0], [228, 2624.96], [229, 4006.45],
    [230, 5000.0], [231, 3527.93], [232, 5000.0], [233, 4342.26],
    [234, 3825.03], [235, 3579.55], [236, 3736.42], [237, 3882.26],
    [238, 3602.73], [239, 4171.92], [240, 3266.29], [241, 2637.08],
    [242, 4080.17], [243, 2490.76], [244, 3088.77], [245, 2332.98],
    [246, 2643.64], [247, 3477.96], [248, 2401.95], [249, 2663.83],
    [250, 2763.21], [251, 3375.52], [252, 2143.02], [253, 2112.19],
    [254, 2088.49], [255, 3785.41], [256, 3804.52], [257, 3775.67],
    [258, 3528.98], [259, 3480.4]
])

Q2 = np.array([
    [100, 13.11], [101, 12.75], [102, 12.69], [103, 13.92],
    [104, 13.64], [105, 14.23], [106, 13.18], [107, 12.96],
    [108, 13.29], [109, 13.28], [110, 11.68], [111, 12.93],
    [112, 13.04], [113, 13.01], [114, 13.45], [115, 14.82],
    [116, 13.71], [117, 14.97], [118, 13.87], [119, 15.0],
    [120, 15.47], [121, 16.21], [122, 18.7], [123, 18.86],
    [124, 23.57], [125, 27.39], [126, 37.9], [127, 55.55],
    [128, 67.65], [129, 73.19], [130, 74.92], [131, 73.96],
    [132, 67.99], [133, 68.15], [134, 68.37], [135, 70.49],
    [136, 66.44], [137, 61.02], [138, 52.17], [139, 41.28],
    [140, 43.8], [141, 49.13], [142, 53.32], [143, 56.29],
    [144, 57.87], [145, 52.92], [146, 45.66], [147, 38.08],
    [148, 35.56], [149, 33.36], [150, 34.29], [151, 35.24],
    [152, 37.22], [153, 37.85], [154, 38.52], [155, 32.9],
    [156, 30.37], [157, 28.61], [158, 26.11], [159, 26.77],
    [190, 72.61], [191, 77.32], [192, 82.98], [193, 90.34], [194, 90.21],
    [195, 88.22], [196, 87.52], [197, 81.3], [198, 83.93], [199, 94.41],
    [200, 102.31], [201, 109.18], [202, 118.5], [203, 129.44], [204, 135.85],
    [205, 131.97], [206, 132.06], [207, 140.73], [208, 142.44], [209, 154.5],
    [210, 151.67], [211, 146.57], [212, 126.84], [213, 112.95], [214, 95.41],
    [215, 93.94], [216, 102.87], [217, 112.68], [218, 121.79], [219, 131.02],
    [220, 131.6], [221, 130.55], [222, 129.58], [223, 127.63], [224, 130.44],
    [225, 130.31], [226, 118.77], [227, 107.98], [228, 99.64], [229, 89.17],
    [230, 89.95], [231, 94.07], [232, 93.78], [233, 105.62], [234, 112.15],
    [235, 114.45], [236, 114.71], [237, 115.7], [238, 113.03], [239, 109.53],
    [240, 99.25], [241, 89.52], [242, 83.83], [243, 86.1], [244, 92.32],
    [245, 95.01], [246, 97.56], [247, 95.24], [248, 88.16], [249, 80.29],
    [250, 82.02], [251, 79.11], [252, 73.85], [253, 74.39], [254, 68.27],
    [255, 66.89], [256, 72.48], [257, 79.31], [258, 88.06], [259, 94.14],
    [370, 424.32], [371, 435.69], [372, 451.22], [373, 448.08],
    [374, 443.2], [375, 463.24], [376, 478.09], [377, 528.56],
    [378, 562.57], [379, 611.82], [380, 630.54], [381, 646.14], [382, 611.16],
    [383, 577.31], [384, 554.93], [385, 544.71], [386, 537.25], [387, 538.16],
    [388, 537.84], [389, 558.88], [390, 586.5], [391, 607.29], [392, 627.14],
    [393, 650.98], [394, 622.33], [395, 606.02], [396, 576.95], [397, 565.76],
    [398, 547.17], [399, 562.44], [400, 581.33], [401, 602.31], [402, 612.38],
    [403, 611.63], [404, 583.25], [405, 575.03], [406, 565.28], [407, 578.89],
    [408, 567.22], [409, 564.13], [410, 548.54], [411, 531.58], [412, 538.76],
    [413, 543.79], [414, 526.8], [415, 496.43], [416, 466.79], [417, 433.94],
    [418, 399.96], [419, 369.39]
])

Q4 = np.array([
    [100, 188.35], [101, 187.61], [102, 195.18], [103, 190.41], [104, 177.83],
    [105, 187.16], [106, 188.59], [107, 189.4], [108, 185.53], [109, 190.91],
    [110, 193.03], [111, 189.56], [112, 193.06], [113, 200.88], [114, 191.3],
    [115, 199.39], [116, 211.38], [117, 203.22], [118, 202.43], [119, 214.33],
    [120, 222.98], [121, 226.76], [122, 249.19], [123, 270.47], [124, 298.19],
    [125, 314.43], [126, 323.17], [127, 315.28], [128, 317.54], [129, 284.19],
    [130, 286.75], [131, 308.32], [132, 338.1], [133, 354.99], [134, 382.34],
    [135, 410.27], [136, 441.78], [137, 441.81], [138, 425.16], [139, 417.86],
    [140, 419.6], [141, 430.34], [142, 434.11], [143, 457.48], [144, 496.29],
    [145, 554.5],[146, 622.18], [147, 636.6], [148, 649.35], [149, 613.71],
    [150, 613.66], [151, 521.99], [152, 447.96], [153, 429.86], [154, 389.44],
    [155, 353.64], [156, 335.1], [157, 330.95], [158, 313.67], [159, 321.17],
    [160, 322.1], [161, 331.83], [162, 358.2], [163, 370.58], [164, 411.84],
    [165, 452.2], [166, 517.39], [167, 561.87], [168, 591.43], [169, 631.99],
    [170, 626.89], [171, 649.92], [172, 658.29], [173, 680.51], [174, 742.0],
    [175, 794.37], [176, 841.79], [177, 880.51], [178, 909.86], [179, 877.46],
    [180, 827.22], [181,781.93], [182, 718.03], [183, 706.5], [184, 665.06],
    [185, 680.14], [186, 711.79], [187, 763.37], [188, 857.72], [189, 958.31],
    [190, 1121.29], [191, 1259.57], [192, 1402.13], [193, 1585.02],
    [194, 1724.56], [195, 1807.01], [196, 1905.96], [197, 2138.46],
    [198, 2519.84], [199, 2832.7], [200, 2888.31], [201, 2741.04],
    [202, 2629.58], [203, 2555.97], [204, 2384.76], [205, 2290.22],
    [206, 2195.15], [207, 2206.22], [208, 2364.55], [209, 2851.54],
    [210, 3411.17], [211, 3851.77], [212, 3973.47], [213, 3591.88],
    [214, 3441.93], [215, 3099.8], [216, 3014.45], [217, 2963.9],
    [218, 2685.47], [219, 2392.91], [220, 2038.97], [221, 2117.89],
    [222, 2552.78], [223, 3186.34], [224, 3606.24], [225, 3978.43],
    [226, 4109.66], [227, 4029.8], [228, 3326.07], [229, 3004.91],
    [230, 2809.72], [231, 2867.8], [232, 2920.65], [233, 2953.03],
    [234, 3035.47], [235, 3051.13], [236, 3113.38], [237, 3177.69],
    [238, 3217.11], [239, 2929.75], [240, 2601.39], [241, 2390.7],
    [242, 2413.07], [243, 2516.08], [244, 2556.96], [245, 2558.21],
    [246, 2498.99], [247, 2371.49], [248, 2233.19], [249, 2156.98],
    [250, 2073.11], [251, 2018.16], [252, 1937.87], [253, 2028.62],
    [254, 2173.5], [255, 2225.2], [256, 2337.99], [257, 2270.29],
    [258, 2244.96], [259, 2175.65], [260, 2056.09], [261, 1702.34],
    [262, 1857.98], [263, 1927.2], [264, 2024.01], [265, 2055.97],
    [266, 2008.98], [267, 1917.07], [268, 1882.28], [269, 1797.88],
    [270, 1673.42], [271, 1675.35], [272, 1746.86], [273, 1979.45],
    [274, 2335.97], [275, 2392.5], [276, 2322.51], [277, 2406.39],
    [278, 2410.94], [279, 2423.96], [280, 2501.41], [281, 2453.17],
    [282, 2422.49], [283, 2270.07], [284, 2079.47], [285, 1899.68],
    [286, 1838.08], [287, 1698.0], [288, 1682.98], [289, 1618.55],
    [290, 1588.16], [291, 1566.87], [292, 1569.13], [293, 1571.18],
    [294, 1643.36], [295, 1674.65], [296, 1646.59], [297, 1519.11],
    [298, 1410.92], [299, 1300.81], [300, 1202.26], [301, 1124.25],
    [302, 1108.24],[303, 1089.39], [304, 1119.99], [305, 1141.29],
    [306, 1200.96], [307, 1269.79], [308, 1362.76], [309, 1328.32],
    [310, 1328.02], [311, 1263.45], [312, 1114.8], [313, 1006.81],
    [314, 1001.38], [315, 1166.75], [316, 1338.28], [317, 1408.25],
    [318, 1505.44], [319, 1581.65], [320, 1634.17], [321, 1631.55],
    [322, 1720.08], [323, 1742.7], [324, 1806.45],[325, 1822.06],
    [326, 1795.59], [327, 1705.5], [328, 1622.11], [329, 1542.17],
    [330, 1404.73], [331, 1330.87], [332, 1199.66], [333, 1145.83],
    [334, 1148.36], [335, 1081.93],[336, 1067.33], [337, 1080.63],
    [338, 1123.11], [339, 1239.36], [340, 1401.92], [341, 1550.18],
    [342, 1536.24], [343, 1500.7], [344, 1451.1], [345, 1280.73],
    [346, 1179.11], [347, 1136.46], [348, 1154.35], [349, 1155.85],
    [350, 1171.48], [351, 1153.09], [352, 1090.9], [353, 1016.95],
    [354, 945.88], [355, 905.88], [356, 828.69], [357, 762.21],
    [358, 765.96], [359, 724.94], [360, 723.54]
])

### J1 Bias Conversion
# Q3[:, 0] = (Q3[:, 0])

# plt.plot(Q3[:, 0], Q3[:, 1], color='y', label='Q3')
# plt.xlabel('Radiator Josephson Frequency (mDAC)')
# plt.ylabel('PSD (Hz)')
# plt.yscale('log')
# plt.grid()
# plt.legend(loc=1)
# plt.show()

np.savetxt('2021OctSFQWeakRadiatorWiggles_Q1_PSD_Data.txt', Q1)
np.savetxt('2021OctSFQWeakRadiatorWiggles_Q2_PSD_Data.txt', Q2)
np.savetxt('2021OctSFQWeakRadiatorWiggles_Q4_PSD_Data.txt', Q4)

# # f = 1
# f = 0.9676
# Al_gap = 380e-6
# DAC_Al = 1e5*Al_gap/0.200
# d = 2 # for plotting purpose only
# # plt.plot(Q1[:, 0]*f, Q1[:, 1]/d, color='b', label='Q1')
# plt.plot(Q1[:, 0]*f, Q1[:, 1], color='b', label='Q1')
# plt.plot(Q1_more[:, 0]*f, Q1_more[:, 1], color='y', label='Q1')
# plt.plot(Q2[:, 0]*f, Q2[:, 1], color='r', label='Q2')
# plt.plot(Q4[:, 0]*f, Q4[:, 1], color='k', label='Q4')
#
# plt.axvline(x=DAC_Al * f, color='k', linestyle='--', linewidth=4, label='JJ Al Gap')
#
# plt.xlabel('Radiator Josephson Frequency (GHz)')
# plt.ylabel('PSD (Hz)')
# plt.yscale('log')
# plt.grid(True, which="both")
# plt.title('SFQ J6 Wiggles')
# plt.legend(loc=1)
# # plt.xlim([0, 1500])
# # plt.ylim([10, 100000])
# plt.show()



