"""
P1 for Q1, Q2, Q3 at different J7 Bias
Data:
Z:\mcdermott-group\data\Antenna\SUXmon2\Liu\VitoChip2\P12021Oct26_Q123WithJ7_V2

"""
import noiselib
import matplotlib.pyplot as plt
import numpy as np


Q1 = np.array([
 [0.0, 0.0365, 0.00801], [0.002, 0.40399, 0.00886], [0.004, 0.23132, 0.0196],
 [0.006, 0.24123, 0.01898], [0.008, 0.21862, 0.01345], [0.01, 0.2048, 0.02014],
 [0.012, 0.19947, 0.01868], [0.014, 0.21167, 0.02159], [0.016, 0.20865, 0.01508],
 [0.018, 0.20313, 0.02284], [0.02, 0.2109, 0.02256], [0.022, 0.22891, 0.02277],
 [0.024, 0.2061, 0.02576], [0.026, 0.21836, 0.01801], [0.028, 0.22411, 0.01448],
 [0.03, 0.22664, 0.01821], [0.032, 0.248, 0.01572], [0.034, 0.22118, 0.01836],
 [0.036, 0.22765, 0.02093], [0.038, 0.20744, 0.01495], [0.04, 0.12003, 0.01023],
 [0.042, 0.14061, 0.00962], [0.044, 0.20332, 0.01316], [0.046, 0.21673, 0.02157],
 [0.048, 0.2245, 0.01319], [0.05, 0.23501, 0.00959], [0.052, 0.24593, 0.01387],
 [0.054, 0.24653, 0.0128], [0.056, 0.25271, 0.01046], [0.058, 0.25308, 0.01524],
 [0.06, 0.24689, 0.0157], [0.062, 0.23133, 0.01816], [0.064, 0.23461, 0.01885],
 [0.066, 0.2274, 0.02218], [0.068, 0.23864, 0.01061], [0.07, 0.24123, 0.01686],
 [0.072, 0.23505, 0.01832], [0.074, 0.24044, 0.00993], [0.076, 0.23777, 0.02824],
 [0.078, 0.23243, 0.01983], [0.08, 0.24406, 0.0155], [0.082, 0.245, 0.01651],
 [0.084, 0.24124, 0.01548], [0.086, 0.2446, 0.01363], [0.088, 0.23096, 0.02439],
 [0.09, 0.23875, 0.01407], [0.092, 0.24438, 0.01375], [0.094, 0.24166, 0.01738],
 [0.096, 0.24218, 0.0139], [0.098, 0.23557, 0.00957], [0.1, 0.24546, 0.01137],
 [0.1025, 0.25808, 0.00966], [0.105, 0.25001, 0.00978], [0.1075, 0.24553, 0.01481],
 [0.11, 0.24815, 0.00918], [0.1125, 0.25255, 0.00994], [0.115, 0.24911, 0.00848],
 [0.1175, 0.25375, 0.01918], [0.12, 0.2521, 0.01014], [0.1225, 0.25788, 0.01239],
 [0.125, 0.25045, 0.01352], [0.1275, 0.25203, 0.0081], [0.13, 0.25626, 0.01237],
 [0.1325, 0.25338, 0.00958], [0.135, 0.24896, 0.01559], [0.1375, 0.24063, 0.02182],
 [0.14, 0.2597, 0.01091], [0.1425, 0.259, 0.01533], [0.145, 0.26538, 0.00784],
 [0.1475, 0.26072, 0.00815], [0.15, 0.259, 0.01217], [0.1525, 0.25818, 0.01135],
 [0.155, 0.26976, 0.01089], [0.1575, 0.26466, 0.01376], [0.16, 0.26174, 0.01479],
 [0.1625, 0.26925, 0.01244], [0.165, 0.26799, 0.01886], [0.1675, 0.27289, 0.00781],
 [0.17, 0.27039, 0.02061], [0.1725, 0.27671, 0.01263], [0.175, 0.26677, 0.01231],
 [0.1775, 0.26763, 0.01893], [0.18, 0.27108, 0.01189], [0.1825, 0.27327, 0.01495],
 [0.185, 0.27728, 0.01142], [0.1875, 0.26784, 0.00959], [0.19, 0.27898, 0.01274],
 [0.1925, 0.275,0.01413], [0.195, 0.2741, 0.01465], [0.1975, 0.27076, 0.0125],
 [0.2, 0.2877, 0.01282], [0.2025, 0.2818, 0.00841], [0.205, 0.28633, 0.01094],
 [0.2075, 0.27579, 0.02551], [0.21, 0.28896, 0.01398], [0.2125, 0.28983, 0.01229],
 [0.215, 0.27858, 0.0172], [0.2175, 0.28503, 0.00971], [0.22, 0.28726, 0.01248],
 [0.2225, 0.28768, 0.00992], [0.225, 0.27925, 0.01369], [0.2275, 0.29065, 0.0136],
 [0.23, 0.28697, 0.01795], [0.2325,0.28666, 0.01006], [0.235, 0.27704, 0.01728],
 [0.2375, 0.29058, 0.01314], [0.24, 0.2937, 0.01234], [0.2425, 0.29281, 0.01326],
 [0.245, 0.29572, 0.01341], [0.2475, 0.29119, 0.01906], [0.25, 0.29036, 0.01861],
 [0.2525, 0.29807, 0.01143], [0.255, 0.28733, 0.0228], [0.2575, 0.29342, 0.011],
 [0.26, 0.28655, 0.01214], [0.2625, 0.2925, 0.02117], [0.265, 0.29695, 0.01572],
 [0.2675, 0.29084, 0.01192], [0.27, 0.2884, 0.01803], [0.2725, 0.30232, 0.01682],
 [0.275, 0.29981, 0.00957], [0.2775, 0.29424, 0.02104],[0.28, 0.29746, 0.00863],
 [0.2825, 0.30205, 0.01327], [0.285, 0.29935, 0.01474], [0.2875, 0.29988, 0.00944],
 [0.29, 0.30114, 0.01738], [0.2925, 0.29902, 0.01225], [0.295, 0.30325, 0.01368],
 [0.2975, 0.30419, 0.01094]
])

Q2 = np.array([
 [0.0, 0.01324, 0.00523], [0.002, 0.1017, 0.01022], [0.004, 0.03453, 0.02986],
 [0.006, 0.02023, 0.00572], [0.008, 0.01398, 0.00329], [0.01, 0.01816, 0.0037],
 [0.012, 0.01632, 0.00521], [0.014, 0.0146, 0.00427], [0.016, 0.01733, 0.0031],
 [0.018, 0.01177, 0.00289], [0.02, 0.01484, 0.00529], [0.022, 0.04099, 0.00572],
 [0.024, 0.01886, 0.00399], [0.026, 0.02033, 0.00433], [0.028, 0.03265, 0.006],
 [0.03, 0.04755, 0.00431],[0.032, 0.06248, 0.00828], [0.034, 0.04491, 0.00551],
 [0.036, 0.05199, 0.00875], [0.038, 0.05466, 0.00672], [0.04, 0.0452, 0.00471],
 [0.042, 0.02874, 0.00477], [0.044, 0.02584, 0.00619], [0.046, 0.03557, 0.00556],
 [0.048, 0.04636, 0.00434], [0.05, 0.05918, 0.00722], [0.052, 0.0493, 0.00361],
 [0.054, 0.06984, 0.01119], [0.056, 0.07581, 0.00773], [0.058, 0.0704, 0.00819],
 [0.06, 0.04102, 0.00491], [0.062, 0.03525, 0.00632], [0.064, 0.03441, 0.00445],
 [0.066, 0.02806, 0.00451], [0.068, 0.02943, 0.00508], [0.07, 0.02911, 0.00449],
 [0.072, 0.02379, 0.00718], [0.074, 0.02499, 0.00406], [0.076, 0.0257, 0.00421],
 [0.078, 0.02434, 0.00598], [0.08, 0.02537, 0.0039], [0.082, 0.02456, 0.00532],
 [0.084, 0.0243, 0.00543], [0.086, 0.02196, 0.0041], [0.088, 0.02152, 0.00524],
 [0.09, 0.02242, 0.00747], [0.092, 0.02145, 0.00446], [0.094, 0.02146, 0.0059],
 [0.096, 0.02134, 0.00538], [0.098, 0.02142, 0.0049], [0.1, 0.02069, 0.00384],
 [0.1025, 0.02184, 0.00472], [0.105, 0.02081, 0.00382], [0.1075, 0.02211, 0.00428],
 [0.11, 0.02238, 0.00408], [0.1125, 0.02204, 0.00423], [0.115, 0.02007, 0.00508],
 [0.1175, 0.02154, 0.00513], [0.12, 0.02498, 0.00515], [0.1225, 0.0232, 0.00492],
 [0.125, 0.02203, 0.00574], [0.1275, 0.02282,0.00555], [0.13, 0.02295, 0.00645],
 [0.1325, 0.02184, 0.00264], [0.135, 0.02074, 0.00417], [0.1375, 0.02195, 0.0031],
 [0.14, 0.02377, 0.00742], [0.1425, 0.02365, 0.00784], [0.145, 0.02329, 0.00695],
 [0.1475, 0.02618, 0.00465], [0.15, 0.02482, 0.00479], [0.1525, 0.0288, 0.00762],
 [0.155, 0.03557, 0.00991], [0.1575, 0.03315, 0.00649], [0.16, 0.04012, 0.0074],
 [0.1625, 0.04102, 0.00845], [0.165, 0.03854, 0.00798], [0.1675, 0.04003, 0.00917],
 [0.17, 0.04145, 0.00746], [0.1725, 0.04619, 0.0077], [0.175, 0.0424, 0.00846],
 [0.1775, 0.0448, 0.00863], [0.18, 0.04658, 0.0074], [0.1825, 0.05343, 0.00678],
 [0.185, 0.04781, 0.0078], [0.1875, 0.04913, 0.00922], [0.19, 0.0521, 0.00855],
 [0.1925, 0.05248, 0.00736], [0.195, 0.05597, 0.00773], [0.1975, 0.05745, 0.00935],
 [0.2, 0.05253, 0.00522], [0.2025, 0.05864, 0.00632], [0.205, 0.05102, 0.00575],
 [0.2075, 0.05238, 0.01016], [0.21, 0.05728, 0.01115], [0.2125, 0.0577, 0.01569],
 [0.215, 0.06162, 0.00926], [0.2175, 0.06362, 0.00755], [0.22, 0.06736, 0.00709],
 [0.2225, 0.05877, 0.00848], [0.225, 0.06243, 0.01423], [0.2275, 0.06131, 0.01301],
 [0.23, 0.06174, 0.01422], [0.2325, 0.05976, 0.01524], [0.235, 0.06241, 0.00883],
 [0.2375, 0.06427, 0.00939], [0.24, 0.06521, 0.01086], [0.2425, 0.06114, 0.01215],
 [0.245, 0.06833, 0.00953], [0.2475, 0.05877, 0.0133], [0.25, 0.06659, 0.00821],
 [0.2525, 0.07315, 0.01656], [0.255, 0.06676, 0.01306], [0.2575, 0.06727, 0.00911],
 [0.26, 0.07056, 0.01135], [0.2625, 0.06335, 0.01189], [0.265, 0.07198, 0.0147],
 [0.2675, 0.07184, 0.01054], [0.27, 0.07505, 0.00917], [0.2725, 0.06833, 0.01191],
 [0.275, 0.06591, 0.0128], [0.2775, 0.07459, 0.01029], [0.28, 0.06449, 0.01287],
 [0.2825, 0.07448, 0.00941], [0.285, 0.0708, 0.00968], [0.2875, 0.07372, 0.01315],
 [0.29, 0.07446, 0.01081], [0.2925, 0.07279, 0.01811], [0.295, 0.06103, 0.00794],
 [0.2975, 0.06592, 0.0061]
])

Q3 = np.array([
 [0.0, 0.10635, 0.01361], [0.002, 0.1326, 0.00895], [0.004, 0.12129, 0.01124], 
 [0.006, 0.10833, 0.0144], [0.008, 0.101, 0.00971], [0.01, 0.10755, 0.0125],
 [0.012, 0.10553, 0.01257], [0.014, 0.10766, 0.00699], [0.016, 0.1022, 0.01153], 
 [0.018, 0.10654, 0.01548], [0.02, 0.10487, 0.00789], [0.022, 0.11969, 0.0127], 
 [0.024, 0.10721, 0.01285], [0.026, 0.11127, 0.01304], [0.028, 0.11072, 0.01519], 
 [0.03, 0.10979, 0.01604], [0.032, 0.12063, 0.01061], [0.034, 0.12851, 0.01579], 
 [0.036, 0.12044, 0.0099], [0.038, 0.1289, 0.0126], [0.04, 0.12086, 0.00821], 
 [0.042, 0.06255, 0.00762], [0.044, 0.06575, 0.01235], [0.046, 0.06666, 0.00824], 
 [0.048, 0.07176, 0.01126], [0.05, 0.08359, 0.00961], [0.052, 0.07423, 0.01237], 
 [0.054, 0.07929, 0.00744], [0.056, 0.08179, 0.00671], [0.058, 0.1001, 0.02096], 
 [0.06, 0.08059, 0.00751], [0.062,0.07021, 0.00888], [0.064, 0.06402, 0.00887], 
 [0.066, 0.05945, 0.00911], [0.068, 0.07187, 0.00894], [0.07, 0.05963, 0.00802], 
 [0.072, 0.06618, 0.01809], [0.074, 0.06415, 0.00699], [0.076, 0.06134, 0.00812], 
 [0.078, 0.05825, 0.0067], [0.08, 0.06264, 0.00738], [0.082, 0.06875, 0.00734], 
 [0.084, 0.05981, 0.00513], [0.086, 0.06303, 0.0101], [0.088, 0.05734, 0.00906], 
 [0.09, 0.05729, 0.00773], [0.092, 0.05946, 0.01163], [0.094, 0.06837, 0.01159], 
 [0.096, 0.06392, 0.01308], [0.098, 0.06839, 0.01154], [0.1, 0.06547, 0.01071], 
 [0.105, 0.07382, 0.01008], [0.11, 0.07473, 0.01161], [0.115, 0.08601, 0.01581], 
 [0.12, 0.07903, 0.00784], [0.125, 0.08282, 0.01333], [0.13, 0.09732, 0.04585], 
 [0.135, 0.08944, 0.02794], [0.14, 0.09469, 0.02191], [0.145, 0.10125, 0.02411], 
 [0.15, 0.09795, 0.01765], [0.155, 0.10507, 0.02699], [0.16, 0.11004, 0.03301], 
 [0.165, 0.12157, 0.02465], [0.17, 0.13628, 0.02877], [0.175, 0.13363, 0.02892], 
 [0.18, 0.12848, 0.02291], [0.185, 0.11869, 0.02771], [0.19, 0.13675, 0.03678], 
 [0.195, 0.11687, 0.01791], [0.2, 0.14012, 0.02138], [0.205, 0.1299, 0.03079], 
 [0.21, 0.14059, 0.0272], [0.215, 0.15153, 0.02848], [0.22, 0.16411, 0.03019], 
 [0.225, 0.17286, 0.0323], [0.23, 0.16914, 0.02481], [0.235, 0.17697, 0.01923], 
 [0.24, 0.18349, 0.03729], [0.245, 0.17195, 0.0303]
])

### J7 Bias Conversion
Q1[:, 0] = (Q1[:, 0])*1000
Q2[:, 0] = (Q2[:, 0])*1000
Q3[:, 0] = (Q3[:, 0])*1000


# f = 4.604
f = 1
Al_gap = 380e-6
DAC_Al = 1e5*Al_gap/0.952
plt.errorbar(Q1[:, 0]*f, Q1[:, 1], yerr=Q1[:, 2]/np.sqrt(10), color='b', label='Q1')
plt.errorbar(Q2[:, 0]*f, Q2[:, 1], yerr=Q2[:, 2]/np.sqrt(10), color='r', label='Q2')
plt.errorbar(Q3[:, 0]*f, Q3[:, 1], yerr=Q3[:, 2]/np.sqrt(10), color='y', label='Q3')

plt.axvline(x=DAC_Al * f, color='k', linestyle='--', linewidth=4, label='JJ Al Gap')

# plt.xlabel('Radiator Josephson Frequency (GHz)')
plt.xlabel('Radiator Josephson Bias (mDAC)')
plt.ylabel('P1')
plt.yscale('log')
plt.grid()
plt.legend(loc=1)
# plt.xlim([0, 1500])
# plt.ylim([10, 100000])
plt.show()



