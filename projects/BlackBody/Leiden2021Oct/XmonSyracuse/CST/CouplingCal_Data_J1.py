from antennalib import AntennaCoupling, getNoiseBandwidth, getTbb, getPhotonRate
from scipy import interpolate
import matplotlib.pyplot as plt
import numpy as np

### parameters to be tuned
e_eff = 6  # limit (1, 6.5), the voltage can also be built in to have a larger range
C_eff = 75 * 1e-21  # Commonly used (50-100)
Jbias_offset = 1  # mDAC should be +-1 mDAC basically +-5 GHz
k = 1  # Coupling between radiator and receiver, this could be larger than one due to the
# fact we can generate QPs locally at the recevier's test pad

k1 = 0.0  # coupling between on chip phonon mitigation
f_SIM = 0.96758 * 1
f_AWG = 4.604 * 1.05  # P1 AWG Bias freq conversion
### parameteres tuned done

# JJ7 = [4.2*1e3, None, 0, 1000*150]   #[R, L, C, A] strong radiator
JJ1 = [33 * 1e3, None, 0, 180 * 150, "Radiator"]  # [R, L, C, A] weak radiator
JQ1 = [17.1 * 1e3, None, 0, 360 * 150, "Receiver"]
JQ2 = [16.6 * 1e3, None, 0, 360 * 150, "Receiver"]  #

fileJ1 = "xmon_full-chip_JJ1.txt"
fileQ1 = "xmon_full-chip_Q1.txt"
fileQ2 = "xmon_full-chip_Q2.txt"

J1 = AntennaCoupling()
J1.import_data(fileJ1, JJ1, C_eff=C_eff)
f = J1.Antenna["f"]
ecJ1 = J1.e_c_dB
eJ1 = J1.e_c
pgJ1 = J1.p_g
refJ1 = J1.ref

Q1 = AntennaCoupling()
Q1.import_data(fileQ1, JQ1, C_eff=C_eff)
f_Q1 = Q1.Antenna["f"]
eQ1 = Q1.e_c

Q2 = AntennaCoupling()
Q2.import_data(fileQ2, JQ2, C_eff=C_eff)
f_Q2 = Q2.Antenna["f"]
ecQ2 = Q2.e_c_dB
eQ2 = Q2.e_c

Q1_PSD = np.array([
    [0, 84.71], [10, 83.96], [20, 84.23], [30, 86.4], [40, 87.31], [50, 86.84],
    [60, 90.49], [70, 84.87], [80, 93.37], [90, 92.26], [100, 85.84],
    [105, 88.58],
    [110, 93.15], [115, 93.18], [120, 88.24], [125, 93.81], [130, 92.1],
    [135, 93.12], [140, 94.12], [145, 90.95], [150, 96.23], [155, 93.09],
    [160, 92.57], [165, 95.28], [170, 108.53], [175, 112.48], [180, 110.56],
    [185, 117.12], [190, 111.76], [195, 146.9], [200, 152.27], [205, 110.88],
    [210, 142.96], [215, 114.6], [220, 118.28], [225, 106.11], [230, 113.76],
    [235, 104.71], [240, 116.44], [245, 119.01], [250, 118.85], [255, 162.85],
    [260, 140.35], [265, 190.56], [270, 238.27], [275, 357.13], [280, 510.46],
    [285, 423.02], [290, 402.21], [295, 345.57], [300, 287.87], [305, 276.92],
    [310, 177.41], [315, 199.65], [320, 174.54], [325, 156.87], [330, 153.4],
    [335, 142.36], [340, 123.98], [345, 134.24], [350, 120.66], [355, 124.7],
    [360, 129.66], [365, 111.69], [370, 117.6], [375, 108.47], [380, 118.24],
    [385, 119.4], [390, 113.81], [395, 109.55], [400, 112.85], [405, 109.8],
    [410, 110.58], [415, 119.61], [420, 111.42], [425, 115.35], [430, 113.22],
    [435, 127.26], [440, 112.25], [445, 118.91], [450, 113.65], [455, 120.86],
    [460, 130.0], [465, 122.4], [470, 125.93], [475, 135.96], [480, 135.86],
    [485, 121.83], [490, 130.17], [495, 141.74], [500, 143.77], [505, 139.33],
    [510, 143.33], [515, 144.14], [520, 150.08], [525, 146.87], [530, 152.72],
    [535, 166.69], [540, 155.28], [545, 153.44], [550, 156.55], [555, 158.48],
    [560, 159.86], [565, 162.99], [570, 168.99], [575, 169.96], [580, 169.83],
    [585, 171.79], [590, 183.36], [595, 187.39], [600, 197.38], [605, 199.21],
    [610, 197.96], [615, 207.83], [620, 205.61], [625, 215.06], [630, 218.58],
    [635, 219.62], [640, 225.89], [645, 224.15], [650, 239.1], [655, 241.98],
    [660, 253.27], [665, 258.87], [670, 257.35], [675, 261.22], [680, 277.17],
    [685, 273.35], [690, 289.32], [695, 285.94]
])

Q2_PSD = np.array([
    [0, 110.14], [10, 111.85], [20, 114.09], [30, 116.76], [40, 107.05],
    [50, 112.69], [60, 114.63], [70, 113.18], [80, 110.73], [90, 113.29],
    [100, 106.33], [105, 112.73], [110, 114.87], [115, 115.11], [120, 113.82],
    [125, 115.83], [130, 113.27], [135, 110.61], [140, 110.82], [145, 112.3],
    [150, 105.65], [155, 110.66], [160, 120.91], [165, 118.6], [170, 116.23],
    [175, 126.43], [180, 138.17], [185, 136.92], [190, 147.68], [195, 163.44],
    [200, 214.61], [205, 173.59], [210, 156.82], [215, 133.33], [220, 134.52],
    [225, 142.49], [230, 144.59], [235, 144.45], [240, 161.03], [245, 204.56],
    [250, 179.55], [255, 309.64], [260, 295.1], [265, 501.01], [270, 393.5],
    [275, 565.38], [280, 532.7], [285, 513.77], [290, 451.8], [295, 350.72],
    [300, 236.03], [305, 273.98], [310, 238.62], [315, 216.72], [320, 162.86],
    [325, 175.22], [330, 167.24], [335, 180.08], [340, 138.75], [345, 143.73],
    [350, 147.73], [355, 128.8], [360, 135.02], [365, 138.06], [370, 138.39],
    [375, 137.08], [380, 146.5], [385, 148.45], [390, 135.55], [395, 141.06],
    [400, 136.88], [405, 122.28], [410, 143.14], [415, 145.49], [420, 145.11],
    [425, 142.84], [430, 144.94], [435, 143.89], [440, 143.24], [445, 153.76],
    [450, 139.38], [455, 144.28], [460, 142.56], [465, 168.05], [470, 152.87],
    [475, 144.32], [480, 173.07], [485, 159.34], [490, 169.97], [495, 172.93],
    [500, 168.11], [505, 159.56], [510, 167.22], [515, 157.83], [520, 168.37],
    [525, 170.62], [530, 167.11], [535, 167.57], [540, 171.61], [545, 179.19],
    [550, 175.36], [555, 192.33], [560, 178.93], [565, 195.94], [570, 195.77],
    [575, 201.38], [580, 211.95], [585, 217.29], [590, 220.68], [595, 225.57],
    [600, 235.64], [605, 232.36], [610, 247.02], [615, 252.35], [620, 251.32],
    [625, 256.81], [630, 277.58], [635, 271.4], [640, 276.76], [645, 290.74],
    [650, 300.61], [655, 297.27], [660, 304.96], [665, 314.33], [670, 322.21],
    [675, 332.47], [680, 340.9], [685, 356.28], [690, 380.62], [695, 380.05]
])

Q2_PSD_HighDensity = np.array([
    [180, 140.06], [181, 134.05], [182, 145.11], [183, 141.86], [184, 140.6],
    [185, 136.93], [186, 140.99], [187, 143.37], [188, 147.55], [189, 158.44],
    [190, 141.82], [191, 145.11], [192, 151.52], [193, 155.54], [194, 156.24],
    [195, 176.21], [196, 183.14], [197, 192.49], [198, 206.2], [199, 208.68],
    [200, 217.07], [201, 198.59], [202, 188.58], [203, 186.77], [204, 180.67],
    [205, 181.78], [206, 175.46], [207, 160.91], [208, 150.06], [209, 144.02],
    [210, 154.6], [211, 153.16], [212, 145.33], [213, 139.49], [214, 145.79],
    [215, 132.37], [216, 134.78], [217, 131.71], [218, 131.17], [219, 134.16],
    [220, 134.65],
    [240, 165.11], [241, 176.0], [242, 184.17], [243, 203.9], [244, 204.67],
    [245, 200.25], [246, 192.05], [247, 177.63], [248, 166.81], [249, 176.7],
    [250, 172.61], [251, 191.47], [252, 211.74], [253, 236.97],
    [254, 264.3], [255, 320.9], [256, 342.0], [257, 336.47], [258, 322.06],
    [259, 314.75], [260, 306.93], [261, 295.03], [262, 327.24], [263, 349.96],
    [264, 400.97], [265, 474.02], [266, 533.97], [267, 502.98], [268, 430.93],
    [269, 395.85], [270, 380.72], [271, 404.66], [272, 407.56], [273, 436.65],
    [274, 483.88], [275, 576.9], [276, 646.97], [277, 630.08], [278, 595.8],
    [279, 535.47], [280, 533.75], [281, 577.87], [282, 590.71], [283, 586.07],
    [284, 540.84], [285, 519.62], [286, 464.17], [287, 433.07], [288, 434.52],
    [289, 434.56], [290, 447.42], [291, 451.06], [292, 421.62], [293, 391.33],
    [294, 364.1], [295, 352.32], [296, 338.06], [297, 315.09], [298, 276.2],
    [299, 253.58], [300, 223.04], [301, 227.07], [302, 237.81], [303, 237.37],
    [304, 254.48], [305, 262.74], [306, 272.82], [307, 295.53], [308, 273.4],
    [309, 247.42], [310, 234.12], [311, 217.07], [312, 210.84], [313, 220.57],
    [314, 217.3], [315, 218.55], [316, 212.74], [317, 201.96], [318, 186.43],
    [319, 171.63], [320, 163.32], [321, 163.15], [322, 166.33], [323, 173.58],
    [324, 178.3], [325, 174.9], [326, 169.55], [327, 168.68], [328, 162.62],
    [329, 164.45], [330, 174.29], [331, 163.01], [332, 176.56], [333, 181.52],
    [334, 178.15], [335, 174.54], [336, 177.54], [337, 171.0], [338, 153.62],
    [339, 150.22], [340, 147.27],
    [470, 162.09], [471, 165.13], [472, 157.8], [473, 148.28], [474, 143.32],
    [475, 155.42], [476, 151.5], [477, 155.12], [478, 157.33], [479, 161.03],
    [480, 172.63], [481, 161.15], [482, 159.25], [483, 166.36], [484, 165.22],
    [485, 166.92], [486, 169.92], [487, 167.52], [488, 166.26], [489, 170.17],
    [490, 167.34], [491, 173.63], [492, 171.48],
    [493, 163.39], [494, 170.9], [495, 179.08], [496, 178.17], [497, 162.73],
    [498, 164.27], [499, 158.5], [500, 161.7], [501, 165.84], [502, 174.24],
    [503, 162.13], [504, 172.12], [505, 166.31], [506, 157.85], [507, 177.26],
    [508, 167.48], [509, 171.55], [510, 165.69], [511, 171.26], [512, 172.12],
    [513, 163.69], [514, 165.17], [515, 156.97], [516, 162.13], [517, 165.13],
    [518, 158.48], [519, 162.01], [520, 164.37], [521, 163.57], [522, 164.79],
    [523, 170.34], [524, 171.86], [525, 158.99], [526, 164.72], [527, 164.18],
    [528, 165.68], [529, 166.0], [530, 164.15], [600, 230.26], [601, 244.0],
    [602, 238.54],
    [603, 241.26], [604, 241.88], [605, 245.13], [606, 247.22], [607, 240.49],
    [608, 240.77], [609, 247.71], [610, 251.74], [611, 243.74], [612, 240.79],
    [613, 260.59], [614, 250.74], [615, 253.42], [616, 257.27], [617, 252.83],
    [618, 260.04], [619, 259.36], [620, 258.24], [621, 254.16], [622, 253.6],
    [623, 258.51], [624, 259.94], [625, 252.21], [626, 266.65], [627, 252.68],
    [628, 275.0], [629, 266.95], [630, 265.23], [631, 270.14], [632, 267.44],
    [633, 273.53], [634, 275.34], [635, 268.99], [636, 270.72], [637, 279.83],
    [638, 276.1], [639, 275.65], [640, 270.95], [641, 276.35], [642, 274.69],
    [643, 285.97], [644, 289.83], [645, 284.37], [646, 290.31], [647, 282.61],
    [648, 292.51], [649, 283.97], [650, 297.54]
])

Q3_PSD = np.array([
    [0, 106.35], [10, 104.29], [20, 104.98], [30, 108.07], [40, 107.02],
    [50, 104.26], [60, 103.02], [70, 100.7], [80, 106.52], [90, 106.48],
    [100, 99.7], [105, 102.78], [110, 113.84], [115, 102.97], [120, 98.58],
    [125, 108.68], [130, 108.93], [135, 110.95], [140, 112.91], [145, 106.57],
    [150, 110.2], [155, 112.03], [160, 110.75], [165, 115.04], [170, 111.42],
    [175, 129.16], [180, 129.86], [185, 134.93], [190, 129.63], [195, 208.11],
    [200, 168.99], [205, 155.97], [210, 151.51], [215, 127.42], [220, 140.36],
    [225, 133.45], [230, 128.69], [235, 139.76], [240, 138.28], [245, 155.1],
    [250, 169.76], [255, 179.9], [260, 200.54], [265, 340.67], [270, 377.06],
    [275, 558.06], [280, 570.87], [285, 549.9], [290, 483.57], [295, 355.19],
    [300, 219.61], [305, 254.13], [310, 209.86], [315, 197.07], [320, 165.21],
    [325, 157.97], [330, 151.87], [335, 148.3], [340, 158.34], [345, 131.75],
    [350, 135.81], [355, 140.82], [360, 133.66], [365, 132.2], [370, 128.49],
    [375, 133.89], [380, 136.2], [385, 146.84], [390, 132.96], [395, 124.15],
    [400, 131.54], [405, 126.31], [410, 128.52], [415, 131.69], [420, 144.64],
    [425, 137.99], [430, 144.86], [435, 153.82], [440, 143.3], [445, 139.44],
    [450, 144.97], [455, 146.19], [460, 141.58], [465, 148.59], [470, 143.99],
    [475, 140.83], [480, 164.62], [485, 145.94], [490, 166.24], [495, 163.89],
    [500, 168.67], [505, 168.55], [510, 158.79], [515, 156.61], [520, 162.74],
    [525, 158.32], [530, 164.04], [535, 160.66], [540, 163.78], [545, 171.71],
    [550, 166.11], [555, 177.25], [560, 176.65], [565, 185.42], [570, 195.07],
    [575, 194.23], [580, 193.45], [585, 199.59], [590, 215.71], [595, 218.82],
    [600, 215.64], [605, 236.99], [610, 240.65], [615, 240.53], [620, 247.78],
    [625, 254.46], [630, 256.9], [635, 269.65], [640, 274.44], [645, 279.23],
    [650, 297.19], [655, 289.41], [660, 303.32], [665, 305.88], [670, 313.94],
    [675, 319.42], [680, 331.56], [685, 336.2], [690, 346.79], [695, 350.34]
])

Q3_PSD_HighDensity = np.array([
    [240, 135.0], [241, 135.34], [242, 143.32], [243, 150.62], [244, 151.47],
    [245, 146.06], [246, 145.57], [247, 151.73], [248, 150.1], [249, 172.4],
    [250, 167.08], [251, 171.32], [252, 165.34], [253, 172.19], [254, 171.37],
    [255, 177.67], [256, 178.34], [257, 187.03], [258, 178.76], [259, 197.18],
    [260, 204.63], [261, 244.02], [262, 284.57], [263, 321.06], [264, 345.43],
    [265, 348.74], [266, 339.94], [267, 333.63], [268, 324.1], [269, 348.53],
    [270, 392.23], [271, 438.85], [272, 436.17], [273, 462.03], [274, 523.64],
    [275, 603.84], [276, 642.08], [277, 577.76], [278, 563.42], [279, 574.11],
    [280, 608.05], [281, 609.76], [282, 569.64], [283, 513.08], [284, 521.73],
    [285, 554.73], [286, 545.02], [287, 502.07], [288, 471.23], [289, 463.0],
    [290, 497.22], [291, 481.77], [292, 431.14], [293, 381.76], [294, 369.75],
    [295, 358.8], [296, 330.12], [297, 290.81], [298, 262.93], [299, 223.9],
    [300, 215.76], [301, 216.07], [302, 216.43], [303, 237.04], [304, 264.06],
    [305, 250.31], [306, 232.9], [307, 208.54], [308, 197.34], [309, 198.05],
    [310, 206.45], [311, 213.55], [312, 227.01], [313, 212.31], [314, 218.75],
    [315, 207.31], [316, 191.55], [317, 186.66], [318, 166.34], [319, 168.01]
])

"""PSD Fit From Dave Starts"""
Q1_J1Bias = [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 105, 110, 115, 120, 125,
             130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190,
             195, 200, 205, 210, 215, 220, 225, 230, 235, 240, 245, 250, 255,
             260, 265, 270, 275, 280, 285, 290, 295, 300, 305, 310, 315, 320,
             325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385,
             390, 395, 400, 405, 410, 415, 420, 425, 430, 435, 440, 445, 450,
             455, 460, 465, 470, 475, 480, 485, 490, 495, 500, 505, 510, 515,
             520, 525, 530, 535, 540, 545, 550, 555, 560, 565, 570, 575, 580,
             585, 590, 595, 600, 605, 610, 615, 620, 625, 630, 635, 640, 645,
             650, 655, 660, 665, 670, 675, 680, 685, 690]
Q1_J1ParityRate = [84.79547476780088, 85.67273564144018, 84.58131565864086,
                   83.41993532311983, 88.0663976256994, 85.91011245173043,
                   90.63638527916422, 84.20680532502203, 91.84801477340577,
                   91.47268207521685, 85.7623932185514, 91.66245778751852,
                   93.28473949118191, 88.2989981638966, 92.88184539928655,
                   90.0825365495589, 93.39115928645701, 91.43110924940902,
                   91.74235361914397, 95.89167926020424, 91.25363615468865,
                   88.47546716492994, 98.59996693258613, 107.87456947652393,
                   111.3643591023006, 103.79641974709993, 118.42080673349456,
                   113.61982182177796, 147.72547284534372, 151.296841021404,
                   110.55770307356802, 136.76843344299058, 113.21855254341317,
                   115.84779634513612, 107.51068678924699, 111.56559754444997,
                   103.75362992876856, 117.67492066329808, 113.66314831251529,
                   116.68683766058632, 164.0396155186741, 141.0777973393545,
                   190.8693955064441, 230.46362847606824, 351.9961357031581,
                   510.0913638765808, 425.56284474363747, 403.46768720232734,
                   342.41533436322476, 285.99844750472136, 276.10763933556274,
                   175.13992122089167, 199.27533473231574, 172.8139851261015,
                   156.53496021484835, 151.11286556472055, 135.91161221257659,
                   121.68580742729746, 133.3676885704154, 121.40808415415768,
                   123.30702119718401, 128.23845303142667, 110.61659461584755,
                   120.85030577574688, 107.80478433178868, 113.31210577221024,
                   119.10630101062489, 114.5444250269247, 107.82442513381727,
                   111.2019017175395, 111.39322612106534, 107.9988536302468,
                   118.00862089437155, 110.58913525057619, 113.16633428799403,
                   112.92325786018057, 124.71967252810302, 113.96231642134258,
                   116.03257251908171, 114.19422047415351, 118.55387739851885,
                   126.56997805947546, 123.0872968120439, 121.03190522142299,
                   135.4185818207783, 131.1869574667451, 122.34827587780273,
                   132.89440271494044, 142.2127456355371, 141.21135217429304,
                   139.43757371761998, 138.56738328207092, 143.91495887504973,
                   147.44131414154037, 145.0308000892038, 150.34513734370017,
                   166.3336887318639, 155.31633045992768, 149.47996862853734,
                   154.06654187914472, 125.40350551200979, 154.53316105965888,
                   158.7625589916025, 169.02253745653405, 170.65125206830356,
                   168.22826856545086, 173.52136610962336, 185.45742687427392,
                   188.5735820146379, 193.51955845660564, 199.21503130085952,
                   194.89503128615115, 203.25160191060257, 206.7001865297978,
                   213.53774048177985, 217.4022532920667, 216.02944458365204,
                   226.77253635706293, 223.12199226159555, 230.89700081637753,
                   241.9499402363314, 251.43039293101418, 260.9045339461428,
                   252.7797856799046, 259.83244301466397, 276.15838938246424,
                   275.0366714089814, 285.64800704664566]
Q1_J1ParityUncertainty = [1.8435572565744338, 3.5042377421014006,
                          2.5078921200306263, 1.7377527938794106,
                          3.5666393594713806, 1.7120538158964695,
                          0.8196305085659115, 1.6511436251222655,
                          2.168236971867506, 2.712919630677684,
                          2.7722821113313003, 3.158430214175507,
                          2.92827740313452, 2.6718386837337107,
                          2.508089715054607, 3.3186830812306303,
                          2.492621566940456, 2.1576889272182047,
                          1.6683857065325403, 2.5684844157026205,
                          3.090600384857448, 2.2014020162415306,
                          3.402180278814683, 5.460494116929746,
                          4.575771322841287, 1.3821894495627696,
                          2.0530719904090504, 3.5842041342518356,
                          3.3737836271944186, 3.8187817096215007,
                          4.949867870149182, 3.7231135282348067,
                          1.3601000564642336, 5.233327699920975,
                          1.8576777708531889, 3.8483867364861535,
                          2.430326409569486, 3.3494581907251173,
                          2.8591751599780317, 3.4886009672571405,
                          4.443098094033613, 3.697703962328463,
                          3.8131140525790226, 4.104573489006611,
                          8.074530116166148, 8.015043459125037,
                          4.477968691596349, 8.96673221156587,
                          7.089322249935027, 6.586053678665661,
                          5.719514565560529, 3.5357447441697665,
                          3.818641168437709, 2.5287261657887274,
                          2.6460213585029924, 3.0338403815404322,
                          2.6300778291784783, 3.8778408186156854,
                          3.9440019407227767, 2.2269788857627706,
                          4.39357106374768, 1.3877914749351359,
                          3.8536224972948574, 2.497638187855401,
                          3.819219036569476, 0.845952398251998,
                          2.164960274008066, 3.7645817522381226,
                          3.4112312198527492, 3.232957992544061,
                          1.8618462346546163, 2.157211610026938,
                          1.984221579518831, 5.532901385690812,
                          1.5944726074306916, 3.509181354644739,
                          2.3179941707158593, 4.046900125986657,
                          2.2057546270100645, 2.1577040328634776,
                          2.6442372489724537, 3.0865510257024487,
                          2.994057489247455, 4.139904508864542,
                          2.1898750307625536, 4.606685840799685,
                          4.693189945304687, 3.046239023708113,
                          1.883944238671717, 4.0345852738086085,
                          3.8197393290931227, 2.366344713454524,
                          2.6761720306555152, 2.094987778056183,
                          3.6675139509979213, 3.252097448257445,
                          3.648526958234441, 2.7861122262049656,
                          2.817730470761111, 3.892799431496493,
                          26.072128398425217, 3.491498813369785,
                          2.6959799430490916, 2.9108932653697885,
                          3.740639420644782, 3.5549772174650456,
                          3.176429541406042, 2.908659669219028,
                          2.789642249061096, 5.292402150638464,
                          3.3985729181195334, 4.796059520309082,
                          4.293334018556463, 2.52587293168428,
                          6.644251262505572, 5.2827213162223,
                          2.0012438739277028, 6.349300394532526,
                          4.3334273150159675, 6.4138357519031155,
                          3.008134604385511, 2.1972419408022184,
                          6.1315454432103085, 3.5679417453568116,
                          5.441768903859432, 4.559677165751694,
                          5.545791535384634, 6.263154604954857]
Q1_J1Fidelity = [0.5352904511388095, 0.5211175608631148, 0.5284524631968865,
                 0.5283006040319577, 0.5290865447777142, 0.5155981035621413,
                 0.5036391450910849, 0.5191382525688498, 0.5308156122172741,
                 0.5303251369682338, 0.4982026034436112, 0.5181390023224873,
                 0.555236745808182, 0.5483031441160555, 0.5307874863795258,
                 0.5088980624925841, 0.5014995555449825, 0.49724995474656264,
                 0.49649660562753006, 0.49341559084287434, 0.49139579216927515,
                 0.48591021149755853, 0.4960491808183203, 0.5000007744088456,
                 0.5070020878990793, 0.5034644976177447, 0.5152257328048642,
                 0.5193113194472719, 0.5250845795684227, 0.5344918685262894,
                 0.571049695220719, 0.5631377211186648, 0.6021814641754475,
                 0.537718779584665, 0.5406022677727331, 0.5541010835023715,
                 0.527791341930653, 0.5096314314308701, 0.5045585190144759,
                 0.520015261611142, 0.5116524633459963, 0.5021918483243021,
                 0.5111878047311808, 0.5173841777837305, 0.5132218423777858,
                 0.5095299092650071, 0.5446822732036914, 0.543743484890666,
                 0.5455955177341272, 0.535006841474756, 0.5037743868692306,
                 0.5061614912578856, 0.518126358986552, 0.5377008365688876,
                 0.5401991395865959, 0.533315458368637, 0.528645567318166,
                 0.5071897890268353, 0.537473167201158, 0.5330990514298921,
                 0.5485510580968611, 0.5488928551796718, 0.48663412975444464,
                 0.5458326919421983, 0.5408612429475868, 0.5728127803942178,
                 0.5760735913471793, 0.5706796522250448, 0.5133145677834129,
                 0.5137695794173418, 0.5939745864388772, 0.601419704541654,
                 0.5918002331641024, 0.5905648576349501, 0.5927048480247027,
                 0.5988755142666744, 0.5941490154710175, 0.5904044212751252,
                 0.5884260869587878, 0.5803843233523265, 0.5479018717968184,
                 0.5045514630215838, 0.5075953644662234, 0.5055884269396514,
                 0.5050637371636484, 0.5041848107795275, 0.5355419693673713,
                 0.5363178242407356, 0.531571884748803, 0.5309559074125061,
                 0.5216059455255457, 0.5270161313315136, 0.5055033430350482,
                 0.49412958245730076, 0.48975410088948584, 0.49305900721272644,
                 0.49074558473939317, 0.5321228317309072, 0.5299879123807283,
                 0.5294091296010882, 0.4654649551512405, 0.5474365134777542,
                 0.5108367412764498, 0.49907932398552024, 0.5012557605547877,
                 0.49440915622228554, 0.5084545140008747, 0.5315078856429993,
                 0.5182202081873994, 0.490360610145742, 0.5355492407313018,
                 0.5320637252340068, 0.5406266844425667, 0.5186006388051339,
                 0.5295873628869155, 0.5623388895469772, 0.5781824405501709,
                 0.5757265564090348, 0.5656606808328031, 0.5027662500589242,
                 0.490401931446911, 0.5112282776987872, 0.558006981898949,
                 0.5153035957926307, 0.5297024056840135, 0.5318907536921771,
                 0.5263344642023331, 0.5231706958994251]

Q2_J1Bias = [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 105, 110, 115, 120, 125,
             130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190,
             195, 200, 205, 210, 215, 220, 225, 230, 235, 240, 245, 250, 255,
             260, 265, 270, 275, 280, 285, 290, 295, 300, 305, 310, 315, 320,
             325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385,
             390, 395, 400, 405, 410, 415, 420, 425, 430, 435, 440, 445, 450,
             455, 460, 465, 470, 475, 480, 485, 490, 495, 500, 505, 510, 515,
             520, 525, 530, 535, 540, 545, 550, 555, 560, 565, 570, 575, 580,
             585, 590, 595, 600, 605, 610, 615, 620, 625, 630, 635, 640, 645,
             650, 655, 660, 665, 670, 675, 680, 685, 690]
Q2_J1ParityRate = [110.08747027751446, 110.08128624723273, 111.46245982479593,
                   112.88540305476158, 105.9469093726029, 110.50600256701907,
                   112.76108036121818, 110.24666257239035, 112.20406362325075,
                   109.32923666154093, 110.01179321703617, 113.4193102601211,
                   115.31169397380829, 109.17697784892304, 114.10403431273558,
                   112.83970192852141, 115.38821884859979, 108.02895561046725,
                   108.45784114752249, 108.3688499611676, 111.5478623189169,
                   119.74455776493718, 117.61753198907013, 116.01121437433142,
                   124.0051006869257, 134.97913040902625, 138.9433594677558,
                   144.30745834818373, 163.38682844713895, 213.05708202472744,
                   172.39907483508802, 156.64524663561556, 129.21037452547668,
                   127.77132151443782, 142.4616063046787, 145.25139424275022,
                   137.31126164429895, 161.8752372411215, 201.15177395995568,
                   178.0898615714138, 303.9431149360827, 293.5581325587339,
                   500.16371217100686, 389.6265177937938, 566.5228768888562,
                   531.0405403003425, 509.172124960368, 450.4629452230538,
                   351.9370178818769, 231.0237056069969, 266.8433316384365,
                   240.09224213955454, 216.8748312042776, 162.65427802115437,
                   172.8808599664289, 168.2658531551844, 176.2524180770547,
                   138.02115196575198, 142.22073518559736, 145.43109081308776,
                   131.27265934609807, 135.70738978574815, 133.17645629535795,
                   132.67104535101103, 135.8565944127313, 144.2969564230085,
                   144.22719494768154, 134.43928146574763, 140.16432787850002,
                   135.2912422161647, 119.38283483546562, 139.70353111780258,
                   142.57064228301007, 146.45529943277216, 141.83541841834113,
                   147.23480171490388, 143.9813611733064, 144.91423010884034,
                   153.4183465235633, 138.0622626166508, 141.68689612525347,
                   135.63949513286335, 166.4382024512447, 151.72594839482252,
                   141.56525821735414, 173.8079183652522, 159.8545062338161,
                   166.54968806980196, 174.7451914932104, 164.93962735296583,
                   155.02431002746516, 163.34960046446832, 156.84000805176487,
                   165.28059526821465, 165.58589810801476, 162.74091021746617,
                   165.25814886020743, 168.04723860862913, 179.64268578423525,
                   172.07650747788423, 189.27418938045886, 177.58181876422753,
                   195.07377760004252, 193.87543282129363, 198.3640128709845,
                   206.13260289764216, 219.5756701525414, 215.74022901282464,
                   221.1528806335222, 236.15937483921644, 230.5275087257096,
                   241.98628925145468, 252.10762140838605, 249.05583351239665,
                   253.0666779528611, 265.67007032284, 266.15954329128414,
                   276.55998709061464, 273.4587150567521, 291.8757483288649,
                   285.98665489354335, 296.08578398746323, 314.969505153893,
                   313.9705399405233, 332.00360026384817, 341.54570200384717,
                   357.0347182482274, 364.51268051786656]
Q2_J1ParityUncertainty = [1.3745923058068183, 2.516074707477247,
                          4.003872325341376, 3.1776123711606465,
                          4.3729568082873405, 2.130298477784464,
                          1.946222040082346, 3.5450249943962913,
                          2.3873146297073786, 5.303371247775394,
                          2.669006809857181, 3.1631032465052793,
                          2.4076932875724277, 2.8651778033136517,
                          2.0423442985258236, 0.5165795505367329,
                          3.88088423950077, 2.9464702853288656,
                          4.05669438183906, 3.2776209422821174,
                          3.5343984158464252, 3.3924981455362064,
                          3.681977628633703, 5.069169406373642,
                          1.4698247544310377, 2.63166359038878,
                          1.4170335941597105, 1.8617584100150901,
                          3.1750189117003242, 5.173400797226551,
                          5.424488699487141, 2.656063891555474,
                          2.532038989296439, 3.474857255395352,
                          2.6100683441383614, 4.75434465330892,
                          3.498629955408362, 3.015976343054753,
                          3.8075095136973975, 1.8847868394861007,
                          4.876593608754736, 6.046975698574915,
                          5.951975893947004, 8.252098227015145,
                          8.49538851177024, 5.646641219473361,
                          10.905141823039973, 9.022243267404088,
                          6.114063678943961, 3.2373560114480346,
                          6.171562086076302, 3.458794998738867,
                          4.23316982298172, 3.6069068068553984,
                          4.404452122703539, 3.0975887259519332,
                          1.7524562634975256, 5.469806285076771,
                          3.5100521428323805, 2.5665452643965896,
                          2.2762382019577663, 2.378100536659304,
                          3.472594935406319, 4.604292270443076,
                          2.8822536330788995, 2.6756966965095947,
                          5.724057172993749, 3.631406937379871,
                          3.0030951023653607, 4.597373604474084,
                          5.242357590666058, 3.532883867607483,
                          5.210111151418152, 3.7147721552568576,
                          3.1807595836838662, 2.2985918445717695,
                          3.3839081710710923, 2.9371316786926394,
                          0.6053777077185387, 3.964009774771201,
                          3.5605683744521985, 5.398126159676943,
                          2.42020956013635, 3.7865210441131314,
                          4.605817527310038, 5.900900385413816,
                          5.0391982482158975, 0.4218547755722937,
                          5.5556412011353755, 3.391433014205808,
                          3.634358466434305, 3.398260944745438,
                          2.3582295536840534, 5.774570185633244,
                          1.1732899179992653, 1.906518455763073,
                          2.7109914088879963, 3.087672281367531,
                          3.855154333643035, 3.0507234440706275,
                          4.471747415078568, 4.518339143396642,
                          4.770430412301603, 4.73407020739081,
                          4.11791507014421, 4.780295399752594,
                          4.382596147109516, 5.817139188930912,
                          1.8427928045784092, 4.102903034955582,
                          1.7371254065590107, 5.797176844218117,
                          2.4900108567167165, 3.4349844935466614,
                          3.673622443231056, 4.455671800248594,
                          8.408031230913087, 3.4272560777484764,
                          3.4963100377122514, 4.417955575189667,
                          4.000407294106029, 3.0956579095188204,
                          6.058488640511991, 6.153855361284742,
                          4.716949963293123, 5.479603805160104,
                          3.4500689482576568, 8.060179808919942]
Q2_J1Fidelity = [0.4892513895994489, 0.48124217961327975, 0.47509484817023795,
                 0.48609880938657424, 0.4794595245946455, 0.4905223940499418,
                 0.4869736015889369, 0.4808006863501313, 0.5001788854796627,
                 0.49441198205674447, 0.5118854206585389, 0.49507603148477297,
                 0.5085483286900239, 0.5131919235533092, 0.5173005515504862,
                 0.49259513110375996, 0.5120958855108583, 0.5111995329863346,
                 0.5046430962502324, 0.49226130719415195, 0.48815013423441594,
                 0.49941137415555553, 0.4996953189320754, 0.49658968852982727,
                 0.4878046423084654, 0.5338675097879741, 0.49020622256463503,
                 0.488622177459124, 0.4842922714441632, 0.4779500317513226,
                 0.47256132755207936, 0.4832871295345155, 0.47607232982253656,
                 0.4783607935779325, 0.4820403103240508, 0.4823216588687772,
                 0.47854919354715986, 0.4966393985463847, 0.5024111040449062,
                 0.48000767880795403, 0.44364008347959516, 0.5152343472930518,
                 0.5120170792463904, 0.49063292038351874, 0.49882419130430505,
                 0.49672678227656514, 0.5061353827864694, 0.47895369068466875,
                 0.524161016257363, 0.49956029460513945, 0.47244786440086495,
                 0.4700966838246117, 0.4707009916856159, 0.48145596335343,
                 0.4884369255676284, 0.4899690081723743, 0.48982598018606166,
                 0.48937914395250715, 0.4781066147121993, 0.4815737585092463,
                 0.4854856808269332, 0.4936856810697724, 0.4802602829315605,
                 0.48293332797913074, 0.5120375828470969, 0.48929492610103154,
                 0.4616739359466142, 0.45860573216892603, 0.4746004959497889,
                 0.47866642771756956, 0.4978729058209172, 0.48673238651667095,
                 0.47186891608849474, 0.46865347586229866, 0.4668186014933625,
                 0.4859186372493727, 0.47123291862300054, 0.47413609742472945,
                 0.4654143781772043, 0.49384779339952295, 0.4909393494356527,
                 0.500569714007365, 0.50083538313937, 0.5247315355255393,
                 0.500726292044743, 0.5209828746956815, 0.499274684200871,
                 0.489855032321724, 0.5111204138877685, 0.4796130555600274,
                 0.519109917478026, 0.5207342778013071, 0.5165554407471725,
                 0.5034696707400914, 0.4692706198124245, 0.5037937797170733,
                 0.4964696642396782, 0.5101994762083089, 0.5174062111752853,
                 0.47743498321322153, 0.5323658693837995, 0.5399532668611234,
                 0.5424129786365005, 0.5382604745573949, 0.5046550457938384,
                 0.4353308088380234, 0.47089007360842033, 0.4669487033597184,
                 0.45739656575128806, 0.4714316651510327, 0.44341489499294406,
                 0.4446660307563782, 0.45583085407561724, 0.4714629500077188,
                 0.4691777542461665, 0.4270854539308635, 0.42761748711867587,
                 0.42781541693406366, 0.42208633302938386, 0.4265714800757305,
                 0.40803868499926244, 0.4070919293915458, 0.5468483376194442,
                 0.5191613451789128, 0.5547668513009186, 0.5265594304004033,
                 0.5266736468160788, 0.5359328120064186]

Q3_J1Bias = [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 105, 110, 115, 120, 125,
             130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190,
             195, 200, 205, 210, 215, 220, 225, 230, 235, 240, 245, 250, 255,
             260, 265, 270, 275, 280, 285, 290, 295, 300, 305, 310, 315, 320,
             325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385,
             390, 395, 400, 405, 410, 415, 420, 425, 430, 435, 440, 445, 450,
             455, 460, 465, 470, 475, 480, 485, 490, 495, 500, 505, 510, 515,
             520, 525, 530, 535, 540, 545, 550, 555, 560, 565, 570, 575, 580,
             585, 590, 595, 600, 605, 610, 615, 620, 625, 630, 635, 640, 645,
             650, 655, 660, 665, 670, 675, 680, 685, 690]
Q3_J1ParityRate = [99.1751429677554, 104.80942911709948, 101.62965897428475,
                   106.90257034607878, 103.80378024663023, 97.76322231193993,
                   107.06906148770945, 96.59129266985252, 104.42744570713228,
                   100.76465273174736, 103.66640950516891, 110.86819553600098,
                   103.41899079066366, 98.62016205344712, 107.6191199929666,
                   105.03360664693756, 108.27899363128094, 108.16616282977088,
                   104.70918998797299, 106.19765541843485, 110.21509668982222,
                   108.31867764877657, 112.59784673173665, 112.23133481447073,
                   126.20668170508577, 130.7166627086747, 132.63162262904711,
                   128.37984691001708, 206.51869009114367, 167.13702947876857,
                   155.8986837878594, 145.23212766432576, 128.35773118389855,
                   138.86513960768124, 131.5063375751944, 123.8878126045706,
                   136.64527699241006, 137.87396229780666, 152.27694128256903,
                   165.74736958530679, 180.05786968246, 200.6636210333597,
                   335.55821407471, 374.17760461048977, 566.1598645951191,
                   569.8756876991671, 554.4294198091386, 486.8226726180297,
                   355.1646653988206, 217.1685511859484, 251.94096348375405,
                   207.14181468166703, 192.354248569708, 161.71805793599256,
                   152.22044579496236, 143.59682142302316, 146.16648613067213,
                   156.75070235485776, 131.7699700287735, 130.64065948002096,
                   135.88703826776947, 133.16507786231568, 127.49683654713809,
                   127.06296606085714, 133.40312636310296, 133.47036682513402,
                   142.35829226575976, 131.61172334688598, 121.45206694454217,
                   130.76707468526033, 122.52780022642472, 129.64414135702677,
                   130.60885450966936, 145.94243549401992, 135.90585610238008,
                   143.8863658210234, 151.00407843567027, 143.59343777037972,
                   135.84566117844867, 147.2658358133642, 143.71429047504176,
                   138.4106014585539, 146.46162389233928, 144.79895076682345,
                   140.1324476478175, 161.6252394102775, 145.68347175716139,
                   166.48156033547124, 162.370807049994, 165.48977546730362,
                   168.05506547564792, 154.01271141322337, 153.79046150800303,
                   160.55620463138635, 155.1248643900878, 162.2520459633601,
                   157.6734740048333, 159.81642045897132, 169.06824128064747,
                   164.56390080973736, 176.28431982003244, 174.55595106164424,
                   180.63650467059796, 194.57775918435794, 193.71351279854014,
                   192.72489126497877, 201.2225023130316, 215.6212467235056,
                   214.97833867894934, 217.01862842717355, 231.57873558501552,
                   239.56471217411635, 241.33439575618158, 245.61551503463994,
                   252.81939113797958, 255.4854449347793, 268.13588089333234,
                   271.77276342289235, 277.1945410782432, 292.1178097594753,
                   290.079230117711, 300.41323310438054, 301.7501947131293,
                   310.6315261183562, 310.6644741670662, 329.0121491281522,
                   330.19237289194365, 337.8412358473744]
Q3_J1ParityUncertainty = [1.7990399937950632, 3.0551115287817034,
                          4.059269912449527, 1.4429281307195527,
                          1.5137933735281777, 2.225699945303553,
                          3.3869232872552795, 4.808305835371,
                          1.5507083229801502, 4.2609970295993955,
                          1.8251808254675406, 2.151050266351484,
                          2.187225759372854, 1.9720931225815836,
                          1.43670555597667, 4.412693655860044,
                          0.5912187227333316, 5.209825134276263,
                          3.5385610256254996, 5.2693155262393265,
                          4.716187666228651, 1.7747772043118455,
                          2.033107369697798, 3.1218673283190665,
                          1.4523282201393308, 3.3950006319778616,
                          3.569592642107471, 1.172480730069513,
                          9.36930248996076, 1.9523769253830252,
                          4.135853852686528, 0.6465899793077051,
                          5.681160181678474, 1.4565520416867632,
                          3.3889587259203693, 2.5568003484701727,
                          2.3056897375102507, 3.571279432071318,
                          3.4365079669478713, 1.7233513674410956,
                          5.018959285632508, 5.961337835205874,
                          8.607917606818535, 4.103754289205608,
                          10.622032750203843, 6.109060564490907,
                          9.897595486842025, 8.475991101870305,
                          5.168448957840483, 2.9811563654141064,
                          4.501963538680376, 3.1646177107701887,
                          5.701937203044176, 3.3559832733123294,
                          4.507558139354274, 6.343935235121607,
                          1.732291861489812, 6.150213507639696,
                          2.3242052727625055, 4.5026567638519515,
                          3.928747380803374, 2.718061986932791,
                          1.6852304303182968, 1.9328392222161739,
                          1.002036574956551, 3.0656200353790664,
                          3.142988650120843, 2.2398836517514766,
                          2.7729125351574115, 3.899861806769305,
                          1.757143339223374, 3.1268037046056674,
                          3.838037809340173, 2.42609038823892,
                          2.7649879719554282, 3.480141167614858,
                          7.91945178157534, 0.6160475992833738,
                          2.890284687359472, 2.2827600561324037,
                          3.4927169979420265, 3.3438745147710542,
                          2.7462655809882595, 5.8308685619030935,
                          1.9422009822126467, 2.497511196448435,
                          2.1635073855765, 4.478499135897336,
                          4.851543738209606, 2.3930961741570567,
                          2.4739852851837916, 4.459360740397813,
                          6.23019992723337, 4.592249317082563,
                          4.019632004005872, 4.391181413089203,
                          3.7509806228318547, 2.2472551752091765,
                          1.3398186966477221, 3.4063623920450246,
                          2.716817401906338, 2.360546531301929,
                          3.952008675256505, 1.8546436273792533,
                          2.9804565087367143, 4.149983155017083,
                          5.550335772544663, 5.648881250635871,
                          3.0496556852799293, 5.464705158051358,
                          3.885528403020275, 4.29229523618402,
                          3.4875954695023967, 6.772692578216475,
                          6.861662526515823, 4.977111984656799,
                          4.070844573106696, 6.28549354495251,
                          4.452537174167788, 8.432896165824836,
                          2.2325384837975064, 4.500649024453469,
                          8.10597344769584, 6.08032933757236,
                          5.652717072648153, 7.366025523703012,
                          6.0240053195028125, 6.038345169935668]
Q3_J1Fidelity = [0.5428159715582728, 0.5664827427208461, 0.5517896877877443,
                 0.542062693910353, 0.5313439536295238, 0.5275300616915486,
                 0.5317795228464224, 0.5229928381835766, 0.45439150145120555,
                 0.48618610822223235, 0.5280028068819502, 0.524635610738129,
                 0.5156145391820149, 0.5239903093119069, 0.5174708550550818,
                 0.5301789122263657, 0.4961741843659569, 0.5108483503708778,
                 0.5158137065067004, 0.5334444874637858, 0.5141428987853033,
                 0.5225554771297848, 0.5150056202708422, 0.48603613499959825,
                 0.446795767079829, 0.4057282361765465, 0.4655210073267648,
                 0.5218148338390598, 0.5745585263143418, 0.49092802368858945,
                 0.5109834818026918, 0.5158150544674452, 0.5366885647226114,
                 0.5413728416061507, 0.5208578474681731, 0.5230596795784159,
                 0.4721826515675434, 0.4566889329819899, 0.42067340757260635,
                 0.4695996135500577, 0.4646249330168352, 0.493105337798347,
                 0.48738424050456625, 0.5191458379239922, 0.50606140823881,
                 0.4965785607201704, 0.48434674386969867, 0.49118212844756726,
                 0.4810678515807953, 0.48827035329125235, 0.42941115015411035,
                 0.38239068105893315, 0.4037065522946623, 0.40402597054422296,
                 0.40061616759779445, 0.399047272547586, 0.4203015774539812,
                 0.3789297674085642, 0.3597019508103889, 0.3579211027038872,
                 0.3669369260807279, 0.43196225142100825, 0.46506688823813835,
                 0.4948426568381058, 0.5186799727412684, 0.5033952864882962,
                 0.4944248087474956, 0.47827714511130415, 0.49770980883690025,
                 0.5134585940281566, 0.501008616070167, 0.49909539800883207,
                 0.5041542301065851, 0.45694012882335083, 0.40315825878850464,
                 0.41079981147312505, 0.4150374050418165, 0.42090333316663064,
                 0.4786343508130882, 0.5351591386441583, 0.47981232270085894,
                 0.5165000150235981, 0.5536178097281448, 0.5478533742488216,
                 0.5488684995446844, 0.4889659121045199, 0.45004633885493933,
                 0.41993586767361, 0.4173952266237985, 0.42389319508359485,
                 0.4031815231334061, 0.3906616537351172, 0.38399249472658575,
                 0.3660642105923298, 0.4118312130970552, 0.4446237074734894,
                 0.5108053571940022, 0.5219047352475688, 0.49728393027545287,
                 0.5314668354153158, 0.5339945960990569, 0.5313138571411964,
                 0.5419870499982664, 0.5412833992366582, 0.5386760437377173,
                 0.534034589605531, 0.5520100163391827, 0.560936638959221,
                 0.5591063546075333, 0.4897691498032599, 0.5168283594785373,
                 0.5291766449930719, 0.5453378000455895, 0.5400245585414267,
                 0.5569142968338721, 0.5683030502672552, 0.5648477360114768,
                 0.518117542654186, 0.45992655002088306, 0.4643313299715377,
                 0.45154827493185207, 0.42103560796476336, 0.4055042891154634,
                 0.4306065480587652, 0.436711770196297, 0.4292308920071897,
                 0.4253118183342798, 0.4434655554164612]
### high freq data
if True:
    Q1_High_J1Bias = [700, 750, 800, 850, 900, 950, 1000, 1050, 1100, 1150, 1200, 1250, 1300, 1350, 1400, 1450]
    Q1_High_J1ParityRate = [299.1083388056185, 521.4752957775546, 1253.8819073754817, 1785.8219911581373,
                            1801.0012687173826, 1804.60482515575, 1801.9129014303815, 1815.9358525950563,
                            1801.0636342612838, 1783.5595997719718, 1806.2465698816304, 1793.2603294910798,
                            1793.6877197488081, 1799.6192968233315, 1806.4264074064542, 1808.8178481403359]
    Q1_High_J1ParityUncertainty = [6.239285528546543, 10.006032619463578, 14.860977670386635, 15.475403900545848,
                                   19.17977531629259, 16.36310717610817, 14.848922310755734, 20.058420590701186,
                                   18.972431517311463, 14.032907144295502, 26.62285324190659, 12.762727427587215,
                                   20.62624755385169, 21.923372651257395, 18.30849535499861, 12.171043677585056]
    Q1_High_J1Fidelity = [0.5468672041617098, 0.5542536440126622, 0.5650229679903425, 0.5601808797716777,
                          0.5541949621556143, 0.565804634063276, 0.5671908421696679, 0.5550096881673858,
                          0.5498909652597064, 0.5419672868038835, 0.5486550557240135, 0.5281648936985326,
                          0.529093796888767, 0.5266431332855618, 0.5290328635742159, 0.5317340154907901]
    Q2_High_J1Bias = [700, 750, 800, 850, 900, 950, 1000, 1050, 1100, 1150, 1200, 1250, 1300, 1350, 1400, 1450]
    Q2_High_J1ParityRate = [402.61718189180965, 922.2234561386144, 1776.2465626783405, 2488.4847461953227,
                            2428.310880147114, 2490.885063953256, 2440.1444378122414, 2425.52589657817,
                            2447.9398722045307, 2484.1507813736075, 2484.845685190905, 2490.8898370620564,
                            2412.490783097242, 2477.1823764220635, 2419.701064889643, 2441.2200297466716]
    Q2_High_J1ParityUncertainty = [5.181967150692182, 13.553253927991276, 23.42130130020503, 16.512532643154838,
                                   16.32854344836296, 23.476936786047403, 20.473043129654993, 33.46391840870052,
                                   18.974917671500883, 17.244767213442575, 21.46374455307914, 27.945691993875965,
                                   22.64249137521582, 16.148987651279604, 33.281984178602215, 37.83728168250608]
    Q2_High_J1Fidelity = [0.5516408899758848, 0.5491794107140628, 0.5164802833063774, 0.5097008069433432,
                          0.5317729413498563, 0.5366456155921449, 0.5270998431937153, 0.5235851040827677,
                          0.530214342415712, 0.5284324099639558, 0.5296363886507423, 0.5098671564730402,
                          0.5084588438736043, 0.5173479110984023, 0.5133974250831363, 0.5060112968476956]
    Q3_High_J1Bias = [700, 750, 800, 850, 900, 950, 1000, 1050, 1100, 1150, 1200, 1250, 1300, 1350, 1400, 1450]
    Q3_High_J1ParityRate = [374.4513228998377, 816.9840703594349, 1773.0291317108695, 2512.1411391173187,
                            2302.4795514980065, 2245.6735333596534, 2256.5048072336517, 2290.7580099662573,
                            2270.7860704213967, 2193.013635350281, 2407.27987626553, 2375.974938409736,
                            2419.4243828630442, 2362.6820122809618, 2255.208469054798, 2415.1333023418806]
    Q3_High_J1ParityUncertainty = [4.932903736594791, 13.32626335172011, 38.37945321949355, 45.709980520441356,
                                   46.58490845301481, 22.81536427512548, 33.14098022747364, 26.30696266891675,
                                   19.69850149529912, 37.969616893156015, 46.57641881369682, 39.04729140125277,
                                   39.68394440003983, 25.060371028283758, 42.13212287367267, 37.50035032971256]
    Q3_High_J1Fidelity = [0.394361888725688, 0.3952350044642692, 0.39404867078790035, 0.4100645188672682,
                          0.46406996701616077, 0.5471887987864722, 0.4765515651277164, 0.43205566364602793,
                          0.46504148990124583, 0.4660603715179735, 0.4317511475011667, 0.4310039595655298,
                          0.4096738344664267, 0.4238014583275217, 0.42602986211079075, 0.4223841582021776]
### concatenate Low freq with high freq points
if True:
    Q1_J1Bias = Q1_J1Bias + Q1_High_J1Bias
    Q1_J1ParityRate = Q1_J1ParityRate + Q1_High_J1ParityRate
    Q1_J1ParityUncertainty = Q1_J1ParityUncertainty + Q1_High_J1ParityUncertainty
    Q1_J1Fidelity = Q1_J1Fidelity + Q1_High_J1Fidelity

    Q2_J1Bias = Q2_J1Bias + Q2_High_J1Bias
    Q2_J1ParityRate = Q2_J1ParityRate + Q2_High_J1ParityRate
    Q2_J1ParityUncertainty = Q2_J1ParityUncertainty + Q2_High_J1ParityUncertainty
    Q2_J1Fidelity = Q2_J1Fidelity + Q2_High_J1Fidelity

    Q3_J1Bias = Q3_J1Bias + Q3_High_J1Bias
    Q3_J1ParityRate = Q3_J1ParityRate + Q3_High_J1ParityRate
    Q3_J1ParityUncertainty = Q3_J1ParityUncertainty + Q3_High_J1ParityUncertainty
    Q3_J1Fidelity = Q3_J1Fidelity + Q3_High_J1Fidelity
### high freq density data
# Q2_HD_J1Bias = Q2_PSD_HighDensity[:, 0]
# Q2_HD_J1ParityRate = Q2_PSD_HighDensity[:, 1]
# Q2_HD_J1ParityUncertainty = [1.0, 1.1, 1.2, 1.3, 1.4, 1.5]
# Q2_HD_J1Fidelity = [0.50, 0.51, 0.52, 0.53, 0.54, 0.55]
#
# Q3_HD_J1Bias = Q3_PSD_HighDensity[:, 0]
# Q3_HD_J1ParityRate = Q3_PSD_HighDensity[:, 1]
# Q3_HD_J1ParityUncertainty = [1.0, 1.1, 1.2, 1.3, 1.4, 1.5]
# Q3_HD_J1Fidelity = [0.50, 0.51, 0.52, 0.53, 0.54, 0.55]
if True:
    Q2_HD_J1Bias = [180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 470, 471,472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650]
    Q2_HD_J1ParityRate = [141.0410819717103, 133.69712671309776, 147.24447753450625, 136.51963215206518, 139.18194741811342, 134.78720492703007, 139.78649475574375, 143.35158230052284, 145.70291566496465, 155.53372221033564, 143.42373683758078, 144.869377764435, 146.2608180093223, 152.0482366911262, 156.9998916359761, 172.23468829743456, 183.35583863528012, 192.52434645833583, 207.3854274307517, 207.1495730363631, 212.75983260157773, 197.55994685482406, 188.39342279977063, 186.9602963851073, 177.7373228597799, 180.92448178507507, 174.45704877088014,158.49730519138734, 150.31377365911067, 143.25257615012922, 152.73953767264956, 152.9284996870696, 144.99549131963775, 139.7415960722229, 142.36128722709537, 129.6946759367218, 134.80520624990737, 130.80469467322138, 128.70267465927654, 134.0693214420423, 134.51475229901536, 160.2573139185378, 174.38447309299374, 183.11858999438414, 202.8571266626322, 200.2043629637773, 197.37056738349003, 184.2468912644185, 174.63067287750627, 162.8445681144677, 169.9407626580315, 169.87498736412985, 183.85081993061482, 207.86631764586673, 233.24376486069679, 259.3152848896525, 312.97920179093, 334.41183394319734, 330.4899669381256, 320.13385266610595, 310.3595649321224, 305.6487265449759, 291.8170827522942, 321.89309507387014, 348.23403177073305, 397.5575986256086, 470.76123285797513, 531.191800707904, 503.9666689769963, 431.85345018931656, 391.5012427937292, 376.1396325481516, 401.1663804095113, 402.80350099649877, 431.17681486065584, 487.7711233670302, 581.1314480952555, 638.1095991306905, 625.8375221587668, 593.1883342996521, 530.5160619428901, 531.6979856203301, 578.7848015032133, 591.9144543607705, 590.227436438131, 543.5485762723761, 519.0643395511487, 465.81229496579834, 431.6469982420429, 437.27230023742004, 429.4504886542931, 451.48850994301984, 450.47041003662093, 419.7882612998988, 387.0086716001822, 360.57564550326765, 348.0576600385807, 329.4762419665959, 307.33330343877645, 275.7497271699737, 248.8368592616886, 219.64929645756743, 221.95621624322945, 232.34603820033047, 234.0482047291141, 254.4561653049619, 261.1857280661874, 270.54418647303385, 293.41187440455144, 273.0414536976867, 245.01882150504906, 234.64559195911798, 215.08458984820777, 209.76409413898182, 220.90334617421044, 217.31051752955324, 218.35479677197318, 212.52101922059995, 198.39269558544385, 183.873588222176, 167.94454919222, 159.88211657250204, 159.3475108074458, 165.03050391444475, 171.7069813274651, 177.66690040393775, 173.55321768035387, 166.65738940881172, 164.62509958961806, 163.1648739294523, 163.03318740127858, 169.74001875645027, 162.55628808126474, 171.96220241106113, 181.26438484014596, 177.39880079178172, 173.32850521026933, 177.9062542698056, 167.76342293639857, 154.01828636608843, 151.27947964419278, 146.12799343769643, 159.79955304359262, 164.5088325390559, 158.40088327473342, 147.91347858376196, 144.8455213720772, 150.8862810747366, 150.36900051669824, 157.51163442071316, 158.53252775003733, 158.59967345342108, 166.32468333384753, 156.58082133913734, 153.54930670339223, 162.98938776301588, 161.35407441704743, 165.18605104276702, 168.3070180945332,164.15205212928117, 163.87922823347702, 165.7648545492704, 161.673788099741, 172.46311337707135, 171.03862050682062, 163.8077506087182, 164.3752374826492, 177.5408480780537, 174.7994812864579, 157.30142292590625, 161.60354035879718, 156.08648658623616, 159.18134581520198, 163.1793158887757, 171.73262115181328, 163.92293707341315, 171.76769421727397, 165.02829235418383, 155.791961031428, 173.60057891941673, 163.8431788010941, 168.28703332338176, 164.67140382697994, 170.82176851208766, 169.67084132058386, 158.49927185541893, 164.1132832648994, 158.85909598581515, 161.69058884752812, 168.1314061816029, 155.31815709452033, 155.92420852630556, 157.7120819033517, 161.6202509756594, 162.08658644427933, 174.3546685052862, 171.7691403714535, 157.93351926790524, 158.498270140077, 164.43963683503327, 166.31020066973124, 161.28273873825083, 164.45013871396037, 231.9783802367806, 242.1286858304391, 238.48100329987068,236.10438508845704, 240.4376495638192, 240.18849750523032, 249.20077917606687, 237.4272578627068, 238.9235267682728, 247.57486941723073, 249.90377709536878, 243.68431595044004, 245.0926126780076, 256.0256827424488, 250.46648924195142, 252.97231604338776, 255.96285107636209, 252.87791517454625, 264.7634706212295, 255.62865495112948, 254.26803964650725, 254.11609051750406, 251.02879541611188, 258.2266098765275, 258.49940556407773, 256.35704749628474, 267.5360479381316, 252.6879038831543, 274.9012799381636, 261.2993006488368, 267.1749954651441, 265.48353220009534, 266.5330288344743, 270.3107189461319, 271.1243877719292, 262.72165881114046, 268.99414404243714, 277.4245908352884, 273.4964837039802, 272.8524707347701, 269.3212021588718, 275.1480889881956, 271.71631657298565, 284.61415098118715, 287.7959320444799, 276.10950584810416, 291.4706822867874, 283.75689303465083, 294.9245184483834, 280.1461771818311, 296.6069704723047]
    Q2_HD_J1ParityUncertainty = [1.5986642118570655, 3.416179720403587, 4.27363577823936, 2.9062767087688757, 2.1049126083893945, 3.032284300041418, 5.711204671502572, 3.666032915422474, 2.0649441999919596, 4.2402061207683195, 2.70475731311716, 2.7088395181582268, 3.2289955871333635, 3.4459951466966507, 3.2486336169152636, 2.6714796372523515, 4.714463263771726, 3.7066977470777016, 2.645688767502763, 3.1533314374806847, 2.6268794903526635, 5.799302531331097, 2.750770713331772, 4.190726278840317, 3.712172668185395, 2.1708092893616833, 2.0551587875035224, 3.657897492267616, 5.806409856751173, 3.015537807708856, 3.557759077227108, 1.7519630693003063, 4.765024863128742, 3.591330390088935, 3.042529693993324, 4.027050819582776, 2.7529136938145973, 2.8937791769417784, 3.2306556624167815, 2.760509979407178, 2.135761390979151, 4.452947290786605, 4.138071813633071, 2.3844850547146352, 2.1281731513596247, 5.272585422491313, 1.7843329700634591, 4.86727902364644, 3.4305898981820357, 2.2025619201453503, 6.56168598820277, 4.456707205173576, 8.379607408425649, 3.5407107366905164, 6.703786098424261, 5.193075018773833, 4.978632364202164, 8.739385686540592, 7.782418462706339, 5.366492226957019, 10.11904089061477, 3.4220730076014894, 5.380033974853319, 4.957719573998254, 4.831261556387311, 5.06419214108866, 6.531742882516055, 7.123995354193571, 9.35334306041025, 9.40499535134338, 6.009473222536433, 4.751431536014619, 9.136185963985321, 6.880355293787683, 5.096510791301396, 8.486074593174836, 12.039971266218295, 11.058316545512362, 11.910594205818121, 9.079334730866943, 5.880709672542536, 9.202876658905504, 9.245125800426413, 9.671889287619862, 7.465352591466907, 10.124176729052543, 8.472291310939518, 8.446193941325, 9.791567659257712, 9.548688226486968, 5.822192647284128, 5.97389577707056, 6.882558200633968, 6.541161306891708, 7.260175484086451, 6.134672283775047, 7.672499323327852, 7.208163237311818, 2.8035325534713236, 5.052441791128488, 5.609494086534869, 3.2503368560663057, 6.265378969511241, 7.160389373808351, 4.28967036809639, 4.498907274070066, 4.125764117408795, 5.512634367065075, 3.1998188870427042, 4.80736350112932, 4.15062500063117, 4.887579878612648, 5.106625227976771, 3.7257365522765746, 4.469628519701308, 4.4479483317486785, 4.587089628745793, 2.702620109969504, 5.066661299247012, 2.7558097315070125, 4.414084931889957, 3.0694663166775187, 3.402058072767854, 4.013339557193092, 3.0445803787431664, 4.616605179520465, 4.273793741986958, 4.830662074918134, 3.5156820390665944, 2.5455977317167533, 6.3364946612433535, 3.753642235909758, 3.841613125047532, 5.076914646397811, 3.999506166211754, 3.9418566609848806, 3.9733616694842655, 3.881771349905553, 3.1366902315031333, 1.9989602751392164, 2.482737524188411, 3.2638994271162205, 3.175220924828741, 1.119601742367891, 3.862548267640581, 2.8641564729081974, 1.773602977053897, 4.124992914957545, 3.5632374584815216, 3.569904978439298, 5.840715697515396, 1.7361417549968534, 4.888576190448393, 2.784317099897963, 2.8564125432226577, 3.222824102518638, 2.932029190288532, 1.7960001120310674, 4.8483889263016335, 3.428532739638752, 3.5553013027882194, 6.485750417382102, 3.254860955807208, 2.718228054573685, 4.093721661476036, 2.8827022987421578, 5.730771863136833, 2.891079434812668, 4.985139800386121, 5.9426329498780674, 2.7529937276887044, 3.4485506634499736, 1.8831841097706896, 2.09446666094931, 5.963896588522786, 5.057018876999148, 1.9374000146803092, 2.026017461107574, 2.841972704928162, 3.730933961221104, 4.033359606023965, 2.803355587981264, 3.1404187784316386, 4.1052831956587275, 4.219501023878392, 4.659423513253558, 4.427185699514943, 3.0105113641608696, 3.8421249298856286, 4.619892401141179, 4.8486095279394466, 6.223464331734014, 4.348997144473791, 3.959723007354093, 2.7033811892064485, 5.750351483419891, 3.733589400261027, 5.3386468871889114, 3.4059858675505152, 6.708591838785523, 5.653324945344035, 2.82666668131432, 4.701992639900197, 0.7207251092029552, 4.437185453887177, 5.0931383132355075, 2.093846062534425, 1.6256053796925698, 3.746536385759843, 1.7577447110224083, 1.8933231075803767, 3.696013176451122, 1.979300095155242, 4.283644752848471, 4.515686748763867, 5.768404571268666, 2.7297426842405255, 2.990371852623112, 2.9520804671578476, 3.560448622017049, 4.058868428145954, 2.2476821907854236, 5.203948652172151, 3.7258601532317637, 6.153492245097039, 3.102033462964258, 5.19155862428154, 5.976493236393763, 4.378395920097098, 3.3991139716493266, 5.584510665449581, 2.845730125741677, 4.720010503691281, 3.3983395719653773, 6.987120893683299, 4.60180524161002, 3.9232453984041236, 2.9710412462814446, 5.8115773387814285, 6.304073362506618, 3.5641123224959403, 7.381453778895254, 3.1706972344080118, 5.175890133109831, 3.7246739998253626, 5.759586748580568, 4.059457988829647, 3.386471417994304, 5.16297707022301, 7.278711132795104, 7.169587552096924, 4.368475427082137, 4.641812342665693, 6.057549059764206]
    Q2_HD_J1Fidelity = [0.5004222915465275, 0.5047416043772368, 0.5263919766244138, 0.5233798928687821, 0.5289845856548606, 0.5345422788073563, 0.5367559053613051, 0.5376408467348683, 0.538581896851101, 0.542948797791472, 0.5385251470168451, 0.5345421492787493, 0.5387378456844608, 0.5338366830637048, 0.5323266580834141, 0.5344187984866975, 0.5255650030650414, 0.506462241348901, 0.5125650416956977, 0.5053527084675871, 0.5108352602443821, 0.5106743054421421, 0.5071299478701482, 0.5353853146394087, 0.5522058639261354, 0.5379135871770437, 0.5550071377787293, 0.5611948494400165, 0.558395504502887, 0.576624654298912, 0.5725417392250055, 0.5213924259274776, 0.5348174143820457, 0.5353692689177794, 0.5479427703016405, 0.5445604164826386, 0.5280335830283448, 0.5114100389341598, 0.5286394996743592, 0.5277675411663969, 0.4956882491668562, 0.4385706128958037, 0.46831633407265405, 0.46432995079803374, 0.4685959506490109, 0.4664853237189586, 0.4668356198167518, 0.4389107384421613, 0.4616422870081095, 0.46011274429718796, 0.4593944237182052, 0.4503991258248951, 0.42899455621088345, 0.4234840408880191, 0.46672363600891675, 0.4639307475878337, 0.4594570885406978, 0.4743209954458275, 0.4729466841030991, 0.46764396170916644, 0.47648704157976757, 0.4758548841226101, 0.4648236177932985, 0.46324286278093646, 0.4599336103855135, 0.45615610109336885, 0.4525399037425384, 0.44519135039199287, 0.450479025233865, 0.4433250075620032, 0.4450393317663074, 0.44815391177069513, 0.44688244701471097, 0.44105741662530407, 0.4411227143835183, 0.43840580308366195, 0.44093446165113254, 0.44197290610997086, 0.44411896131133743, 0.44206499199480415, 0.43215630916889425, 0.45431175909196525, 0.4536942950194031, 0.4727004795917384, 0.4700371772416822, 0.4815495756382562, 0.4780176012423367, 0.46117178716203494, 0.47628980356528133, 0.482041133756787, 0.45499107408046574, 0.43935169349497705, 0.45613603016708887, 0.4602573412684096, 0.4624286205230835, 0.43396315521090384, 0.4401690704903031, 0.46533852176747237, 0.46146445684115617, 0.44618530864669587, 0.4265495156841769, 0.425784240417068, 0.45913142444669813, 0.5283817796372846, 0.5201752325424629, 0.4920520303375439, 0.517779230418482, 0.5454868245174305, 0.5631746331040941, 0.5561717900978046, 0.5507122291427079, 0.5484835213602102, 0.5176742987515334, 0.5629803557750772, 0.563697035105687, 0.5655235190573998, 0.5524162416941828, 0.5397400552003703, 0.5256531205870393, 0.50394564634461, 0.5073936608458037, 0.49762297223958607, 0.49485464388752576, 0.5012408232580259, 0.48056439700851783, 0.522304499941016, 0.5283648133525395, 0.5236717964266473, 0.5249386205009243, 0.5388023903065288, 0.5225520429658377, 0.5391159437629275, 0.5404009413290596, 0.5483121420595716, 0.5430673835723601, 0.5434898790643231,0.5433127329428038, 0.5435792037692251, 0.5076311438793261, 0.5443155339878996, 0.5378700718137359, 0.5321672148044966, 0.5633494122303853, 0.5416543808776597, 0.5565908681282945, 0.556371252894512, 0.5541941036180689, 0.5590290757288053, 0.5593563375936624, 0.5569080923643184, 0.5549982599957277, 0.5467166044540852, 0.5046144677143827, 0.5058460247628599, 0.4964599636478042, 0.5053579485284707, 0.5063540144338486, 0.5093283640397663, 0.5261887602168315, 0.5300371687558202, 0.5087078708302069, 0.4644074314372119, 0.5255904114464511, 0.525872878298422, 0.5307636498284543, 0.5688044884451035, 0.5647303657677152, 0.4869669313886199, 0.5760344422368975, 0.5641446684060536, 0.5625291218186491, 0.5479684027541465, 0.5480640505517524, 0.5476679544438002, 0.54708970636232, 0.5350940858497977, 0.5349947127090651, 0.5366025514844514, 0.5361540197634986, 0.5404690081180481, 0.5398143559309574, 0.5426475538708206, 0.5344571000374954, 0.5563811525808197, 0.550689907620653, 0.5283909318243095, 0.5251820549198276, 0.5277199496718444, 0.5214678881771527, 0.5149277328745127, 0.5142858129929504, 0.4839427679661813, 0.5419323276892043, 0.5079800388025735, 0.5055789585221756, 0.5100267416935249, 0.522922055214111, 0.5192023510253214, 0.5285367042113436, 0.5249302792576122, 0.5131790480275031, 0.5213771841445336, 0.5078281293403799, 0.5283940581289104, 0.5259854375749119, 0.5249029814119034, 0.4787868953786232, 0.5160275709011259, 0.5017134853816161, 0.5132084067254931, 0.5182005962193676, 0.5629220316671742, 0.5521989407936531, 0.5487217907824916, 0.5488402172832165, 0.4461333239306164, 0.4940864400975105, 0.48303721098844965, 0.5013204862813313, 0.5162617409266578, 0.5110968200080355, 0.5090202530606689, 0.5039053779749485, 0.519895444372137, 0.5245657940227969, 0.5363797873031255, 0.5466078470773447, 0.5422922223434793, 0.5513305163499298, 0.553012008129918, 0.5539110573887414, 0.5470561156454202, 0.5383824628071866, 0.5383109223185457, 0.49468882580055124, 0.5055239686581136, 0.5037622999116672, 0.5303905376990015, 0.47927810675648497, 0.5355597201933715, 0.5342574987236499, 0.5373513817478058, 0.5284718993349217, 0.5314715759657129, 0.533265272265742, 0.5098516577469934, 0.5277933854863736, 0.5319615008680771, 0.4819995072687725, 0.5144853033208099, 0.515249673160463, 0.5407755453906595, 0.5669112960815342, 0.5738926876428598]
    Q3_HD_J1Bias = [240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319]
    Q3_HD_J1ParityRate = [134.30947273527676, 133.40852488699775, 138.8451482128542, 147.17766377092877, 150.39920599966942, 145.27940844823175, 148.11498152400713, 151.7447587847616, 150.33160604157257, 170.08416245684384, 168.55783362736625, 166.88226122114497, 164.39108025855376, 170.46402614789915, 168.95946851571225, 178.60534475720937, 176.03851052231113, 186.61719070168596, 175.12872115742204, 198.29324257407583, 199.93546451509263, 244.80168043167322, 287.971933652235, 318.7069887677268, 342.30456404172025, 339.90491064663064, 339.3662339916683, 328.0769407003322, 319.4302342489015, 346.00898578290855, 389.62995661465686, 438.6060334983831, 437.143897353186, 463.59332126487425, 522.3570530842735, 602.5784440511412, 625.0541521606486, 583.5416368252063, 555.4555623625463, 571.6009824256179, 612.4119796783333, 606.2151402644465, 567.163003854343, 505.3828526250281, 520.9587687372659, 549.0348103987272, 543.461271896253, 498.18799761479795, 463.2745568584362, 454.9335270658731, 489.6883736712007, 480.57387017199335, 430.1080757986036, 376.37383984621874, 366.56675453528214, 358.18082953650384, 319.8218058418667, 284.2759835607163, 258.85985224243433, 223.4860759680567, 211.77757645145988, 215.66036747421907, 208.87630711256924, 234.86153786931362, 264.0307460161345,248.41200341756158, 230.8384604440376, 205.53527972491307, 194.76450161389758, 195.56499094295037, 203.10645190973486, 212.66746489989765, 222.37229969912877, 211.79138176817656, 218.77413756370098, 199.50894846603748, 190.24130757291786, 182.86257650457478, 165.28951538812248, 162.94570484576826]
    Q3_HD_J1ParityUncertainty = [3.444283982831322, 4.433386806205565, 1.8412327272466824, 2.623925707132017, 5.058596274734683, 4.4738795500924855, 3.860328423136565, 2.95821898189934, 3.4345276887318743, 3.2971838662435506, 4.245206346519825, 1.6572191202519106, 2.117663119360688, 3.381284471171091, 2.400015363152849, 3.3507357163235114, 3.727777898457922, 4.776868039315094, 4.672936418069922, 3.0840994125371584, 5.819382849496421, 8.556232624746858, 4.714085672191068, 4.787463592199724, 4.100905507263606, 4.533694452621302, 9.141369908890649, 9.105222259650173, 5.655843464849921, 6.759607015968404, 11.203792640006947, 4.425725494323073, 6.867464641242299, 7.634877536581463, 6.9356090632727305, 10.605447339576811, 7.789909410678364, 11.297889357064575, 7.537741027611819, 10.940754947966742, 9.84548285944694, 9.458114944598515, 10.187416469683365, 8.680292224537771, 10.575073984149528, 8.61815411610507, 11.270787855994751, 6.488811630015949, 7.963385469465088, 7.2709788664768285, 6.574287391972953, 7.915681833926793, 8.672693792797237, 10.50322436876366, 4.591021320658257, 2.1671762777251167, 4.624811699409969, 2.321379000219292, 3.611987090900203, 5.077304316487981, 5.358734371325798, 6.481497008267409, 2.8846484117022153, 6.217278014992952, 3.8883850206795, 4.528716002490446, 2.1947510296117794, 6.19446160046031, 2.686097177729486, 6.679863881266713, 2.27365607621441, 5.696181234126502, 2.072473243891521, 7.07904340469078, 5.9575314318835, 4.708913459051373, 0.40823630267938305, 5.0567255913212, 4.225079794235336, 5.069934766936621]
    Q3_HD_J1Fidelity = [0.5816597803382677, 0.6074439905154647, 0.5879835135318214, 0.5390242901900978, 0.4807780665008826, 0.4788624976075093, 0.5330060999114928, 0.5437756442948567, 0.5787630594739123, 0.49788654792204234, 0.4794019343877351, 0.527251437802639, 0.5291141486240287, 0.521732595703667, 0.5307175536217446, 0.5270845446794146, 0.509892322394688, 0.4736661745589331, 0.4707168149640261, 0.4694449676960124, 0.49759595449650973, 0.5027391898514756, 0.5092134725061472, 0.5046832505108889, 0.5175233437433252, 0.5114690052649494, 0.5645936847986501, 0.6002775009506289, 0.58549077890412, 0.5982121021269098, 0.5685805390381592, 0.5700463046557358, 0.584087405100859, 0.5645411220917023, 0.5518660462615498, 0.4555805468267406,0.4101624475390671, 0.41405483858891307, 0.42234374804616764, 0.42972430167577885, 0.4159495650802403, 0.42084150635493606, 0.4060044624444468, 0.404493165266872, 0.42989727845439263,0.43695618479561776, 0.42667499796569947, 0.4500685453166522, 0.40329086536341996, 0.4093287209884609, 0.4284998625732151, 0.4307994299127635, 0.47126742696662766, 0.4717769006519538,0.4441979352806259, 0.4731372924211638, 0.4208620784767928, 0.41482243928862667, 0.42987230354519745, 0.4170232999949642, 0.45276022846785874, 0.4857582676491622, 0.48246460999360197,0.46895486128812386, 0.4810416868937778, 0.4892237695186683, 0.4744299115587326, 0.49273387308931527, 0.4706428318776295, 0.46507441868985844, 0.47099112916910685, 0.4201041469686363,0.42695360222408824, 0.44561859324040504, 0.4450470892842054, 0.4525256733237722, 0.4573809397607237, 0.4564073622649053, 0.491621505900177, 0.4773168024807714]

### interpolate high freq data
# print(Q2_HD_J1ParityRate)

## 1st find the same bias index and remove them from the low density string
## 2nd find the insert index left and right
# i_l = 25
# i_r = 26
Q2_LD_l1 = 25
Q2_LD_r1 = 33
Q2_HD_l1 = 0
Q2_HD_r1 = 40

# print('Q2_LD_l1=', Q2_LD_l1, 'Q2_LD_r1=', Q2_LD_r1)
# print('Q2_J1Bias[i_l]=', Q2_J1Bias[Q2_LD_l1], 'Q2_J1Bias[i_r]=', Q2_J1Bias[Q2_LD_r1])
# print('Q2_HD_l1=', Q2_HD_l1, 'Q2_HD_r1=', Q2_HD_r1)
# print('Q2_HD_J1Bias[i_l]=', Q2_HD_J1Bias[Q2_HD_l1], 'Q2_HD_J1Bias[i_r]=', Q2_HD_J1Bias[Q2_HD_r1])

Q2_LD_l2 = 37
Q2_LD_r2 = 57
Q2_HD_l2 = 41
Q2_HD_r2 = 141

# print('Q2_LD_l2=', Q2_LD_l2, 'Q2_LD_r2=', Q2_LD_r2)
# print('Q2_J1Bias[i_l]=', Q2_J1Bias[Q2_LD_l2], 'Q2_J1Bias[i_r]=', Q2_J1Bias[Q2_LD_r2])
# print('Q2_HD_l2=', Q2_HD_l2, 'Q2_HD_rr=', Q2_HD_r2)
# print('Q2_HD_J1Bias[i_l]=', Q2_HD_J1Bias[Q2_HD_l2], 'Q2_HD_J1Bias[i_r]=', Q2_HD_J1Bias[Q2_HD_r2])

Q2_LD_l3 = 83
Q2_LD_r3 = 95
Q2_HD_l3 = 142
Q2_HD_r3 = 202
# print('Q2_LD_l3=', Q2_LD_l3, 'Q2_LD_r3=', Q2_LD_r3)
# print('Q2_J1Bias[i_l]=', Q2_J1Bias[Q2_LD_l3], 'Q2_J1Bias[i_r]=', Q2_J1Bias[Q2_LD_r3])
# print('Q2_HD_l3=', Q2_HD_l3, 'Q2_HD_r3=', Q2_HD_r3)
# print('Q2_HD_J1Bias[i_l]=', Q2_HD_J1Bias[Q2_HD_l3], 'Q2_HD_J1Bias[i_r]=', Q2_HD_J1Bias[Q2_HD_r3])
Q2_LD_l4 = 109
Q2_LD_r4 = 119
Q2_HD_l4 = 203
Q2_HD_r4 = 253
# print('Q2_LD_l4=', Q2_LD_l4, 'Q2_LD_r4=', Q2_LD_r4)
# print('Q2_J1Bias[i_l]=', Q2_J1Bias[Q2_LD_l4], 'Q2_J1Bias[i_r]=', Q2_J1Bias[Q2_LD_r4])
# print('Q2_HD_l4=', Q2_HD_l4, 'Q2_HD_r4=', Q2_HD_r4)
# print('Q2_HD_J1Bias[i_l]=', Q2_HD_J1Bias[Q2_HD_l4], 'Q2_HD_J1Bias[i_r]=', Q2_HD_J1Bias[Q2_HD_r4])


Q2_J1Bias[Q2_LD_l4:Q2_LD_r4+1] = Q2_HD_J1Bias[Q2_HD_l4:Q2_HD_r4+1]
Q2_J1ParityRate[Q2_LD_l4:Q2_LD_r4+1] = Q2_HD_J1ParityRate[Q2_HD_l4:Q2_HD_r4+1]
Q2_J1ParityUncertainty[Q2_LD_l4:Q2_LD_r4+1] = Q2_HD_J1ParityUncertainty[Q2_HD_l4:Q2_HD_r4+1]
Q2_J1Fidelity[Q2_LD_l4:Q2_LD_r4+1] = Q2_HD_J1Fidelity[Q2_HD_l4:Q2_HD_r4+1]

Q2_J1Bias[Q2_LD_l3:Q2_LD_r3+1] = Q2_HD_J1Bias[Q2_HD_l3:Q2_HD_r3+1]
Q2_J1ParityRate[Q2_LD_l3:Q2_LD_r3+1] = Q2_HD_J1ParityRate[Q2_HD_l3:Q2_HD_r3+1]
Q2_J1ParityUncertainty[Q2_LD_l3:Q2_LD_r3+1] = Q2_HD_J1ParityUncertainty[Q2_HD_l3:Q2_HD_r3+1]
Q2_J1Fidelity[Q2_LD_l3:Q2_LD_r3+1] = Q2_HD_J1Fidelity[Q2_HD_l3:Q2_HD_r3+1]

Q2_J1Bias[Q2_LD_l2:Q2_LD_r2+1] = Q2_HD_J1Bias[Q2_HD_l2:Q2_HD_r2+1]
Q2_J1ParityRate[Q2_LD_l2:Q2_LD_r2+1] = Q2_HD_J1ParityRate[Q2_HD_l2:Q2_HD_r2+1]
Q2_J1ParityUncertainty[Q2_LD_l2:Q2_LD_r2+1] = Q2_HD_J1ParityUncertainty[Q2_HD_l2:Q2_HD_r2+1]
Q2_J1Fidelity[Q2_LD_l2:Q2_LD_r2+1] = Q2_HD_J1Fidelity[Q2_HD_l2:Q2_HD_r2+1]

Q2_J1Bias[Q2_LD_l1:Q2_LD_r1+1] = Q2_HD_J1Bias[Q2_HD_l1:Q2_HD_r1+1]
Q2_J1ParityRate[Q2_LD_l1:Q2_LD_r1+1] = Q2_HD_J1ParityRate[Q2_HD_l1:Q2_HD_r1+1]
Q2_J1ParityUncertainty[Q2_LD_l1:Q2_LD_r1+1] = Q2_HD_J1ParityUncertainty[Q2_HD_l1:Q2_HD_r1+1]
Q2_J1Fidelity[Q2_LD_l1:Q2_LD_r1+1] = Q2_HD_J1Fidelity[Q2_HD_l1:Q2_HD_r1+1]

# Q2_J1ParityUncertainty[26:26]=Q2_HD_J1ParityUncertainty[Q2_HD_l3:Q2_HD_r3]
# Q2_J1Fidelity[26:26]=Q2_HD_J1Fidelity[Q2_HD_l3:Q2_HD_r3]
# print('Q2_J1Bias[i_l]=', Q2_J1Bias[Q2_LD_l3:])

### Q3 insert
Q3_LD_l1 = 37
Q3_LD_r1 = 52
Q3_HD_l1 = 0
Q3_HD_r1 = 79

# print('Q3_LD_l1=', Q3_LD_l1, 'Q3_LD_r1=', Q3_LD_r1)
# print('Q3_J1Bias[i_l]=', Q3_J1Bias[Q3_LD_l1], 'Q3_J1Bias[i_r]=', Q3_J1Bias[Q3_LD_r1])
# print('Q3_HD_l1=', Q3_HD_l1, 'Q3_HD_r1=', Q3_HD_r1)
# print('Q3_HD_J1Bias[i_l]=', Q3_HD_J1Bias[Q3_HD_l1], 'Q3_HD_J1Bias[i_r]=', Q3_HD_J1Bias[Q3_HD_r1])
Q3_J1Bias[Q3_LD_l1:Q3_LD_r1+1] = Q3_HD_J1Bias[Q3_HD_l1:Q3_HD_r1+1]
Q3_J1ParityRate[Q3_LD_l1:Q3_LD_r1+1] = Q3_HD_J1ParityRate[Q3_HD_l1:Q3_HD_r1+1]
Q3_J1ParityUncertainty[Q3_LD_l1:Q3_LD_r1+1] = Q3_HD_J1ParityUncertainty[Q3_HD_l1:Q3_HD_r1+1]
Q3_J1Fidelity[Q3_LD_l1:Q3_LD_r1+1] = Q3_HD_J1Fidelity[Q3_HD_l1:Q3_HD_r1+1]


"""PSD Fit From Dave Ends"""

"""P1 Data Starts, Strong radiator with AWG Bias"""
Q2_P1 = np.array([
    [0.0, 0.02125, 0.02365], [0.005, 0.0213, 0.02239],
    [0.01, 0.02175, 0.02226],
    [0.015, 0.02221, 0.02478], [0.02, 0.02248, 0.0191],
    [0.025, 0.02384, 0.02375],
    [0.0275, 0.02165, 0.02594], [0.03, 0.0225, 0.02217],
    [0.0325, 0.0285, 0.02379],
    [0.0349, 0.02634, 0.02444], [0.0374, 0.03124, 0.02973],
    [0.04, 0.02589, 0.02736],
    [0.041, 0.02811, 0.0286], [0.042, 0.02801, 0.02753],
    [0.043, 0.02834, 0.02889],
    [0.044, 0.02851, 0.02859], [0.045, 0.03064, 0.02764],
    [0.046, 0.02486, 0.0304],
    [0.047, 0.03177, 0.02987], [0.048, 0.03367, 0.02954],
    [0.049, 0.03227, 0.02847],
    [0.05, 0.03899, 0.03076], [0.051, 0.0347, 0.02851],
    [0.052, 0.04071, 0.02721],
    [0.053, 0.03472, 0.02946], [0.054, 0.03767, 0.03058],
    [0.055, 0.04054, 0.03181],
    [0.056, 0.03892, 0.02971], [0.057, 0.036, 0.03096],
    [0.058, 0.03607, 0.03005],
    [0.059, 0.03552, 0.02628], [0.06, 0.03329, 0.03125],
    [0.061, 0.0314, 0.02676],
    [0.062, 0.02399, 0.02676], [0.063, 0.02901, 0.02492],
    [0.064, 0.02538, 0.02743],
    [0.065, 0.02739, 0.02845], [0.066, 0.02856, 0.02605],
    [0.067, 0.02374, 0.02566],
    [0.068, 0.02747, 0.02536], [0.069, 0.02825, 0.02531],
    [0.07, 0.02428, 0.02698],
    [0.07, 0.02587, 0.02628], [0.0725, 0.02627, 0.02745],
    [0.075, 0.0234, 0.02526],
    [0.0775, 0.02351, 0.02462], [0.08, 0.02351, 0.0264],
    [0.0825, 0.02471, 0.02617],
    [0.085, 0.02494, 0.0253], [0.0875, 0.02627, 0.02144],
    [0.09, 0.0234, 0.02319],
    [0.0925, 0.02784, 0.02535], [0.095, 0.02719, 0.02603],
    [0.0975, 0.02464, 0.02725],
    [0.1, 0.02669, 0.02435], [0.105, 0.02495, 0.02599],
    [0.11, 0.02379, 0.02724],
    [0.115, 0.02726, 0.03004], [0.12, 0.02515, 0.02709],
    [0.125, 0.0261, 0.02595],
    [0.13, 0.02687, 0.02675], [0.135, 0.02984, 0.02989], [0.14, 0.03, 0.02845],
    [0.145, 0.03483, 0.02821], [0.15, 0.0315, 0.02912],
    [0.155, 0.03397, 0.02765],
    [0.16, 0.03957, 0.03101], [0.165, 0.03538, 0.02917],
    [0.17, 0.04065, 0.02988],
    [0.175, 0.04042, 0.03257], [0.18, 0.0409, 0.02825],
    [0.185, 0.04018, 0.03138],
    [0.19, 0.04567, 0.02907], [0.195, 0.043, 0.02884], [0.2, 0.04457, 0.02895],
    [0.205, 0.04263, 0.02933], [0.21, 0.04644, 0.03002],
    [0.215, 0.04742, 0.02839],
    [0.22, 0.04301, 0.02741], [0.225, 0.0496, 0.0299],
    [0.23, 0.04821, 0.03156],
    [0.235, 0.04851, 0.03085], [0.24, 0.05147, 0.03087],
    [0.245, 0.05051, 0.03112]
])
Q2_P1[:, 0] = (Q2_P1[:, 0]) * 1000

"""P1 Data Ends, Strong radiator with AWG Bias"""

f_scale = np.sqrt(e_eff / 6.0)
# f_list = [f, f_Q1, f_Q2]
# for fi in f_list:
#     fi = fi/1e9
#     fi = fi*f_scale
f = f / 1e9
f = f * f_scale
f_Q1 = f_Q1 / 1e9
f_Q1 = f_Q1 * f_scale
f_Q2 = f_Q2 / 1e9
f_Q2 = f_Q2 * f_scale

### dB power
# fig, axs = plt.subplots(4)
# axs[0].plot(f, ecJ1, color="black", marker="o")
# axs[0].set_ylabel("Radiator (dB)", color="black", fontsize=10)
# axs[0].set_xlim([50, 700])
# axs[0].set_ylim([-30, -10])

# axs[1].plot(f_Q1, ecQ1, color="green", marker="o")
# axs[1].set_ylabel("Receiver QB (dB)", color="green", fontsize=10)
# axs[1].set_xlim([50, 700])
# axs[1].set_ylim([-50, 0])
#
# axs[2].plot(f_Q1, ecQ1+ecJ1*k, color="red", marker="o")
# axs[2].set_ylabel("Sum (dB)", color="red", fontsize=10)
# axs[2].set_xlim([50, 700])
# axs[2].set_ylim([-70, -20])
#
# axs[3].plot(Q3_PSD[:, 0]*f_SIM, Q3_PSD[:, 1], color='k', label='Q3_PSD')
# axs[3].set_xlabel("Freq (GHz)", color="black", fontsize=10)
# axs[3].set_ylabel("PSD (Hz)", color="blue", fontsize=10)
# axs[3].set_yscale('log')
# axs[3].set_xlim([50, 700])
# axs[3].set_ylim([100, 1000])
#
# plt.grid()
# plt.show()

### Absolute photon rate
# fig, axs = plt.subplots(4)
# # plt.title('J1 Sim Bias')
# axs[0].plot(f, pgJ1, color="black", marker="o")
# axs[0].set_ylabel("Photons/Sec", color="black", fontsize=10)
# axs[0].set_xlim([50, 700])
# axs[0].set_ylim([1e6, 1e10])
# axs[0].set_yscale('log')
# axs[0].grid(True, which="both")
#
# axs[1].plot(f_Q1[100:], eQ1[100:], color="green", marker="o")
# axs[1].set_ylabel("Receiver QB Gamma", color="green", fontsize=10)
# axs[1].set_xlim([50, 700])
# axs[1].set_ylim([1e-5, 1e0])
# axs[1].set_yscale('log')
# axs[1].grid(True, which="both")
#
# pgJ1Q = []
# for i in range(len(pgJ1)):
#     pgJ1Q.append(pgJ1[i]*eQ1[i]*refJ1[i])
# # print(pgJ1Q)
# axs[2].plot(f_Q1[100:], pgJ1Q[100:], color="red", marker="o")
# axs[2].set_ylabel("Photons/Sec", color="red", fontsize=10)
# axs[2].set_xlim([50, 700])
# # axs[2].set_ylim([1e3, 1e8])
# axs[2].set_yscale('log')
# axs[2].grid(True, which="both")
#
# axs[3].plot(Q3_PSD[:, 0]*f_SIM, Q3_PSD[:, 1], color='k', label='Q3_PSD')
# axs[3].set_xlabel("Freq (GHz)", color="black", fontsize=10)
# axs[3].set_ylabel("PSD (Hz)", color="blue", fontsize=10)
# axs[3].set_yscale('log')
# axs[3].set_xlim([50, 700])
# axs[3].set_ylim([100, 1000])
# axs[3].grid(True, which="both")
#
# plt.show()

# Q2
# fig, axs = plt.subplots(4)
# axs[0].plot(f, pgJ1, color="black", marker="o")
# axs[0].set_ylabel("Photons/Sec", color="black", fontsize=10)
# axs[0].set_xlim([50, 700])
# axs[0].set_ylim([1e6, 1e10])
# axs[0].set_yscale('log')
# axs[0].grid(True, which="both")
#
# axs[1].plot(f_Q2[100:], eQ2[100:], color="green", marker="o")
# axs[1].set_ylabel("Q2 Receiver QB Gamma", color="green", fontsize=10)
# axs[1].set_xlim([50, 700])
# axs[1].set_ylim([1e-5, 1e0])
# axs[1].set_yscale('log')
# axs[1].grid(True, which="both")
#
# pgJ1Q2 = []
# for i in range(len(pgJ1)):
#     pgJ1Q2.append(pgJ1[i]*eQ2[i])
# # print(pgJ1Q)
# axs[2].plot(f_Q2[100:], pgJ1Q2[100:], color="red", marker="o")
# axs[2].set_ylabel("Photons/Sec", color="red", fontsize=10)
# axs[2].set_xlim([50, 700])
# # axs[2].set_ylim([1e3, 1e8])
# axs[2].set_yscale('log')
# axs[2].grid(True, which="both")
#
# axs[3].plot(Q2_PSD[:, 0]*f_SIM, Q2_PSD[:, 1], color='k', label='Q2_PSD')
# axs[3].set_xlabel("Freq (GHz)", color="black", fontsize=10)
# axs[3].set_ylabel("PSD (Hz)", color="blue", fontsize=10)
# axs[3].set_yscale('log')
# axs[3].set_xlim([50, 700])
# axs[3].set_ylim([100, 1000])
# axs[3].grid(True, which="both")
#
# plt.show()

"""
Calculate the noise bandwidth
"""
#
# Tbb2 = 540e-3
# PRQ2 = getPhotonRate(eQ2, f_Q2, Tbb2)
# print('PRQ2=', PRQ2)


"""
Q2 # polished
"""
if 1:
    # plt.figure(0)
    # plt.rcParams["figure.figsize"] = (6, 20)
    pgJ1Q2 = []
    l_i = 50
    for i in range(len(pgJ1)):
        pgJ1Q2.append(pgJ1[i] * eQ2[i])

    pgJ1Q2_scaled = []
    pgJ1Q2_scaled_withBase = []
    p2QP = 8e-4  # photon to QP conversion rate
    base = 110
    for i in range(len(pgJ1)):
        pgJ1Q2_scaled.append(pgJ1[i] * eQ2[i] * p2QP)
        pgJ1Q2_scaled_withBase.append(pgJ1[i] * eQ2[i] * p2QP + base)

    # plt.figure(figsize=(16, 8), dpi=80)

    fig, axs = plt.subplots(2, figsize=(5, 8))

    # axs[0].plot(f[l_i:], ecJ1[l_i:], color="red", marker="o", label='Radiator Efficiency')
    # axs[0].plot(f[l_i:], ecQ2[l_i:], color="blue", marker="o", label='Receiver Efficiency')
    # axs[0].plot(f[l_i:], ecJ1[l_i:]+ecQ2[l_i:], color="purple", marker="o", label='Combined Efficiency')
    # axs[0].set_ylabel("ec (dB)", color="black", fontsize=10)
    # axs[0].set_xlim([50, 700])
    # axs[0].set_ylim([-70, -10])
    # axs[0].grid(True, which="both")
    # axs[0].legend(loc=4)
    # axs[0].set_xlabel("Antenna Frequency (GHz)", color="black", fontsize=10)

    # axs_02 = axs[0].twinx()
    #
    # axs_02.plot(f_Q2[l_i:], pgJ1Q2[l_i:], color="purple", linestyle='--',
    #             label='Photon Rate (Constant power vs freq)')
    # axs_02.set_ylabel("Photon Generation Rate ($s^{-1}$)", color="black", fontsize=10)
    # axs_02.set_xlim([50, 700])
    # axs_02.set_ylim([1e4, 1e10])
    # axs_02.set_yscale('log')
    # axs_02.legend(loc=1)

    axs[0].plot(f[l_i:], eJ1[l_i:], color="red", marker="o", markersize=4,
                label='Radiator')
    axs[0].plot(f_Q2[l_i:], eQ2[l_i:], color="blue", marker="o", markersize=4,
                label='Receiver')
    axs[0].plot(f_Q2[l_i:], eJ1[l_i:]*eQ2[l_i:], color="purple", marker="o", markersize=4,
                label='Total')
    axs[0].set_ylabel('Coupling Efficiency', color="black", fontsize=10)
    axs[0].set_yscale('log')
    axs[0].set_xlim([50, 1000])
    axs[0].set_ylim([1e-8, 1e-1])
    axs[0].legend(loc=1)
    # axs[0].grid(True, which="both")
    axs[0].grid(True)
    axs[0].set_xlabel("Antenna Frequency (GHz)", color="black", fontsize=10)

    # axs_12 = axs[1].twinx()
    # axs_12.plot(f_Q2[l_i:], pgJ1Q2_scaled[l_i:], color="purple", linestyle='--',
    #             label='Photon Rate Scaled')
    # axs_12.axhline(y=base, color="blue", linestyle='--', label='Baseline Parity')
    # axs_12.plot(f_Q2[l_i:], pgJ1Q2_scaled_withBase[l_i:], color="grey", linestyle='-',
    #             label='Theory total')
    # axs_12.set_ylabel("Simulation Total Rate (Hz)", color="black", fontsize=10)
    # axs_12.set_xlim([50, 700])
    # axs_12.set_ylim([10, 2000])
    # axs_12.set_yscale('log')
    # axs_12.legend(loc=1)

    # axs[1].plot(Q2_PSD[:, 0] * f_SIM, Q2_PSD[:, 1], color='k', label='Q2 Measurement')
    axs[1].plot([J * f_SIM for J in Q2_J1Bias], Q2_J1ParityRate, 'k-', label='$\Gamma_{Measured}$')
    # axs[1].plot([J * f_SIM for J in Q3_J1Bias], Q3_J1ParityRate, 'b-', label='Q3 Measurement')

    # axs[1].errorbar([J * f_SIM for J in Q2_J1Bias], Q2_J1ParityRate,
    #                 yerr=Q2_J1ParityUncertainty, ecolor='k',
    #                 capthick=4, color='g', label='$\Gamma_{Measured}$')

    # axs[1].plot(f_Q2[l_i:], pgJ1Q2_scaled[l_i:], color="purple", linestyle='--',
    #             label='Photon Rate Scaled')
    axs[1].axhline(y=base, color="blue", linestyle='--', label='$\Gamma_{0}$')
    axs[1].plot(f_Q2[l_i:], pgJ1Q2_scaled_withBase[l_i:], color="grey", linestyle='-',
                label='$\Gamma_{0}+\Gamma_{PAT}$')

    axs[1].set_xlabel("Radiator Josephson Frequency (GHz)", color="black",
                      fontsize=10)
    axs[1].set_ylabel("$\Gamma_{p}$ ($s^{-1}$)", color="black", fontsize=10)
    axs[1].set_yscale('log')
    # axs[1].set_xlim([50, 700])
    # axs[1].set_ylim([100, 2000])
    axs[1].set_xlim([50, 1000])
    axs[1].set_ylim([100, 5000])
    # axs[1].grid(True, which="both")
    axs[1].grid(True)
    axs[1].legend(loc=4)

    # axs[2].errorbar(Q2_P1[:, 0] * f_AWG, Q2_P1[:, 1] * 100,
    #                 yerr=Q2_P1[:, 2] * 100/ np.sqrt(100), label='Q2', ecolor='k',
    #                 capthick=4, color='g')
    # axs[2].set_xlabel("Radiator Josephson Frequency (GHz)", color="black",
    #                   fontsize=10)
    # axs[2].set_ylabel("P1 (%)", color="black", fontsize=10)
    # # axs[2].set_yscale('log')
    # axs[2].set_xlim([50, 700])
    # axs[2].set_ylim([1.5, 5])
    # axs[2].grid(True, which="both")
# axs[2].legend(loc=4)

# plt.show()

"""
Zoom in Radiator No Wiggles
"""
# plt.rcParams["figure.figsize"] = (3, 5)
if 0:
    # plt.figure(1)
    freq_l = 175
    # freq_r = 215
    freq_r = 310
    pgJ1Q2 = []
    l_i = 1
    for i in range(len(pgJ1)):
        pgJ1Q2.append(pgJ1[i] * eQ2[i])

    pgJ1Q2_scaled = []
    p2QP = 1e-4  # photon to QP conversion rate
    base = 110
    for i in range(len(pgJ1)):
        pgJ1Q2_scaled.append(pgJ1[i] * eQ2[i] * p2QP + base)

    fig, axs = plt.subplots(2, figsize=(5, 8))

    # axs_02 = axs[0].twinx()
    #
    # axs_02.plot(f_Q2[l_i:], pgJ1Q2[l_i:], color="purple", linestyle='--',
    #             label='Photon Rate (Constant power vs freq)')
    # axs_02.set_ylabel("Photon Generation Rate ($s^{-1}$)", color="black", fontsize=10)
    # axs_02.set_xlim([freq_l, freq_r])
    # axs_02.set_ylim([1e4, 1e9])
    # axs_02.set_yscale('log')

    axs[0].plot(f[l_i:], eJ1[l_i:], color="red", marker="o", markersize=4,
                label='Radiator Efficiency')
    axs[0].plot(f_Q2[l_i:], eQ2[l_i:], color="blue", marker="o", markersize=4,
                label='Receiver Efficiency')
    axs[0].plot(f_Q2[l_i:], eJ1[l_i:] * eQ2[l_i:], color="purple", marker="o", markersize=4,
                label='Total Efficiency')
    # axs[0].set_ylabel('Coupling Efficiency', color="black", fontsize=10)
    axs[0].set_yscale('log')
    axs[0].set_xlim([freq_l, freq_r])
    axs[0].set_ylim([1e-8, 1e-1])
    # axs[0].legend(loc=4)
    # axs[0].grid(True, which="both")
    axs[0].grid(True)
    axs[0].set_xlabel("Antenna Frequency (GHz)", color="black", fontsize=10)

    # axs_12 = axs[1].twinx()
    # axs_12.plot(f_Q2[l_i:], pgJ1Q2_scaled[l_i:], color="purple", marker="o",
    #             label='Photon Rate Scaled')
    # axs_12.set_ylabel("Simulation Total Rate (Hz)", color="black", fontsize=10)
    # axs_12.set_xlim([freq_l, freq_r])
    # axs_12.set_ylim([100, 2000])
    # axs_12.set_yscale('log')
    # axs_12.legend(loc=1)

    # axs[1].scatter(Q2_PSD_HighDensity[:, 0] * f_SIM, Q2_PSD_HighDensity[:, 1], color="green", marker="o", label='Q2 Measurement')
    # axs[1].plot(Q2_PSD_HighDensity[:, 0] * f_SIM, Q2_PSD_HighDensity[:, 1], color="black", marker="o", label='$\Gamma_{Measured}$')
    axs[1].plot([J * f_SIM for J in Q2_J1Bias], Q2_J1ParityRate, color="black", marker="o", label='$\Gamma_{Measured}$')

    # axs[1].errorbar([J * f_SIM for J in Q2_J1Bias], Q2_J1ParityRate,
    #                 yerr=Q2_J1ParityUncertainty, label='Q2', ecolor='k',
    #                 capthick=4, color='g')
    axs[1].set_xlabel("Radiator Josephson Frequency (GHz)", color="black",
                      fontsize=10)
    # axs[1].set_ylabel("Parity Rate (Hz)", color="black", fontsize=10)
    axs[1].set_yscale('log')
    axs[1].set_xlim([freq_l, freq_r])
    # axs[1].set_ylim([100, 300])
    axs[1].set_ylim([100, 800])
    axs[1].grid(True, which="both")
    axs[1].legend(loc=4)

"""
Zoom in RO Wiggles
"""
if 0:
    # plt.figure(1)
    freq_l = 230
    freq_r = 310
    pgJ1Q2 = []
    l_i = 1
    for i in range(len(pgJ1)):
        pgJ1Q2.append(pgJ1[i] * eQ2[i])

    pgJ1Q2_scaled = []
    p2QP = 1e-4  # photon to QP conversion rate
    base = 110
    for i in range(len(pgJ1)):
        pgJ1Q2_scaled.append(pgJ1[i] * eQ2[i] * p2QP + base)

    fig, axs = plt.subplots(2, figsize=(4, 7))

    # axs_02 = axs[0].twinx()
    #
    # axs_02.plot(f_Q2[l_i:], pgJ1Q2[l_i:], color="purple", linestyle='--',
    #             label='Photon Rate (Constant power vs freq)')
    # axs_02.set_ylabel("Photon Generation Rate ($s^{-1}$)", color="black", fontsize=10)
    # axs_02.set_xlim([freq_l, freq_r])
    # axs_02.set_ylim([1e5, 1e9])
    # axs_02.set_yscale('log')

    axs[0].plot(f[l_i:], eJ1[l_i:], color="red", marker="o", markersize=4,
                label='Radiator Efficiency')
    axs[0].plot(f_Q2[l_i:], eQ2[l_i:], color="blue", marker="o", markersize=4,
                label='Receiver Efficiency')
    axs[0].plot(f_Q2[l_i:], eJ1[l_i:] * eQ2[l_i:], color="purple", marker="o", markersize=4,
                label='Total Efficiency')
    # axs[0].set_ylabel('Coupling Efficiency', color="black", fontsize=10)
    axs[0].set_yscale('log')
    axs[0].set_xlim([freq_l, freq_r])
    axs[0].set_ylim([1e-5, 1e-1])
    # axs[0].legend(loc=4)
    # axs[0].grid(True, which="both")
    axs[0].grid(True)
    axs[0].set_xlabel("Antenna Frequency (GHz)", color="black", fontsize=10)

    # axs_12 = axs[1].twinx()
    # axs_12.plot(f_Q2[l_i:], pgJ1Q2_scaled[l_i:], color="purple", marker="o",
    #             label='Photon Rate Scaled')
    # axs_12.set_ylabel("Simulation Total Rate (Hz)", color="black", fontsize=10)
    # axs_12.set_xlim([freq_l, freq_r])
    # axs_12.set_ylim([100, 1000])
    # axs_12.set_yscale('log')
    # axs_12.legend(loc=1)

    axs[1].scatter(Q2_PSD_HighDensity[:, 0] * f_SIM, Q2_PSD_HighDensity[:, 1], color="green", marker="o", label='Q2 Measurement')

    # axs[1].errorbar([J * f_SIM for J in Q2_J1Bias], Q2_J1ParityRate,
    #                 yerr=Q2_J1ParityUncertainty, label='Q2', ecolor='k',
    #                 capthick=4, color='g')
    axs[1].set_xlabel("Radiator Josephson Frequency (GHz)", color="black",
                      fontsize=10)
    # axs[1].set_ylabel("Parity Rate (Hz)", color="black", fontsize=10)
    axs[1].set_yscale('log')
    axs[1].set_xlim([freq_l, freq_r])
    axs[1].set_ylim([150, 800])
    axs[1].grid(True, which="both")
    axs[1].legend(loc=4)


"""
P1 Q2 and All PSD
"""
if 0:
    # plt.figure(0)
    # plt.rcParams["figure.figsize"] = (6, 20)

    fig, axs = plt.subplots(2, figsize=(7, 8))

    axs[0].errorbar(Q2_P1[:, 0] * f_AWG, Q2_P1[:, 1] * 100,
                    yerr=Q2_P1[:, 2] * 100/ np.sqrt(100), label='Q2', ecolor='g',
                    capthick=4, color='k')
    axs[0].set_xlabel("Radiator Josephson Frequency (GHz)", color="black",
                      fontsize=10)
    axs[0].set_ylabel("P1 (%)", color="black", fontsize=10)
    # axs[2].set_yscale('log')
    axs[0].set_xlim([50, 700])
    axs[0].set_ylim([1.5, 5])
    axs[0].grid(True, which="both")
    axs[0].legend(loc=4)

    axs[1].errorbar([J * f_SIM for J in Q1_J1Bias], Q1_J1ParityRate, yerr=Q1_J1ParityUncertainty, ecolor='r', capthick=4, color='g', label='$Q1$')
    axs[1].errorbar([J * f_SIM for J in Q2_J1Bias], Q2_J1ParityRate, yerr=Q2_J1ParityUncertainty, ecolor='k', capthick=4, color='k', label='$Q2$')
    axs[1].errorbar([J * f_SIM for J in Q3_J1Bias], Q3_J1ParityRate, yerr=Q3_J1ParityUncertainty, ecolor='b', capthick=4, color='b', label='$Q3$')

    axs[1].set_xlabel("Radiator Josephson Frequency (GHz)", color="black",
                      fontsize=10)
    axs[1].set_ylabel("$\Gamma_{p}$ ($s^{-1}$)", color="black", fontsize=10)
    axs[1].set_yscale('log')
    axs[1].set_xlim([50, 700])
    axs[1].set_ylim([80, 800])
    # axs[1].grid(True, which="both")
    axs[1].grid(True, which="both")
    axs[1].legend(loc=4)



plt.show()

### interpolate
# x = np.linspace(50, 600, 5000)
#
# x_th = f_Q2[:]
# y_th = pgJ1Q2_scaled[:]
# interp_th = interpolate.interp1d(x_th, y_th, kind="linear")
# y_th_inter = interp_th(x)
#
# x_ms = Q2_PSD[:, 0]*f_SIM
# y_ms = Q2_PSD[:, 1]
# interp_ms = interpolate.interp1d(x_ms, y_ms, kind="linear")
# y_ms_inter = interp_ms(x)
#
# # plt.plot(x_th, y_th)
# # plt.plot(x_ms, y_ms)
# plt.plot(x, y_th_inter)
# plt.plot(x, y_ms_inter)
# plt.plot(x, y_th_inter/y_ms_inter)
# plt.grid(True, which="both")
# plt.xlim([50, 700])
# # plt.ylim([100, 5000])
# plt.yscale('log')
# plt.show()
