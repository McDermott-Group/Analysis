### To analyze the P1 vs J2 Bias data
### Q1Q2Q3Q4
# file_path = ('Z:/mcdermott-group/data/BlackBody/Circmon/LIU/CW20180514A_Ox2/{}/{}/MATLABData/{}')
#
# date = 'JJRadiatorP1_2021Aug25_HighDensity'
#
# file_Number = np.arange(0, 50, 1)

### More Q2
# file_path = ('Z:/mcdermott-group/data/BlackBody/Circmon/LIU/CW20180514A_Ox2/{}/{}/MATLABData/{}')
#
# date = 'JJRadiatorP1_2021Aug26_HighDensity'
#
# file_Number = np.arange(0, 200, 1)

"""
Process code
C:\Repositories\Analysis\projects\BlackBody\JosephsonRadiator\P1T1\P12021Aug26.py
C:\Repositories\Analysis\projects\BlackBody\JosephsonRadiator\P1T1\P12021Aug26Q2.py
C:\Repositories\Analysis\projects\BlackBody\JosephsonRadiator\P1T1\P12021Aug26Q2Combine.py
standard deviation to standard error of the mean

"""

import matplotlib.pyplot as plt
import numpy as np

J2_Bias_Q1 = np.array([
    0., 4., 8., 12., 15., 15.5, 16., 16.5, 17., 17.5, 18.,
    18.5, 19., 19.5, 20., 20.5, 21., 21.5, 22., 22.5, 23., 23.5,
    24., 24.5, 25., 25.5, 26., 26.5, 27., 27.5, 28., 28.5, 29.,
    29.5, 30., 30.5, 31., 31.5, 32., 32.5, 33., 33.5, 34., 34.5,
    35., 35.5, 36., 36.5, 37., 37.5, 38., 38.5, 39., 39.5, 40.,
    40.5, 41., 41.5, 42., 42.5, 43., 43.5, 44., 44.5, 45., 49.,
    53., 57., 61., 65., 69., 73., 77., 81., 85., 89., 93.,
    97.])
J2_Bias_Q2 = np.array([
    0., 4., 8., 12., 16., 20., 24., 28., 32., 36., 40.,
    44., 48., 52., 56., 60., 64., 68., 70., 70.5, 71., 71.5,
    72., 72.5, 73., 73.5, 74., 74.5, 75., 75.5, 76., 76.5, 77.,
    77.5, 78., 78.5, 79., 79.5, 80., 80.5, 81., 81.5, 82., 82.5,
    83., 83.5, 84., 84.5, 85., 85.5, 86., 86.5, 87., 87.5, 88.,
    88.5, 89., 89.5, 90., 90.5, 91., 91.5, 92., 92.5, 93., 93.5,
    94., 94.5, 95., 95.5, 96., 96.5, 97., 97.5, 98., 98.5, 99.,
    99.5])
J2_Bias_Q3 = np.array([
    0., 0.5, 1., 1.5, 2., 2.5, 3., 3.5, 4., 4.5, 5.,
    5.5, 6., 6.5, 7., 7.5, 8., 8.5, 9., 9.5, 10., 10.5,
    11., 11.5, 12., 12.5, 13., 13.5, 14., 14.5, 15., 15.5, 16.,
    16.5, 17., 17.5, 18., 18.5, 19., 19.5, 20., 20.5, 21., 21.5,
    22., 22.5, 23., 23.5, 24., 24.5, 25., 25.5, 26., 26.5, 27.,
    27.5, 28., 28.5, 29., 29.5, 30., 34., 38., 42., 46., 50.,
    54., 58., 62., 66., 70., 74., 78., 82., 86., 90., 94., 98.])
J2_Bias_Q4 = np.array([
    0., 4., 8., 12., 16., 20., 24., 28., 32., 35., 35.5,
    36., 36.5, 37., 37.5, 38., 38.5, 39., 39.5, 40., 40.5, 41.,
    41.5, 42., 42.5, 43., 43.5, 44., 44.5, 45., 45.5, 46., 46.5,
    47., 47.5, 48., 48.5, 49., 49.5, 50., 50.5, 51., 51.5, 52.,
    52.5, 53., 53.5, 54., 54.5, 55., 55.5, 56., 56.5, 57., 57.5,
    58., 58.5, 59., 59.5, 60., 60.5, 61., 61.5, 62., 62.5, 63.,
    63.5, 64., 64.5, 65., 69., 73., 77., 81., 85., 89., 93.,
    97.])
P1_J2_Q1 = np.array([
    0.09151478, 0.08703182, 0.0882618, 0.08794933, 0.08818165,
    0.0889833, 0.08665481, 0.08788676, 0.09349549, 0.09210614,
    0.09115154, 0.09756099, 0.0937575, 0.09053581, 0.09270245,
    0.09135221, 0.09693043, 0.09922347, 0.09521829, 0.09515874,
    0.09620075, 0.09641336, 0.0897389, 0.0831632, 0.08954523,
    0.09410053, 0.1063627, 0.13489624, 0.1714701, 0.18467862,
    0.17769778, 0.15978768, 0.14279426, 0.136362, 0.12170757,
    0.12026267, 0.1124961, 0.11121191, 0.10623433, 0.10359356,
    0.10361798, 0.10084759, 0.09779605, 0.10016808, 0.09887265,
    0.09722523, 0.1045435, 0.10062217, 0.10050382, 0.10062389,
    0.09647612, 0.09428073, 0.09678772, 0.09206999, 0.09520828,
    0.09783997, 0.09620696, 0.09292284, 0.09237972, 0.09231662,
    0.09246814, 0.09043257, 0.09673941, 0.09099237, 0.09039802,
    0.08834101, 0.09690655, 0.09679089, 0.09220214, 0.09922646,
    0.09915293, 0.09505855, 0.09302409, 0.09651796, 0.09162362,
    0.0954987, 0.09871815, 0.09382241])
P1_J2_Q2 = np.array([
    0.03221857, 0.03171556, 0.03314561, 0.03160513, 0.03256905,
    0.0334588, 0.03193355, 0.03310597, 0.03330728, 0.03287312,
    0.03435965, 0.03334423, 0.03221563, 0.03298754, 0.03251722,
    0.03347501, 0.03336158, 0.0323123, 0.03374858, 0.03361437,
    0.03339633, 0.03347469, 0.03250942, 0.03333688, 0.03329429,
    0.03458953, 0.0345589, 0.03405791, 0.0344945, 0.03401392,
    0.03417905, 0.03680676, 0.03519604, 0.03523518, 0.03515189,
    0.03498405, 0.0360857, 0.03462048, 0.0349227, 0.036426,
    0.03686152, 0.03609282, 0.03729288, 0.03625132, 0.03697142,
    0.03749846, 0.03622269, 0.03654815, 0.03662906, 0.03672985,
    0.03550154, 0.03657593, 0.03581621, 0.03706069, 0.03585106,
    0.03544399, 0.03496945, 0.03551317, 0.03404684, 0.03474205,
    0.03572859, 0.03525251, 0.03399945, 0.03548398, 0.0330383,
    0.03288229, 0.03442139, 0.03403903, 0.03412732, 0.03365845,
    0.03292763, 0.03420683, 0.03379292, 0.03339642, 0.03183218,
    0.03363377, 0.03462074, 0.0338995])

P1_J2_Q3 = np.array([
    0.35866972, 0.35993776, 0.35934135, 0.36007218, 0.35824569,
    0.35511218, 0.35877801, 0.35622436, 0.35882495, 0.35881574,
    0.35664185, 0.35847286, 0.36660959, 0.36271326, 0.36285709,
    0.37514232, 0.40016205, 0.42369837, 0.40673112, 0.39382693,
    0.3764224, 0.37314463, 0.36917056, 0.36920665, 0.37272307,
    0.35957246, 0.35683931, 0.37470522, 0.45932988, 0.60847636,
    0.70203152, 0.76432586, 0.77942278, 0.79431034, 0.78592739,
    0.77277292, 0.72812406, 0.68098695, 0.59170952, 0.50345913,
    0.44443252, 0.42040014, 0.40696555, 0.39151354, 0.38456568,
    0.37705724, 0.36862108, 0.38079186, 0.38498037, 0.39767371,
    0.40597892, 0.39638822, 0.39689778, 0.39088347, 0.38942494,
    0.37643967, 0.37927475, 0.38415159, 0.37650834, 0.37355905,
    0.37488226, 0.36635771, 0.37851994, 0.37119994, 0.3803977,
    0.42273087, 0.40457725, 0.40370722, 0.40011052, 0.39513678,
    0.39614748, 0.39793719, 0.49240824, 0.60858279, 0.63472405,
    0.63970019, 0.6475761, 0.65051623])
P1_J2_Q4 = np.array([
    0.02379928, 0.02462802, 0.02353492, 0.02403066, 0.02411472,
    0.02398406, 0.02387884, 0.02979766, 0.03140893, 0.032198,
    0.03374106, 0.03469236, 0.03260121, 0.03148727, 0.0305883,
    0.02950887, 0.03141353, 0.03429558, 0.03468443, 0.03938188,
    0.04359392, 0.04407681, 0.04567099, 0.04689744, 0.05095649,
    0.05582051, 0.05683922, 0.06269061, 0.06205835, 0.06280797,
    0.05756588, 0.05518739, 0.05395225, 0.05868567, 0.03942157,
    0.05527995, 0.05589302, 0.05530485, 0.05538489, 0.05641155,
    0.05855407, 0.06362561, 0.06962735, 0.07311105, 0.07165543,
    0.07411966, 0.07214671, 0.07155449, 0.07200671, 0.07270898,
    0.07012878, 0.0677421, 0.06433914, 0.05715432, 0.055365,
    0.05216418, 0.05126228, 0.04945946, 0.046659, 0.04610384,
    0.04521347, 0.04190738, 0.0410773, 0.03880886, 0.03899347,
    0.03697249, 0.03577604, 0.03639505, 0.03429648, 0.03633243,
    0.03253057, 0.03053162, 0.02954724, 0.0282534, 0.02852569,
    0.02966221, 0.02907174, 0.02941831])

std_J2_Q1 = np.array([
    0.03209457, 0.03041861, 0.0307041, 0.03208122, 0.03175089,
    0.03456485, 0.028849, 0.03016017, 0.03756089, 0.03347515,
    0.03890507, 0.04198531, 0.03937127, 0.03687236, 0.03587188,
    0.03096457, 0.03591127, 0.03299645, 0.0360522, 0.03579714,
    0.03821949, 0.03301377, 0.03423159, 0.03002745, 0.03728838,
    0.03583532, 0.03251093, 0.02786653, 0.03024628, 0.03143624,
    0.03590782, 0.02925554, 0.03114889, 0.03339112, 0.02985579,
    0.03921995, 0.03653321, 0.03369183, 0.03152951, 0.02940366,
    0.03466848, 0.03186577, 0.03237615, 0.03308989, 0.03281004,
    0.0308898, 0.03687558, 0.0279221, 0.03537824, 0.03337092,
    0.03157926, 0.03252183, 0.03623527, 0.03142543, 0.03750961,
    0.0366634, 0.03717519, 0.02829092, 0.03007196, 0.03136491,
    0.03139376, 0.03205012, 0.038604, 0.02919936, 0.03071494,
    0.02983059, 0.03442986, 0.02924543, 0.02922662, 0.03580658,
    0.0330152, 0.03317347, 0.02790388, 0.03103452, 0.02689269,
    0.03274719, 0.03427018, 0.03248586])/np.sqrt(50)
std_J2_Q2 = np.array([
    0.00430962, 0.00507592, 0.00487925, 0.004967, 0.00457932,
    0.00567128, 0.00554866, 0.00497015, 0.00477919, 0.00624053,
    0.00594137, 0.00568302, 0.00521644, 0.00566716, 0.00453311,
    0.00529176, 0.00534419, 0.0049265, 0.00545437, 0.00552937,
    0.00502024, 0.00548889, 0.00527444, 0.0046869, 0.00542599,
    0.00563772, 0.00494287, 0.0052174, 0.00456604, 0.00412852,
    0.00441391, 0.00586998, 0.00692159, 0.00454627, 0.00570793,
    0.00460025, 0.00455659, 0.00544731, 0.00483018, 0.00539097,
    0.00542809, 0.00690423, 0.00606609, 0.00508855, 0.00595723,
    0.00536532, 0.00554929, 0.00528303, 0.00584155, 0.00566361,
    0.00521771, 0.00530914, 0.00557396, 0.0051298, 0.00534251,
    0.00511861, 0.00536374, 0.00561791, 0.00552243, 0.00548157,
    0.00620988, 0.00502148, 0.00521502, 0.00518435, 0.00525949,
    0.00518341, 0.00588383, 0.00543443, 0.00535055, 0.00553482,
    0.00518769, 0.00397268, 0.00473232, 0.00497968, 0.00520334,
    0.00504387, 0.00475248, 0.0053961])/np.sqrt(50)
std_J2_Q3 = np.array([
    0.02922061, 0.0303808, 0.03330525, 0.03483273, 0.0374707,
    0.02965721, 0.03117199, 0.03443822, 0.03563359, 0.03266602,
    0.03695991, 0.02929717, 0.03788657, 0.03461958, 0.02998893,
    0.0308253, 0.02832301, 0.02908669, 0.02869004, 0.03479536,
    0.03441443, 0.03497423, 0.03274104, 0.03380424, 0.03146101,
    0.03365386, 0.02943551, 0.0263013, 0.02930887, 0.03327779,
    0.04118308, 0.0384041, 0.04755588, 0.04266356, 0.04879672,
    0.04942489, 0.06230074, 0.04153752, 0.03712915, 0.03522661,
    0.03109963, 0.03149252, 0.03371081, 0.02911958, 0.03519771,
    0.02917425, 0.03341299, 0.03413047, 0.02959262, 0.03698236,
    0.0332278, 0.03448751, 0.03623222, 0.03319984, 0.03402852,
    0.03074164, 0.03942768, 0.03889086, 0.0326481, 0.02986337,
    0.03105977, 0.03095276, 0.03198494, 0.0308985, 0.03509738,
    0.0342831, 0.02895869, 0.03502435, 0.03242483, 0.02950574,
    0.03189735, 0.03385271, 0.03130426, 0.04132375, 0.04416565,
    0.04057942, 0.04070249, 0.044247])/np.sqrt(50)

std_J2_Q4 = np.array([
    0.00656026, 0.00536442, 0.0056219, 0.00498215, 0.00589264,
    0.00454793, 0.00493131, 0.00578906, 0.00581585, 0.00583883,
    0.00624395, 0.00625473, 0.00598235, 0.00598193, 0.004737,
    0.00575231, 0.00528447, 0.00548683, 0.00576338, 0.00586558,
    0.00690598, 0.00734171, 0.0064989, 0.00696453, 0.00759299,
    0.00766284, 0.0087636, 0.0115042, 0.00933769, 0.0088695,
    0.00833043, 0.00788358, 0.00914672, 0.00890855, 0.00852116,
    0.00814617, 0.00863877, 0.00801939, 0.00773887, 0.00854969,
    0.00864131, 0.00846467, 0.01075914, 0.01060223, 0.01034844,
    0.00953435, 0.01002817, 0.00824211, 0.01019206, 0.01160532,
    0.00919972, 0.00932842, 0.00759657, 0.0085467, 0.00865083,
    0.00859629, 0.00749584, 0.00789118, 0.00690704, 0.00797468,
    0.00798229, 0.00568245, 0.00705475, 0.00719529, 0.00728284,
    0.007272, 0.00643282, 0.00749999, 0.00624089, 0.00515667,
    0.00620199, 0.00579737, 0.00602301, 0.00578455, 0.00518294,
    0.00576435, 0.00577453, 0.00652034])/np.sqrt(50)

### More Q2
J2_Bias_Q2_More = np.array([
    70., 70.5, 71., 71.5, 72., 72.5, 73., 73.5, 74., 74.5, 75.,
    75.5, 76., 76.5, 77., 77.5, 78., 78.5, 79., 79.5, 80., 80.5,
    81., 81.5, 82., 82.5, 83., 83.5, 84., 84.5, 85., 85.5, 86.,
    86.5, 87., 87.5, 88., 88.5, 89., 89.5, 90., 90.5, 91., 91.5,
    92., 92.5, 93., 93.5, 94., 94.5, 95., 95.5, 96., 96.5, 97.,
    97.5, 98., 98.5, 99., 99.5])
P1_J2_Q2_More = np.array([
    0.03404607, 0.03425766, 0.03458928, 0.03405381, 0.03437726,
    0.03440869, 0.03430476, 0.03512444, 0.03452862, 0.03493009,
    0.03499414, 0.03537695, 0.0353496, 0.03557982, 0.03466431,
    0.03529033, 0.03562535, 0.03611968, 0.03565287, 0.0359003,
    0.03616611, 0.03683911, 0.0371199, 0.03710679, 0.0376104,
    0.03746472, 0.03762441, 0.03795804, 0.03784616, 0.03796717,
    0.03724041, 0.03694722, 0.03676988, 0.03708419, 0.03651043,
    0.0371083, 0.03673545, 0.03637769, 0.0364179, 0.03564328,
    0.03590894, 0.03551412, 0.03451617, 0.03570741, 0.0348187,
    0.03502556, 0.03441208, 0.03516457, 0.03432769, 0.03412752,
    0.03393104, 0.03442792, 0.03492402, 0.03357021, 0.03400459,
    0.03412774, 0.03393825, 0.03388221, 0.03387263,
    0.03409479])
std_J2_Q2_More = np.array([
    0.0051662, 0.00530576, 0.00571443, 0.00542523, 0.00545615,
    0.00514035, 0.00539131, 0.00570837, 0.00511214, 0.00600627,
    0.00561182, 0.00598129, 0.00645858, 0.00575621, 0.00602747,
    0.00473887, 0.00500003, 0.00574731, 0.00593606, 0.0058894,
    0.00548398, 0.00596233, 0.00571051, 0.00674345, 0.00643104,
    0.00547265, 0.00608596, 0.00592906, 0.00552907, 0.00595892,
    0.00623315, 0.00612063, 0.00590554, 0.00559046, 0.00563179,
    0.0054034, 0.00560334, 0.00552468, 0.00581072, 0.00542695,
    0.00613848, 0.00594264, 0.00534149, 0.00612965, 0.00545249,
    0.00582748, 0.0054802, 0.0050062, 0.00554411, 0.00581854,
    0.00517684, 0.00584991, 0.00500847, 0.00568827, 0.00602893,
    0.00554209, 0.0054218, 0.00537498, 0.00556183, 0.00548418])/np.sqrt(200)

J2_Bias_Q2_Combined = np.array([
    70., 70.5, 71., 71.5, 72., 72.5, 73., 73.5, 74., 74.5, 75.,
    75.5, 76., 76.5, 77., 77.5, 78., 78.5, 79., 79.5, 80., 80.5,
    81., 81.5, 82., 82.5, 83., 83.5, 84., 84.5, 85., 85.5, 86.,
    86.5, 87., 87.5, 88., 88.5, 89., 89.5, 90., 90.5, 91., 91.5,
    92., 92.5, 93., 93.5, 94., 94.5, 95., 95.5, 96., 96.5, 97.,
    97.5, 98., 98.5, 99., 99.5])

P1_J2_Q2_Combined = np.array([
    0.03398657, 0.034129, 0.03435069, 0.03393799, 0.03400369,
    0.03419433, 0.03410266, 0.03501746, 0.03453467, 0.03475565,
    0.03489421, 0.03510434, 0.03511549, 0.03582521, 0.03477066,
    0.0352793, 0.03553066, 0.03589256, 0.03573943, 0.03564434,
    0.03591742, 0.03675649, 0.03706823, 0.03690399, 0.03754689,
    0.03722204, 0.03749381, 0.03786613, 0.03752147, 0.03768337,
    0.03711814, 0.03690374, 0.03651621, 0.03698254, 0.03637158,
    0.03709878, 0.03655857, 0.03619095, 0.03612821, 0.03561726,
    0.03553652, 0.03535971, 0.03475866, 0.03561643, 0.03465485,
    0.03511724, 0.03413732, 0.03470811, 0.03434643, 0.03410982,
    0.0339703, 0.03427403, 0.03452474, 0.03369753, 0.03396225,
    0.03398148, 0.03351704, 0.03383252, 0.03402225, 0.03405573])

std_J2_Q2_Combined = np.array([
    0.00522646, 0.00535741, 0.00560286, 0.00544295, 0.00547154,
    0.00507107, 0.00541337, 0.00569833, 0.00507876, 0.00586738,
    0.00542252, 0.00568567, 0.00612261, 0.00579995, 0.00622023,
    0.00470103, 0.00515288, 0.00555555, 0.00568963, 0.00582621,
    0.00538263, 0.00585486, 0.0056561, 0.00678804, 0.00636099,
    0.00541979, 0.00606606, 0.00582358, 0.0055711, 0.00585758,
    0.00616167, 0.00603263, 0.00579678, 0.00553907, 0.00562712,
    0.00534983, 0.00556341, 0.00545868, 0.00575336, 0.00546593,
    0.00606621, 0.00586147, 0.00554733, 0.00592742, 0.00541576,
    0.00570761, 0.00546448, 0.00512412, 0.00561382, 0.00574388,
    0.00521264, 0.00579644, 0.00510764, 0.00539503, 0.00579349,
    0.00544213, 0.00544439, 0.00531134, 0.00541793, 0.00546723])/np.sqrt(250)

### Combine the Q2 data together
J2_Bias_Q2 = np.concatenate((J2_Bias_Q2[:18], J2_Bias_Q2_Combined))
P1_J2_Q2 = np.concatenate((P1_J2_Q2[:18], P1_J2_Q2_Combined))
std_J2_Q2 = np.concatenate((std_J2_Q2[:18], std_J2_Q2_Combined))

# plt.errorbar(J2_Bias_Q1, P1_J2_Q1, color='b', yerr=std_J2_Q1, label='Q1')
# plt.errorbar(J2_Bias_Q2, P1_J2_Q2, color='r', yerr=std_J2_Q2, label='Q2')
# plt.errorbar(J2_Bias_Q3, P1_J2_Q3, color='k', yerr=std_J2_Q3, label='Q3')
# plt.errorbar(J2_Bias_Q4, P1_J2_Q4, color='y', yerr=std_J2_Q4, label='Q4')
# plt.xlabel('J2 Bias (mDAC)')
# plt.ylabel('P1')
# plt.yscale('log')
# plt.legend(loc=1)
# plt.show()

f = 4.604
plt.errorbar(J2_Bias_Q1*f, P1_J2_Q1, color='b', yerr=std_J2_Q1, label='Q1')
plt.errorbar(J2_Bias_Q2*f, P1_J2_Q2, color='r', yerr=std_J2_Q2, label='Q2')
plt.errorbar(J2_Bias_Q3*f, P1_J2_Q3, color='k', yerr=std_J2_Q3, label='Q3')
plt.errorbar(J2_Bias_Q4*f, P1_J2_Q4, color='y', yerr=std_J2_Q4, label='Q4')
plt.xlabel('Radiator Josephson Frequency (GHz)')
plt.ylabel('P1')
plt.yscale('log')
# plt.grid()
plt.legend(loc=1)
plt.show()
