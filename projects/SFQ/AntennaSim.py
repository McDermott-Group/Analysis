from .SFQlib import add_CST_SimResultFromTxt
import numpy as np
import matplotlib.pyplot as plt
from copy import copy
from scipy.interpolate import interp1d
from scipy.integrate import simps

# from scipy import fft
from numpy.fft import rfft, rfftfreq, irfft

i1_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/TimeDomainSignalsCurrentPort1.txt"
i2_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/TimeDomainSignalsCurrentPort1.txt"
# v1_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/TimeDomainSignalsVoltagePort1.txt"
# v2_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/TimeDomainSignalsVoltagePort2.txt"

halfps_v1_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/HalfPicoSecond1THz1001Points/VoltagesSignalsPort1.txt"
halfps_v2_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/HalfPicoSecond1THz1001Points/VoltagesSignalsPort2.txt"
oneps_v1_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/OnePicoSecond1THz1001Points/VoltagesSignalsPort1.txt"
oneps_v2_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/OnePicoSecond1THz1001Points/VoltagesSignalsPort2.txt"
twops_v1_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/TwoPicoSecond1THz1001Points/VoltagesSignalsPort1.txt"
twops_v2_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/TwoPicoSecond1THz1001Points/VoltagesSignalsPort2.txt"
twopointfiveps_v1_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/TwoPointFivePicoSecond1THz1001Points/VoltagesSignalsPort1.txt"
twopointfiveps_v2_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/TwoPointFivePicoSecond1THz1001Points/VoltagesSignalsPort2.txt"
fiveps_v1_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/FivePicoSecond1THz1001Points/VoltagesSignalsPort1.txt"
fiveps_v2_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/FivePicoSecond1THz1001Points/VoltagesSignalsPort2.txt"

v1_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/TimeDomainSignalsVoltagePort1_long.txt"
v2_file = "Z:/mcdermott-group/data/sfq/MCM_NIST/LIU/CST_Sim/TimeDomainSignalsVoltagePort2_long.txt"

R1 = 1.0  # patch antenna resistance
R2 = 8.0e3  # circmon antenna resistance

halfps_t = add_CST_SimResultFromTxt(halfps_v1_file)[0]
halfps_v1 = add_CST_SimResultFromTxt(halfps_v1_file)[1]
halfps_v2 = add_CST_SimResultFromTxt(halfps_v2_file)[1]

oneps_t = add_CST_SimResultFromTxt(oneps_v1_file)[0]
oneps_v1 = add_CST_SimResultFromTxt(oneps_v1_file)[1]
oneps_v2 = add_CST_SimResultFromTxt(oneps_v2_file)[1]

twops_t = add_CST_SimResultFromTxt(twops_v1_file)[0]
twops_v1 = add_CST_SimResultFromTxt(twops_v1_file)[1]
twops_v2 = add_CST_SimResultFromTxt(twops_v2_file)[1]

twopointfiveps_t = add_CST_SimResultFromTxt(twopointfiveps_v1_file)[0]
twopointfiveps_v1 = add_CST_SimResultFromTxt(twopointfiveps_v1_file)[1]
twopointfiveps_v2 = add_CST_SimResultFromTxt(twopointfiveps_v2_file)[1]

v_sum = simps(twopointfiveps_v1[:200], twopointfiveps_t[:200])
norm_factor = 2.068/v_sum
twopointfiveps_v1 = norm_factor*twopointfiveps_v1
twopointfiveps_v2 = norm_factor*twopointfiveps_v2
print('norm_factor=', norm_factor)

fiveps_t = add_CST_SimResultFromTxt(fiveps_v1_file)[0]
fiveps_v1 = add_CST_SimResultFromTxt(fiveps_v1_file)[1]
fiveps_v2 = add_CST_SimResultFromTxt(fiveps_v2_file)[1]

# for i in range(100):
#     halfps_v2[i] = 0.0
#     oneps_v2[i] = 0.0
#     twops_v2[i] = 0.0
#     fiveps_v2[i] = 0.0


t = add_CST_SimResultFromTxt(v1_file)[0]
# i1 = add_CST_SimResultFromTxt(i1_file)[1]
# i2 = add_CST_SimResultFromTxt(i2_file)[1]
v1 = add_CST_SimResultFromTxt(v1_file)[1]
v2 = add_CST_SimResultFromTxt(v2_file)[1]

# plt.plot(halfps_t[:100], halfps_v1[:100])
# plt.plot(oneps_t[:100], oneps_v1[:100])
# plt.plot(twops_t[:100], twops_v1[:100])
if 0:  # all three time widths and two ports
    plt.plot(halfps_t, halfps_v1)
    plt.plot(halfps_t, halfps_v2)
    plt.plot(oneps_t, oneps_v1)
    plt.plot(oneps_t, oneps_v2)
    plt.plot(twops_t, twops_v1)
    plt.plot(twops_t, twops_v2)
    plt.show()

"""FFT"""

# n = len(t)
# yf = rfft(v2)
# data_step = (t[-1]-t[0])/(n-1)
# xf = rfftfreq(n, data_step)

# halfps_n = len(halfps_t)
# halfps_yf = rfft(halfps_v2)
# halfps_data_step = (halfps_t[-1] - halfps_t[0]) / (halfps_n - 1)
# halfps_xf = rfftfreq(halfps_n, halfps_data_step)
#
# halfps_yf_filter = copy(halfps_yf)
# for i in range(len(halfps_xf)):
#     if halfps_xf[i] < 0.1:  # remove anything below 100 GHz
#         halfps_yf_filter[i] = 0
# halfps_v2_filter = irfft(halfps_yf_filter, halfps_n)
#
# oneps_n = len(oneps_t)
# oneps_yf = rfft(oneps_v2)
# oneps_data_step = (oneps_t[-1] - oneps_t[0]) / (oneps_n - 1)
# oneps_xf = rfftfreq(oneps_n, oneps_data_step)
#
# oneps_yf_filter = copy(oneps_yf)
# for i in range(len(oneps_xf)):
#     if oneps_xf[i] < 0.1:  # remove anything below 100 GHz
#         oneps_yf_filter[i] = 0
# oneps_v2_filter = irfft(oneps_yf_filter, oneps_n)
#
# twops_n = len(twops_t)
# twops_yf = rfft(twops_v2)
# twops_data_step = (twops_t[-1] - twops_t[0]) / (twops_n - 1)
# twops_xf = rfftfreq(twops_n, twops_data_step)
#
# twops_yf_filter = copy(twops_yf)
# for i in range(len(twops_xf)):
#     if twops_xf[i] < 0.1:  # remove anything below 100 GHz
#         twops_yf_filter[i] = 0
# twops_v2_filter = irfft(twops_yf_filter, twops_n)

twopointfiveps_n = len(twopointfiveps_t)
twopointfiveps_yf = rfft(twopointfiveps_v2/1000)
twopointfiveps_data_step = (twopointfiveps_t[-1] - twopointfiveps_t[0]) / (twopointfiveps_n - 1)
twopointfiveps_xf = rfftfreq(twopointfiveps_n, twopointfiveps_data_step)

twopointfiveps_yf_v1 = rfft(twopointfiveps_v1/1000)
V_SFQ_squre_tilt = np.abs(twopointfiveps_yf_v1)**2
V_SFQ_squre_tilt_interpolate = interp1d(twopointfiveps_xf*1000, V_SFQ_squre_tilt)

# twopointfiveps_yf_filter = copy(twopointfiveps_yf)
# for i in range(len(twopointfiveps_xf)):
#     if twopointfiveps_xf[i] < 0.1:  # remove anything below 100 GHz
#         twopointfiveps_yf_filter[i] = 0
# twopointfiveps_v2_filter = irfft(twopointfiveps_yf_filter, twopointfiveps_n)

# fiveps_n = len(fiveps_t)
# fiveps_yf = rfft(fiveps_v2)
# fiveps_data_step = (fiveps_t[-1] - fiveps_t[0]) / (fiveps_n - 1)
# fiveps_xf = rfftfreq(fiveps_n, fiveps_data_step)
#
# fiveps_yf_filter = copy(fiveps_yf)
# for i in range(len(fiveps_xf)):
#     if fiveps_xf[i] < 0.1:  # remove anything below 100 GHz
#         fiveps_yf_filter[i] = 0
# fiveps_v2_filter = irfft(fiveps_yf_filter, fiveps_n)

if 0:
    p1 = 0
    p2 = 0
    halfps_p1 = 0.0
    halfps_p2 = 0.0
    halfps_p2_filter = 0.0
    oneps_p1 = 0.0
    oneps_p2 = 0.0
    oneps_p2_filter = 0.0
    twops_p1 = 0.0
    twops_p2 = 0.0
    twops_p2_filter = 0.0
    twopointfiveps_p1 = 0.0
    twopointfiveps_p2 = 0.0
    twopointfiveps_p2_filter = 0.0
    fiveps_p1 = 0.0
    fiveps_p2 = 0.0
    fiveps_p2_filter = 0.0

    for i in range(len(v1)):
        # if i <= 200:
        p1 = p1 + v1[i] ** 2 / R1
        p2 = p2 + v2[i] ** 2 / R2
        halfps_p2_filter = halfps_p2_filter + halfps_v2_filter[i] ** 2 / R2

    for i in range(len(halfps_v1)):
        # if i <= 100:
        halfps_p1 = halfps_p1 + halfps_v1[i] ** 2 / R1
        halfps_p2 = halfps_p2 + halfps_v2[i] ** 2 / R2

    for i in range(len(oneps_v1)):
        # if i <= 100:
        oneps_p1 = oneps_p1 + oneps_v1[i] ** 2 / R1
        oneps_p2 = oneps_p2 + oneps_v2[i] ** 2 / R2
        oneps_p2_filter = oneps_p2_filter + oneps_v2_filter[i] ** 2 / R2

    for i in range(len(twops_v1)):
        # if i <= 100:
        twops_p1 = twops_p1 + twops_v1[i] ** 2 / R1
        twops_p2 = twops_p2 + twops_v2[i] ** 2 / R2
        twops_p2_filter = twops_p2_filter + twops_v2_filter[i] ** 2 / R2

    for i in range(len(twopointfiveps_v1)):
        # if i <= 100:
        twopointfiveps_p1 = twopointfiveps_p1 + twopointfiveps_v1[i] ** 2 / R1
        twopointfiveps_p2 = twopointfiveps_p2 + twopointfiveps_v2[i] ** 2 / R2
        twopointfiveps_p2_filter = twopointfiveps_p2_filter + twopointfiveps_v2_filter[i] ** 2 / R2

    for i in range(len(fiveps_v1)):
        # if i <= 100:
        fiveps_p1 = fiveps_p1 + fiveps_v1[i] ** 2 / R1
        fiveps_p2 = fiveps_p2 + fiveps_v2[i] ** 2 / R2
        fiveps_p2_filter = fiveps_p2_filter + fiveps_v2_filter[i] ** 2 / R2

if 0:
    print('half ps p2/p1=', halfps_p2 / halfps_p1)
    print('half_filter ps p2/p1=', halfps_p2_filter / halfps_p1)
    print('one ps p2/p1=', oneps_p2 / oneps_p1)
    print('one_filter ps p2/p1=', oneps_p2_filter / oneps_p1)
    print('two ps p2/p1=', twops_p2 / twops_p1)
    print('two_filter ps p2/p1=', twops_p2_filter / twops_p1)
    print('two pointfive ps p2/p1=', twopointfiveps_p2 / twopointfiveps_p1)
    print('twopointfive_filter ps p2/p1=', twopointfiveps_p2_filter / twopointfiveps_p1)
    print('five ps p2/p1=', fiveps_p2 / fiveps_p1)
    print('five_filter ps p2/p1=', fiveps_p2_filter / fiveps_p1)

if 0:  # all three time widths and two ports
    # plt.plot(twops_t, twops_v1)
    plt.plot(twops_t, twops_v2)
    plt.plot(twops_t, twops_v2_filter)
    # plt.plot(twops_t, twops_ixt-twops_v2)
    plt.show()

if 0:
    # plt.plot(halfps_xf, np.abs(halfps_yf), 'r')
    # plt.plot(oneps_xf, np.abs(oneps_yf), 'g')
    plt.plot(twops_xf, np.abs(twops_yf), 'b')
    # plt.plot(fiveps_xf, np.abs(fiveps_yf))
    plt.xlabel('THz')
    plt.ylabel('Amp(arb)')
    plt.xlim([0.05, 0.5])
    # plt.xscale('log')
    plt.yscale('log')
    plt.show()

"""FFT Test"""
# t_test = np.linspace(0, 10, 10001)
# y_test = np.sin(5*2*np.pi*t_test)
# # plt.plot(t_test, y_test)
# yf = rfft(y_test)
# data_step = (t_test[-1]-t_test[0])/(10001.0)
# xf = rfftfreq(10001, data_step)
# plt.plot(xf, np.abs(yf))
# plt.show()

# mpl.rc('font', family='Arial')
# fig, axs = plt.subplots(2, figsize=(8, 8),
#                         gridspec_kw={'height_ratios': [1, 1], 'hspace': 0.15})

# def gauss_pulse_f(tau, f):
#     v_f = np.zeros(len(f))  # voltage as function of time
#     for fi in range(len(f)):
#         v_f[fi] = 2.0678 * np.exp(-(2 * np.pi * tau * f[fi]/1000) ** 2 / 2)
#     return v_f

eFreq = np.array([
    0., 1.05263162, 2.10526323, 3.15789485,
    4.21052647, 5.26315784, 6.3157897, 7.36842108,
    8.42105293, 9.47368431, 10.52631569, 11.57894707,
    12.6315794, 13.68421078, 14.73684216, 15.78947353,
    16.84210587, 17.89473724, 18.94736862, 20.,
    21.05263138, 22.10526276, 23.15789413, 24.21052551,
    25.2631588, 26.31579018, 27.36842155, 28.42105293,
    29.47368431, 30.52631569, 31.57894707, 32.63158035,
    33.68421173, 34.73684311, 35.78947449, 36.84210587,
    37.89473724, 38.94736862, 40., 41.05263138,
    42.10526276, 43.15789413, 44.21052551, 45.26315689,
    46.31578827, 47.36841965, 48.42105103, 49.4736824,
    50.5263176, 51.57894897, 52.63158035, 53.68421173,
    54.73684311, 55.78947449, 56.84210587, 57.89473724,
    58.94736862, 60., 61.05263138, 62.10526276,
    63.15789413, 64.21052551, 65.26316071, 66.31578827,
    67.36842346, 68.42105103, 69.47368622, 70.52631378,
    71.57894897, 72.63157654, 73.68421173, 74.73683929,
    75.78947449, 76.84210205, 77.89473724, 78.94736481,
    80., 81.05263519, 82.10526276, 83.15789795,
    84.21052551, 85.26316071, 86.31578827, 87.36842346,
    88.42105103, 89.47368622, 90.52631378, 91.57894897,
    92.63157654, 93.68421173, 94.73683929, 95.78947449,
    96.84210205, 97.89473724, 98.94736481, 100.,
    101.05263519, 102.10526276, 103.15789795, 104.21052551,
    105.26316071, 106.31578827, 107.36842346, 108.42105103,
    109.47368622, 110.52631378, 111.57894897, 112.63157654,
    113.68421173, 114.73683929, 115.78947449, 116.84210205,
    117.89473724, 118.94736481, 120., 121.05263519,
    122.10526276, 123.15789795, 124.21052551, 125.26316071,
    126.31578827, 127.36842346, 128.42105103, 129.47367859,
    130.52632141, 131.57894897, 132.63157654, 133.6842041,
    134.73684692, 135.78947449, 136.84210205, 137.89472961,
    138.94737244, 140., 141.05262756, 142.10527039,
    143.15789795, 144.21052551, 145.26315308, 146.3157959,
    147.36842346, 148.42105103, 149.47367859, 150.52632141,
    151.57894897, 152.63157654, 153.6842041, 154.73684692,
    155.78947449, 156.84210205, 157.89472961, 158.94737244,
    160., 161.05262756, 162.10527039, 163.15789795,
    164.21052551, 165.26315308, 166.3157959, 167.36842346,
    168.42105103, 169.47367859, 170.52632141, 171.57894897,
    172.63157654, 173.6842041, 174.73684692, 175.78947449,
    176.84210205, 177.89472961, 178.94737244, 180.,
    181.05262756, 182.10527039, 183.15789795, 184.21052551,
    185.26315308, 186.3157959, 187.36842346, 188.42105103,
    189.47367859, 190.52632141, 191.57894897, 192.63157654,
    193.6842041, 194.73684692, 195.78947449, 196.84210205,
    197.89472961, 198.94737244, 200., 201.05262756,
    202.10527039, 203.15789795, 204.21052551, 205.26315308,
    206.3157959, 207.36842346, 208.42105103, 209.47367859,
    210.52632141, 211.57894897, 212.63157654, 213.6842041,
    214.73684692, 215.78947449, 216.84210205, 217.89472961,
    218.94737244, 220., 221.05262756, 222.10527039,
    223.15789795, 224.21052551, 225.26315308, 226.3157959,
    227.36842346, 228.42105103, 229.47367859, 230.52632141,
    231.57894897, 232.63157654, 233.6842041, 234.73684692,
    235.78947449, 236.84210205, 237.89472961, 238.94737244,
    240., 241.05262756, 242.10527039, 243.15789795,
    244.21052551, 245.26315308, 246.3157959, 247.36842346,
    248.42105103, 249.47367859, 250.52632141, 251.57894897,
    252.63157654, 253.6842041, 254.73684692, 255.78947449,
    256.84210205, 257.89474487, 258.94735718, 260.,
    261.05264282, 262.10525513, 263.15789795, 264.21054077,
    265.26315308, 266.3157959, 267.3684082, 268.42105103,
    269.47369385, 270.52630615, 271.57894897, 272.6315918,
    273.6842041, 274.73684692, 275.78945923, 276.84210205,
    277.89474487, 278.94735718, 280., 281.05264282,
    282.10525513, 283.15789795, 284.21054077, 285.26315308,
    286.3157959, 287.3684082, 288.42105103, 289.47369385,
    290.52630615, 291.57894897, 292.6315918, 293.6842041,
    294.73684692, 295.78945923, 296.84210205, 297.89474487,
    298.94735718, 300., 301.05264282, 302.10525513,
    303.15789795, 304.21054077, 305.26315308, 306.3157959,
    307.3684082, 308.42105103, 309.47369385, 310.52630615,
    311.57894897, 312.6315918, 313.6842041, 314.73684692,
    315.78945923, 316.84210205, 317.89474487, 318.94735718,
    320., 321.05264282, 322.10525513, 323.15789795,
    324.21054077, 325.26315308, 326.3157959, 327.3684082,
    328.42105103, 329.47369385, 330.52630615, 331.57894897,
    332.6315918, 333.6842041, 334.73684692, 335.78945923,
    336.84210205, 337.89474487, 338.94735718, 340.,
    341.05264282, 342.10525513, 343.15789795, 344.21054077,
    345.26315308, 346.3157959, 347.3684082, 348.42105103,
    349.47369385, 350.52630615, 351.57894897, 352.6315918,
    353.6842041, 354.73684692, 355.78945923, 356.84210205,
    357.89474487, 358.94735718, 360., 361.05264282,
    362.10525513, 363.15789795, 364.21054077, 365.26315308,
    366.3157959, 367.3684082, 368.42105103, 369.47369385,
    370.52630615, 371.57894897, 372.6315918, 373.6842041,
    374.73684692, 375.78945923, 376.84210205, 377.89474487,
    378.94735718, 380., 381.05264282, 382.10525513,
    383.15789795, 384.21054077, 385.26315308, 386.3157959,
    387.3684082, 388.42105103, 389.47369385, 390.52630615,
    391.57894897, 392.6315918, 393.6842041, 394.73684692,
    395.78945923, 396.84210205, 397.89474487, 398.94735718,
    400., 401.05264282, 402.10525513, 403.15789795,
    404.21054077, 405.26315308, 406.3157959, 407.3684082,
    408.42105103, 409.47369385, 410.52630615, 411.57894897,
    412.6315918, 413.6842041, 414.73684692, 415.78945923,
    416.84210205, 417.89474487, 418.94735718, 420.,
    421.05264282, 422.10525513, 423.15789795, 424.21054077,
    425.26315308, 426.3157959, 427.3684082, 428.42105103,
    429.47369385, 430.52630615, 431.57894897, 432.6315918,
    433.6842041, 434.73684692, 435.78945923, 436.84210205,
    437.89474487, 438.94735718, 440., 441.05264282,
    442.10525513, 443.15789795, 444.21054077, 445.26315308,
    446.3157959, 447.3684082, 448.42105103, 449.47369385,
    450.52630615, 451.57894897, 452.6315918, 453.6842041,
    454.73684692, 455.78945923, 456.84210205, 457.89474487,
    458.94735718, 460., 461.05264282, 462.10525513,
    463.15789795, 464.21054077, 465.26315308, 466.3157959,
    467.3684082, 468.42105103, 469.47369385, 470.52630615,
    471.57894897, 472.6315918, 473.6842041, 474.73684692,
    475.78945923, 476.84210205, 477.89474487, 478.94735718,
    480., 481.05264282, 482.10525513, 483.15789795,
    484.21054077, 485.26315308, 486.3157959, 487.3684082,
    488.42105103, 489.47369385, 490.52630615, 491.57894897,
    492.6315918, 493.6842041, 494.73684692, 495.78945923,
    496.84210205, 497.89474487, 498.94735718, 500.,
    501.05264282, 502.10525513, 503.15789795, 504.21054077,
    505.26315308, 506.3157959, 507.3684082, 508.42105103,
    509.47369385, 510.52630615, 511.57894897, 512.6315918,
    513.6842041, 514.73681641, 515.78948975, 516.84210205,
    517.89471436, 518.9473877, 520., 521.0526123,
    522.10528564, 523.15789795, 524.21051025, 525.26318359,
    526.3157959, 527.3684082, 528.42108154, 529.47369385,
    530.52630615, 531.57891846, 532.6315918, 533.6842041,
    534.73681641, 535.78948975, 536.84210205, 537.89471436,
    538.9473877, 540., 541.0526123, 542.10528564,
    543.15789795, 544.21051025, 545.26318359, 546.3157959,
    547.3684082, 548.42108154, 549.47369385, 550.52630615,
    551.57891846, 552.6315918, 553.6842041, 554.73681641,
    555.78948975, 556.84210205, 557.89471436, 558.9473877,
    560., 561.0526123, 562.10528564, 563.15789795,
    564.21051025, 565.26318359, 566.3157959, 567.3684082,
    568.42108154, 569.47369385, 570.52630615, 571.57891846,
    572.6315918, 573.6842041, 574.73681641, 575.78948975,
    576.84210205, 577.89471436, 578.9473877, 580.,
    581.0526123, 582.10528564, 583.15789795, 584.21051025,
    585.26318359, 586.3157959, 587.3684082, 588.42108154,
    589.47369385, 590.52630615, 591.57891846, 592.6315918,
    593.6842041, 594.73681641, 595.78948975, 596.84210205,
    597.89471436, 598.9473877, 600., 601.0526123,
    602.10528564, 603.15789795, 604.21051025, 605.26318359,
    606.3157959, 607.3684082, 608.42108154, 609.47369385,
    610.52630615, 611.57891846, 612.6315918, 613.6842041,
    614.73681641, 615.78948975, 616.84210205, 617.89471436,
    618.9473877, 620., 621.0526123, 622.10528564,
    623.15789795, 624.21051025, 625.26318359, 626.3157959,
    627.3684082, 628.42108154, 629.47369385, 630.52630615,
    631.57891846, 632.6315918, 633.6842041, 634.73681641,
    635.78948975, 636.84210205, 637.89471436, 638.9473877,
    640., 641.0526123, 642.10528564, 643.15789795,
    644.21051025, 645.26318359, 646.3157959, 647.3684082,
    648.42108154, 649.47369385, 650.52630615, 651.57891846,
    652.6315918, 653.6842041, 654.73681641, 655.78948975,
    656.84210205, 657.89471436, 658.9473877, 660.,
    661.0526123, 662.10528564, 663.15789795, 664.21051025,
    665.26318359, 666.3157959, 667.3684082, 668.42108154,
    669.47369385, 670.52630615, 671.57891846, 672.6315918,
    673.6842041, 674.73681641, 675.78948975, 676.84210205,
    677.89471436, 678.9473877, 680., 681.0526123,
    682.10528564, 683.15789795, 684.21051025, 685.26318359,
    686.3157959, 687.3684082, 688.42108154, 689.47369385,
    690.52630615, 691.57891846, 692.6315918, 693.6842041,
    694.73681641, 695.78948975, 696.84210205, 697.89471436,
    698.9473877, 700., 701.0526123, 702.10528564,
    703.15789795, 704.21051025, 705.26318359, 706.3157959,
    707.3684082, 708.42108154, 709.47369385, 710.52630615,
    711.57891846, 712.6315918, 713.6842041, 714.73681641,
    715.78948975, 716.84210205, 717.89471436, 718.9473877,
    720., 721.0526123, 722.10528564, 723.15789795,
    724.21051025, 725.26318359, 726.3157959, 727.3684082,
    728.42108154, 729.47369385, 730.52630615, 731.57891846,
    732.6315918, 733.6842041, 734.73681641, 735.78948975,
    736.84210205, 737.89471436, 738.9473877, 740.,
    741.0526123, 742.10528564, 743.15789795, 744.21051025,
    745.26318359, 746.3157959, 747.3684082, 748.42108154,
    749.47369385, 750.52630615, 751.57891846, 752.6315918,
    753.6842041, 754.73681641, 755.78948975, 756.84210205,
    757.89471436, 758.9473877, 760., 761.0526123,
    762.10528564, 763.15789795, 764.21051025, 765.26318359,
    766.3157959, 767.3684082, 768.42108154, 769.47369385,
    770.52630615, 771.57891846, 772.6315918, 773.6842041,
    774.73681641, 775.78948975, 776.84210205, 777.89471436,
    778.9473877, 780., 781.0526123, 782.10528564,
    783.15789795, 784.21051025, 785.26318359, 786.3157959,
    787.3684082, 788.42108154, 789.47369385, 790.52630615,
    791.57891846, 792.6315918, 793.6842041, 794.73681641,
    795.78948975, 796.84210205, 797.89471436, 798.9473877,
    800., 801.0526123, 802.10528564, 803.15789795,
    804.21051025, 805.26318359, 806.3157959, 807.3684082,
    808.42108154, 809.47369385, 810.52630615, 811.57891846,
    812.6315918, 813.6842041, 814.73681641, 815.78948975,
    816.84210205, 817.89471436, 818.9473877, 820.,
    821.0526123, 822.10528564, 823.15789795, 824.21051025,
    825.26318359, 826.3157959, 827.3684082, 828.42108154,
    829.47369385, 830.52630615, 831.57891846, 832.6315918,
    833.6842041, 834.73681641, 835.78948975, 836.84210205,
    837.89471436, 838.9473877, 840., 841.0526123,
    842.10528564, 843.15789795, 844.21051025, 845.26318359,
    846.3157959, 847.3684082, 848.42108154, 849.47369385,
    850.52630615, 851.57891846, 852.6315918, 853.6842041,
    854.73681641, 855.78948975, 856.84210205, 857.89471436,
    858.9473877, 860., 861.0526123, 862.10528564,
    863.15789795, 864.21051025, 865.26318359, 866.3157959,
    867.3684082, 868.42108154, 869.47369385, 870.52630615,
    871.57891846, 872.6315918, 873.6842041, 874.73681641,
    875.78948975, 876.84210205, 877.89471436, 878.9473877,
    880., 881.0526123, 882.10528564, 883.15789795,
    884.21051025, 885.26318359, 886.3157959, 887.3684082,
    888.42108154, 889.47369385, 890.52630615, 891.57891846,
    892.6315918, 893.6842041, 894.73681641, 895.78948975,
    896.84210205, 897.89471436, 898.9473877, 900.,
    901.0526123, 902.10528564, 903.15789795, 904.21051025,
    905.26318359, 906.3157959, 907.3684082, 908.42108154,
    909.47369385, 910.52630615, 911.57891846, 912.6315918,
    913.6842041, 914.73681641, 915.78948975, 916.84210205,
    917.89471436, 918.9473877, 920., 921.0526123,
    922.10528564, 923.15789795, 924.21051025, 925.26318359,
    926.3157959, 927.3684082, 928.42108154, 929.47369385,
    930.52630615, 931.57891846, 932.6315918, 933.6842041,
    934.73681641, 935.78948975, 936.84210205, 937.89471436,
    938.9473877, 940., 941.0526123, 942.10528564,
    943.15789795, 944.21051025, 945.26318359, 946.3157959,
    947.3684082, 948.42108154, 949.47369385, 950.52630615,
    951.57891846, 952.6315918, 953.6842041, 954.73681641,
    955.78948975, 956.84210205, 957.89471436, 958.9473877,
    960., 961.0526123, 962.10528564, 963.15789795,
    964.21051025, 965.26318359, 966.3157959, 967.3684082,
    968.42108154, 969.47369385, 970.52630615, 971.57891846,
    972.6315918, 973.6842041, 974.73681641, 975.78948975,
    976.84210205, 977.89471436, 978.9473877, 980.,
    981.0526123, 982.10528564, 983.15789795, 984.21051025,
    985.26318359, 986.3157959, 987.3684082, 988.42108154,
    989.47369385, 990.52630615, 991.57891846, 992.6315918,
    993.6842041, 994.73681641, 995.78948975, 996.84210205,
    997.89471436, 998.9473877, 1000.])

eQubit = np.array([
    -2.07058634e+00, -2.17770649e-02, -4.20500694e-03, -1.01260075e-03,
    2.20841359e-05, 4.11919277e-04, 5.34593559e-04, 5.25286156e-04,
    4.46591641e-04, 3.34319677e-04, 2.12061046e-04, 9.65127775e-05,
    -8.10143687e-07, -7.29050464e-05, -1.16777963e-04, -1.32959400e-04,
    -1.24722159e-04, -9.73457267e-05, -5.73057626e-05, -1.16212168e-05,
    3.27904611e-05, 6.97042593e-05, 9.42384224e-05, 1.03411932e-04,
    9.65825392e-05, 7.55593859e-05, 4.43354232e-05, 8.44159988e-06,
    -2.59872501e-05, -5.32196077e-05, -6.88203659e-05, -7.02957969e-05,
    -5.74012962e-05, -3.21803188e-05, 1.28407769e-06, 3.73763691e-05,
    6.96804817e-05, 9.19719267e-05, 9.93048185e-05, 8.90498413e-05,
    6.16420849e-05, 2.07828837e-05, -2.69765052e-05, -7.32140602e-05,
    -1.08914320e-04, -1.25811033e-04, -1.17509155e-04, -8.03509875e-05,
    -1.39508878e-05, 7.84869850e-05, 1.90171279e-04, 3.11038426e-04,
    4.28540104e-04, 5.29031321e-04, 5.99663261e-04, 6.30602585e-04,
    6.16991536e-04, 5.60104707e-04, 4.67243641e-04, 3.50390268e-04,
    2.24017842e-04, 1.02687047e-04, -1.02767705e-06, -7.79610581e-05,
    -1.23093522e-04, -1.35727363e-04, -1.19195127e-04, -8.02504689e-05,
    -2.81087917e-05, 2.67894427e-05, 7.42958922e-05, 1.06131890e-04,
    1.17250528e-04, 1.06683816e-04, 7.76021550e-05, 3.65478364e-05,
    -7.94961119e-06, -4.70699644e-05, -7.33067311e-05, -8.17175147e-05,
    -7.06467456e-05, -4.19396217e-05, -6.37644935e-07, 4.58211906e-05,
    8.87849691e-05, 1.19897227e-04, 1.32683443e-04, 1.23949553e-04,
    9.46288653e-05, 4.98037157e-05, -2.14491971e-06, -5.11063228e-05,
    -8.71070980e-05, -1.02093232e-04, -9.13326622e-05, -5.43032685e-05,
    4.95587575e-06, 7.80261021e-05, 1.52900998e-04, 2.15469274e-04,
    2.51734111e-04, 2.50631395e-04, 2.06921951e-04, 1.23292621e-04,
    1.08125671e-05, -1.12515817e-04, -2.24535980e-04, -3.02049891e-04,
    -3.23235059e-04, -2.69064832e-04, -1.23847151e-04, 1.24561338e-04,
    4.84058297e-04, 9.56136265e-04, 1.53127690e-03, 2.18187037e-03,
    2.85477529e-03, 3.46959085e-03, 3.93062801e-03, 4.15507225e-03,
    4.10557407e-03, 3.80565235e-03, 3.32695014e-03, 2.75924038e-03,
    2.18319355e-03, 1.65679197e-03, 1.21408240e-03, 8.70102561e-04,
    6.26969267e-04, 4.78557326e-04, 4.12988373e-04, 4.13214589e-04,
    4.56750308e-04, 5.16149974e-04, 5.61723553e-04, 5.66948853e-04,
    5.15037365e-04, 4.03794591e-04, 2.46207346e-04, 6.66912083e-05,
    -1.04956341e-04, -2.39341073e-04, -3.11611536e-04, -3.04031005e-04,
    -2.08120255e-04, -2.72465662e-05, 2.20279334e-04, 4.99015503e-04,
    7.58148069e-04, 9.40111288e-04, 9.95698312e-04, 9.00006765e-04,
    6.60857644e-04, 3.15670711e-04, -7.96330117e-05, -4.62088976e-04,
    -7.67911696e-04, -9.32218304e-04, -8.83958314e-04, -5.38790424e-04,
    2.05596331e-04, 1.46281793e-03, 3.32090967e-03, 5.74855649e-03,
    8.44854507e-03, 1.07882013e-02, 1.20425573e-02, 1.18830183e-02,
    1.05700273e-02, 8.64964653e-03, 6.59179167e-03, 4.66836503e-03,
    2.99527405e-03, 1.60485248e-03, 4.96823499e-04, -3.34623881e-04,
    -8.89145112e-04, -1.15781399e-03, -1.12813971e-03, -7.97536839e-04,
    -1.95920638e-04, 5.88769425e-04, 1.40148151e-03, 2.05149578e-03,
    2.38235650e-03, 2.33471550e-03, 1.95499542e-03, 1.35451944e-03,
    6.60632504e-04, -1.07940649e-05, -5.59542234e-04, -8.91910598e-04,
    -9.08092187e-04, -4.93671022e-04, 4.74101570e-04, 2.08668958e-03,
    4.31147006e-03, 6.86728824e-03, 9.19607296e-03, 1.06866765e-02,
    1.10354642e-02, 1.03725193e-02, 9.06629089e-03, 7.48028070e-03,
    5.86623640e-03, 4.36767227e-03, 3.05811624e-03, 1.97522299e-03,
    1.14199770e-03, 5.76647115e-04, 2.93595777e-04, 2.97206819e-04,
    5.69820476e-04, 1.05892742e-03, 1.67240158e-03, 2.29123699e-03,
    2.80031224e-03, 3.12313876e-03, 3.24147510e-03, 3.19217622e-03,
    3.04931550e-03, 2.90444882e-03, 2.85223598e-03, 2.98086319e-03,
    3.36276322e-03, 4.04116752e-03, 5.01215595e-03, 6.20944119e-03,
    7.50548607e-03, 8.73934246e-03, 9.76374574e-03, 1.04868199e-02,
    1.08870170e-02, 1.10008383e-02, 1.08985946e-02, 1.06627374e-02,
    1.03744452e-02, 1.01069306e-02, 9.92227863e-03, 9.86888007e-03,
    9.97877444e-03, 1.02660080e-02, 1.07283270e-02, 1.13540859e-02,
    1.21340101e-02, 1.30743888e-02, 1.42070334e-02, 1.55926296e-02,
    1.73164972e-02, 1.94762647e-02, 2.21609022e-02, 2.54199084e-02,
    2.92256398e-02, 3.34420903e-02, 3.78264381e-02, 4.20885096e-02,
    4.60008367e-02, 4.95051073e-02, 5.27554909e-02, 5.60879233e-02,
    5.99537660e-02, 6.48531638e-02, 7.12546767e-02, 7.94365066e-02,
    8.91585139e-02, 9.91911197e-02, 1.07152721e-01, 1.10461920e-01,
    1.08162268e-01, 1.01601054e-01, 9.31406871e-02, 8.46608059e-02,
    7.71073383e-02, 7.07350893e-02, 6.54449088e-02, 6.10035215e-02,
    5.71552579e-02, 5.36761015e-02, 5.04026986e-02, 4.72454464e-02,
    4.41863946e-02, 4.12608567e-02, 3.85287933e-02, 3.60457484e-02,
    3.38429719e-02, 3.19189728e-02, 3.02420209e-02, 2.87592891e-02,
    2.74087859e-02, 2.61311258e-02, 2.48795054e-02, 2.36268526e-02,
    2.23689454e-02, 2.11225648e-02, 1.99191266e-02, 1.87959067e-02,
    1.77876562e-02, 1.69206255e-02, 1.62093811e-02, 1.56556387e-02,
    1.52479770e-02, 1.49617661e-02, 1.47594583e-02, 1.45922271e-02,
    1.44043816e-02, 1.41415394e-02, 1.37617856e-02, 1.32464764e-02,
    1.26058566e-02, 1.18762369e-02, 1.11097591e-02, 1.03615669e-02,
    9.67948690e-03, 9.09869570e-03, 8.64083197e-03, 8.31547078e-03,
    8.12192390e-03, 8.05011435e-03, 8.08020764e-03, 8.18160888e-03,
    8.31286078e-03, 8.42473013e-03, 8.46832280e-03, 8.40755321e-03,
    8.23124799e-03, 7.95815746e-03, 7.63168495e-03, 7.30773206e-03,
    7.04267975e-03, 6.88644244e-03, 6.88122287e-03, 7.06388958e-03,
    7.46910885e-03, 8.13002713e-03, 9.07125823e-03, 1.02851872e-02,
    1.16824966e-02, 1.30299063e-02, 1.39499862e-02, 1.40873451e-02,
    1.33676064e-02, 1.20557716e-02, 1.05427202e-02, 9.12955844e-03,
    7.97138822e-03, 7.11683615e-03, 6.55631470e-03, 6.25088825e-03,
    6.14710945e-03, 6.18867101e-03, 6.33000872e-03, 6.54885768e-03,
    6.85015626e-03, 7.25634397e-03, 7.78649331e-03, 8.43422789e-03,
    9.15953261e-03, 9.90608911e-03, 1.06361696e-02, 1.13536712e-02,
    1.20904291e-02, 1.28599291e-02, 1.36059142e-02, 1.41820514e-02,
    1.43943672e-02, 1.40987200e-02, 1.32832070e-02, 1.20658920e-02,
    1.06231419e-02, 9.11869465e-03, 7.67364982e-03, 6.37107130e-03,
    5.27523114e-03, 4.45352082e-03, 3.99802447e-03, 4.04662896e-03,
    4.79798055e-03, 6.49466794e-03, 9.30923233e-03, 1.30575976e-02,
    1.68780380e-02, 1.94576554e-02, 1.99984565e-02, 1.87603066e-02,
    1.65404130e-02, 1.40218813e-02, 1.15878629e-02, 9.40398137e-03,
    7.52929621e-03, 5.98762438e-03, 4.80512296e-03, 4.02880441e-03,
    3.73197351e-03, 4.00224572e-03, 4.89882587e-03, 6.37043097e-03,
    8.16793354e-03, 9.85357682e-03, 1.09799757e-02, 1.13184766e-02,
    1.09244209e-02, 1.00234347e-02, 8.87223584e-03, 7.69103645e-03,
    6.66113645e-03, 5.95168565e-03, 5.75025139e-03, 6.27931666e-03,
    7.76882154e-03, 1.03355906e-02, 1.37531982e-02, 1.72831222e-02,
    1.99197831e-02, 2.10131610e-02, 2.05995646e-02, 1.91471196e-02,
    1.71630415e-02, 1.50120849e-02, 1.29144180e-02, 1.10008894e-02,
    9.36573782e-03, 8.10390594e-03, 7.33497524e-03, 7.21246416e-03,
    7.90799975e-03, 9.55052864e-03, 1.21123011e-02, 1.52900832e-02,
    1.85090397e-02, 2.11338223e-02, 2.27561423e-02, 2.33187986e-02,
    2.30241956e-02, 2.21714438e-02, 2.10478354e-02, 1.98953591e-02,
    1.89268277e-02, 1.83697228e-02, 1.85358665e-02, 1.99346181e-02,
    2.34599078e-02, 3.06593595e-02, 4.38601135e-02, 6.49914288e-02,
    9.08664026e-02, 1.09280793e-01, 1.10743093e-01, 1.00007662e-01,
    8.58289770e-02, 7.26517119e-02, 6.16062485e-02, 5.26284326e-02,
    4.53970899e-02, 3.96038469e-02, 3.50090215e-02, 3.14526496e-02,
    2.88652881e-02, 2.72862884e-02, 2.68877061e-02, 2.79869868e-02,
    3.09897796e-02, 3.61300890e-02, 4.28963552e-02, 4.95154957e-02,
    5.35793322e-02, 5.38173907e-02, 5.08332385e-02, 4.60820150e-02,
    4.07817267e-02, 3.56157854e-02, 3.08671460e-02, 2.66053676e-02,
    2.28157998e-02, 1.94778954e-02, 1.66208456e-02, 1.43860272e-02,
    1.31278396e-02, 1.35932572e-02, 1.71993664e-02, 2.62168858e-02,
    4.28717451e-02, 6.56719071e-02, 8.62283210e-02, 9.63518495e-02,
    9.66075592e-02, 9.21092560e-02, 8.66826138e-02, 8.20910115e-02,
    7.89828000e-02, 7.75859230e-02, 7.80164322e-02, 8.03728381e-02,
    8.47194571e-02, 9.10054076e-02, 9.89791318e-02, 1.08197252e-01,
    1.18202380e-01, 1.28780158e-01, 1.40043576e-01, 1.52114506e-01,
    1.64342824e-01, 1.74336400e-01, 1.78010834e-01, 1.72308792e-01,
    1.58640045e-01, 1.41906489e-01, 1.26445029e-01, 1.14218714e-01,
    1.05516510e-01, 1.00007254e-01, 9.73253884e-02, 9.73007998e-02,
    1.00048943e-01, 1.06032095e-01, 1.16094082e-01, 1.31240693e-01,
    1.51215239e-01, 1.69799814e-01, 1.70460708e-01, 1.44344672e-01,
    1.09775785e-01, 8.38087840e-02, 6.81380706e-02, 5.94304535e-02,
    5.48605472e-02, 5.27076638e-02, 5.19513008e-02, 5.19108166e-02,
    5.20227251e-02, 5.17305851e-02, 5.04974114e-02, 4.79657210e-02,
    4.41893568e-02, 3.97033051e-02, 3.52733112e-02, 3.15182728e-02,
    2.87213831e-02, 2.68820089e-02, 2.58540718e-02, 2.54514060e-02,
    2.54965365e-02, 2.58321504e-02, 2.63171604e-02, 2.68216569e-02,
    2.72281829e-02, 2.74412034e-02, 2.74013896e-02, 2.70973833e-02,
    2.65675072e-02, 2.58882358e-02, 2.51530035e-02, 2.44490131e-02,
    2.38400231e-02, 2.33586362e-02, 2.30072735e-02, 2.27644102e-02,
    2.25933224e-02, 2.24515985e-02, 2.23002439e-02, 2.21112122e-02,
    2.18717851e-02, 2.15851645e-02, 2.12680954e-02, 2.09470890e-02,
    2.06544885e-02, 2.04244510e-02, 2.02883768e-02, 2.02694252e-02,
    2.03763722e-02, 2.05977216e-02, 2.08976913e-02, 2.12168536e-02,
    2.14808043e-02, 2.16179866e-02, 2.15817281e-02, 2.13659651e-02,
    2.10059017e-02, 2.05644853e-02, 2.01141767e-02, 1.97233754e-02,
    1.94510102e-02, 1.93476697e-02, 1.94599265e-02, 1.98349862e-02,
    2.05232142e-02, 2.15754778e-02, 2.30299878e-02, 2.48813771e-02,
    2.70284993e-02, 2.92203649e-02, 3.10624793e-02, 3.21534396e-02,
    3.23033182e-02, 3.16391605e-02, 3.04963037e-02, 2.92279182e-02,
    2.80928484e-02, 2.72430773e-02, 2.67555030e-02, 2.66639323e-02,
    2.69745371e-02, 2.76621627e-02, 2.86497863e-02, 2.97821775e-02,
    3.08203646e-02, 3.14919160e-02, 3.15979084e-02, 3.11073810e-02,
    3.01578135e-02, 2.89686123e-02, 2.77478087e-02, 2.66468965e-02,
    2.57604229e-02, 2.51451431e-02, 2.48400447e-02, 2.48798427e-02,
    2.52992480e-02, 2.61259770e-02, 2.73607092e-02, 2.89468663e-02,
    3.07453433e-02, 3.25433368e-02, 3.41178403e-02, 3.53296929e-02,
    3.61849055e-02, 3.68267612e-02, 3.74858058e-02, 3.84394825e-02,
    4.00071246e-02, 4.25776837e-02, 4.66474821e-02, 5.28074066e-02,
    6.15237169e-02, 7.24324134e-02, 8.32310995e-02, 8.98805588e-02,
    8.98686250e-02, 8.46458902e-02, 7.74274319e-02, 7.04587521e-02,
    6.46177503e-02, 6.00272631e-02, 5.65427054e-02, 5.39736830e-02,
    5.21580448e-02, 5.09753654e-02, 5.03395600e-02, 5.01866727e-02,
    5.04649528e-02, 5.11315925e-02, 5.21575718e-02, 5.35399823e-02,
    5.53190145e-02, 5.75975190e-02, 6.05618524e-02, 6.45082470e-02,
    6.98750901e-02, 7.72713983e-02, 8.74358093e-02, 1.00942819e-01,
    1.17304834e-01, 1.33513210e-01, 1.44099787e-01, 1.45410929e-01,
    1.39458730e-01, 1.31156282e-01, 1.24109027e-01, 1.19862152e-01,
    1.18858623e-01, 1.21217216e-01, 1.26996102e-01, 1.35925807e-01,
    1.46286384e-01, 1.52768049e-01, 1.46578523e-01, 1.24616512e-01,
    9.66724346e-02, 7.35971864e-02, 5.82476684e-02, 4.89920826e-02,
    4.36579880e-02, 4.06575425e-02, 3.89636664e-02, 3.79023180e-02,
    3.69993696e-02, 3.59069044e-02, 3.44006569e-02, 3.24189305e-02,
    3.00883246e-02, 2.76796735e-02, 2.54959660e-02, 2.37650131e-02,
    2.25978479e-02, 2.20074017e-02, 2.19496831e-02, 2.23597223e-02,
    2.31757455e-02, 2.43527022e-02, 2.58686292e-02, 2.77269167e-02,
    2.99571463e-02, 3.26155721e-02, 3.57847635e-02, 3.95692083e-02,
    4.40775892e-02, 4.93723393e-02, 5.53510193e-02, 6.15276194e-02,
    6.67870132e-02, 6.94811938e-02, 6.83448790e-02, 6.36846840e-02,
    5.72503781e-02, 5.08480885e-02, 4.54311095e-02, 4.11718938e-02,
    3.78624135e-02, 3.52146261e-02, 3.30178172e-02, 3.11916870e-02,
    2.97556012e-02, 2.87529543e-02, 2.81945167e-02, 2.80499066e-02,
    2.82681273e-02, 2.87984154e-02, 2.96000709e-02, 3.06429077e-02,
    3.19015170e-02, 3.33459651e-02, 3.49286256e-02, 3.65667969e-02,
    3.81235311e-02, 3.93966037e-02, 4.01366549e-02, 4.01183230e-02,
    3.92547279e-02, 3.76816039e-02, 3.57248547e-02, 3.37631627e-02,
    3.20936861e-02, 3.08777779e-02, 3.01553270e-02, 2.98802244e-02,
    2.99450414e-02, 3.01868500e-02, 3.03816857e-02, 3.02478289e-02,
    2.94892900e-02, 2.79019485e-02, 2.55035808e-02, 2.25768356e-02,
    1.95563221e-02, 1.68417399e-02, 1.46778511e-02, 1.31417943e-02,
    1.21892602e-02, 1.17052826e-02, 1.15384260e-02, 1.15217979e-02,
    1.14975062e-02, 1.13590209e-02, 1.10978937e-02, 1.08048068e-02,
    1.06020414e-02, 1.05667739e-02, 1.07088067e-02, 1.09952800e-02,
    1.13816852e-02, 1.18288823e-02, 1.23056903e-02, 1.27832787e-02,
    1.32260887e-02, 1.35831298e-02, 1.37836792e-02, 1.37429226e-02,
    1.33840374e-02, 1.26762199e-02, 1.16715858e-02, 1.05085985e-02,
    9.36595543e-03, 8.39530027e-03, 7.67974011e-03, 7.23506241e-03,
    7.03394070e-03, 7.02820941e-03, 7.15990402e-03, 7.36514145e-03,
    7.57764454e-03, 7.73540650e-03, 7.79011321e-03, 7.71648003e-03,
    7.51771985e-03, 7.22424410e-03, 6.88552080e-03, 6.55785224e-03,
    6.29241119e-03, 6.12702599e-03, 6.08298479e-03, 6.16571965e-03,
    6.36752363e-03, 6.67044697e-03, 7.04868469e-03, 7.47080925e-03,
    7.90298148e-03, 8.31398202e-03, 8.68115394e-03, 8.99444939e-03,
    9.25554437e-03, 9.47225071e-03, 9.65208377e-03, 9.79881696e-03,
    9.91341440e-03, 9.99774167e-03, 1.00583170e-02, 1.01076348e-02,
    1.01619815e-02, 1.02354879e-02, 1.03320177e-02, 1.04387158e-02,
    1.05270988e-02, 1.05663721e-02, 1.05434541e-02, 1.04737527e-02,
    1.03930400e-02, 1.03394877e-02, 1.03404525e-02, 1.04089326e-02,
    1.05458733e-02, 1.07439396e-02, 1.09905729e-02, 1.12700778e-02,
    1.15654372e-02, 1.18601650e-02, 1.21405230e-02, 1.23978241e-02,
    1.26301127e-02, 1.28425042e-02, 1.30459521e-02, 1.32546238e-02,
    1.34827982e-02, 1.37420292e-02, 1.40392208e-02, 1.43757898e-02,
    1.47481175e-02, 1.51493048e-02, 1.55720798e-02, 1.60119575e-02,
    1.64690148e-02, 1.69472752e-02, 1.74525251e-02, 1.79912553e-02,
    1.85717709e-02, 1.92056833e-02, 1.99072869e-02, 2.06899115e-02,
    2.15596048e-02, 2.25073008e-02, 2.35004066e-02, 2.44768846e-02,
    2.53472394e-02, 2.60117122e-02, 2.63934373e-02, 2.64732146e-02,
    2.63005128e-02, 2.59697557e-02, 2.55812719e-02, 2.52154979e-02,
    2.49286729e-02, 2.47595348e-02, 2.47335649e-02, 2.48608551e-02,
    2.51285281e-02, 2.54900125e-02, 2.58537984e-02, 2.60794193e-02,
    2.59969665e-02, 2.54655536e-02, 2.44569532e-02, 2.31024096e-02,
    2.16451037e-02, 2.03288523e-02, 1.93124296e-02, 1.86530792e-02,
    1.83341758e-02, 1.82999834e-02, 1.84801428e-02, 1.88043335e-02,
    1.92125305e-02, 1.96636506e-02, 2.01415276e-02, 2.06547491e-02,
    2.12293963e-02, 2.18977289e-02, 2.26863266e-02, 2.36062145e-02,
    2.46428591e-02, 2.57413883e-02, 2.67831623e-02, 2.75566526e-02,
    2.77536444e-02, 2.70583870e-02, 2.53602365e-02, 2.29287738e-02,
    2.03042730e-02, 1.79817646e-02, 1.62161841e-02, 1.50461160e-02,
    1.43990993e-02, 1.41712330e-02, 1.42627564e-02, 1.45861707e-02,
    1.50623670e-02, 1.56133194e-02, 1.61566239e-02, 1.66060983e-02,
    1.68814946e-02, 1.69256277e-02, 1.67198795e-02, 1.62886527e-02,
    1.56938456e-02, 1.50257338e-02, 1.43879780e-02, 1.38742417e-02,
    1.35456049e-02, 1.34211879e-02, 1.34807780e-02, 1.36712511e-02,
    1.39113160e-02, 1.40972161e-02, 1.41184823e-02, 1.38932978e-02,
    1.34155672e-02, 1.27772409e-02, 1.21270570e-02, 1.15814502e-02,
    1.11542246e-02, 1.07550995e-02, 1.02558935e-02, 9.58192218e-03,
    8.75843192e-03, 7.87554225e-03, 7.01942399e-03, 6.23804254e-03,
    5.55066203e-03, 4.97041520e-03, 4.51591680e-03, 4.20816587e-03,
    4.06073454e-03, 4.07265119e-03, 4.22735502e-03])

eCoupler = np.array([
    1.72522114e-04, 1.31323752e-04, 9.07928113e-05, 3.24186869e-05,
    -3.21556776e-05, -9.01852333e-05, -1.30330319e-04, -1.44827039e-04,
    -1.30882477e-04, -9.11846298e-05, -3.33858557e-05, 3.12811303e-05,
    9.01049979e-05, 1.31369399e-04, 1.46736238e-04, 1.32991463e-04,
    9.27681841e-05, 3.40303758e-05, -3.15710872e-05, -9.10588310e-05,
    -1.32695953e-04, -1.48266550e-04, -1.34582272e-04, -9.41521628e-05,
    -3.47148427e-05, 3.21521161e-05, 9.32207309e-05, 1.36234680e-04,
    1.52384691e-04, 1.38196379e-04, 9.63197206e-05, 3.49938187e-05,
    -3.36015171e-05, -9.58192675e-05, -1.39235273e-04, -1.55079164e-04,
    -1.39922692e-04, -9.64293864e-05, -3.29402158e-05, 3.80257694e-05,
    1.02150177e-04, 1.46174596e-04, 1.60695310e-04, 1.42236569e-04,
    9.41478648e-05, 2.60170506e-05, -4.81393946e-05, -1.12636514e-04,
    -1.53148309e-04, -1.59501140e-04, -1.27708752e-04, -6.09900058e-05,
    3.05342271e-05, 1.31394106e-04, 2.23504158e-04, 2.89577839e-04,
    3.16590404e-04, 2.98518512e-04, 2.37669236e-04, 1.44348973e-04,
    3.48693883e-05, -7.15543690e-05, -1.56346700e-04, -2.04984020e-04,
    -2.09535851e-04, -1.70160596e-04, -9.51859067e-05, 2.79941758e-07,
    9.70837878e-05, 1.75608574e-04, 2.19737587e-04, 2.20110779e-04,
    1.76155153e-04, 9.62246918e-05, -4.08526628e-06, -1.04987007e-04,
    -1.86424676e-04, -2.31880831e-04, -2.31600816e-04, -1.84514050e-04,
    -9.87030719e-05, 9.92426634e-06, 1.20449738e-04, 2.10932206e-04,
    2.62767112e-04, 2.64477925e-04, 2.14303115e-04, 1.20709874e-04,
    9.71114151e-07, -1.22060688e-04, -2.24255402e-04, -2.84867596e-04,
    -2.90576876e-04, -2.38173298e-04, -1.35463565e-04, -7.48711710e-08,
    1.43627305e-04, 2.68863111e-04, 3.51249856e-04, 3.73147940e-04,
    3.26981834e-04, 2.17119568e-04, 5.99155880e-05, -1.18373456e-04,
    -2.85815486e-04, -4.10698360e-04, -4.67458190e-04, -4.41302702e-04,
    -3.29841706e-04, -1.41254015e-04, 1.10700357e-04, 4.12937288e-04,
    7.58018804e-04, 1.14463512e-03, 1.57178514e-03, 2.02782371e-03,
    2.47982247e-03, 2.87240942e-03, 3.14350101e-03, 3.25228095e-03,
    3.20119947e-03, 3.03374256e-03, 2.80944244e-03, 2.57460048e-03,
    2.34646071e-03, 2.11570503e-03, 1.86129164e-03, 1.56789826e-03,
    1.23802972e-03, 8.94662525e-04, 5.75159382e-04, 3.19344045e-04,
    1.56576154e-04, 9.59329987e-05, 1.23019848e-04, 2.04614039e-04,
    2.98979014e-04, 3.67045448e-04, 3.80084933e-04, 3.22988350e-04,
    1.95119430e-04, 1.07080029e-05, -2.00968611e-04, -3.97417931e-04,
    -5.28437088e-04, -5.46002792e-04, -4.17779011e-04, -1.41543507e-04,
    2.44817410e-04, 6.63819375e-04, 1.01392264e-03, 1.19599713e-03,
    1.14047101e-03, 8.24488458e-04, 2.76489968e-04, -4.27775355e-04,
    -1.17214277e-03, -1.80654781e-03, -2.15245606e-03, -2.00882109e-03,
    -1.16400332e-03, 5.76828848e-04, 3.33315415e-03, 7.04617156e-03,
    1.13490674e-02, 1.55122337e-02, 1.86330143e-02, 2.00603522e-02,
    1.96856947e-02, 1.78346568e-02, 1.49815509e-02, 1.15686221e-02,
    7.95666582e-03, 4.43290868e-03, 1.23237829e-03, -1.44228069e-03,
    -3.40864301e-03, -4.50673401e-03, -4.62222221e-03, -3.73374261e-03,
    -1.97378567e-03, 3.30145686e-04, 2.68311299e-03, 4.54271060e-03,
    5.48669746e-03, 5.33390538e-03, 4.15731845e-03, 2.21156211e-03,
    -1.59113888e-04, -2.58426551e-03, -4.69208753e-03, -6.10992863e-03,
    -6.46321556e-03, -5.39752764e-03, -2.64979663e-03, 1.81978535e-03,
    7.67121645e-03, 1.41148645e-02, 2.00626902e-02, 2.44952694e-02,
    2.68244873e-02, 2.70125070e-02, 2.54294255e-02, 2.26167079e-02,
    1.91067521e-02, 1.53381779e-02, 1.16401333e-02, 8.24525351e-03,
    5.30787413e-03, 2.91654903e-03, 1.10083435e-03, -1.63463732e-04,
    -9.45189942e-04, -1.34152836e-03, -1.45516233e-03, -1.36933826e-03,
    -1.12506153e-03, -7.04756201e-04, -2.75407522e-05, 1.03926072e-03,
    2.64743282e-03, 4.91546260e-03, 7.86496974e-03, 1.13646678e-02,
    1.51153402e-02, 1.87052832e-02, 2.17331338e-02, 2.39452891e-02,
    2.53118865e-02, 2.59987644e-02, 2.62587766e-02, 2.63045904e-02,
    2.62248944e-02, 2.59741320e-02, 2.54235257e-02, 2.44332298e-02,
    2.29047117e-02, 2.07997739e-02, 1.81334318e-02, 1.49610221e-02,
    1.13736178e-02, 7.50723328e-03, 3.56538788e-03, -1.52325288e-04,
    -3.22209312e-03, -5.08123617e-03, -5.05155699e-03, -2.43916858e-03,
    3.24279300e-03, 1.19328534e-02, 2.27135197e-02, 3.38267268e-02,
    4.31939038e-02, 4.91865992e-02, 5.11218629e-02, 4.92334892e-02,
    4.43222258e-02, 3.74045259e-02, 2.95153417e-02, 2.16653790e-02,
    1.48873104e-02, 1.03009956e-02, 9.10594130e-03, 1.23877662e-02,
    2.06524727e-02, 3.32144078e-02, 4.79388439e-02, 6.18770025e-02,
    7.25719932e-02, 7.90473976e-02, 8.18876589e-02, 8.27767975e-02,
    8.41245119e-02, 8.90668611e-02, 1.01736242e-01, 1.27218566e-01,
    1.69671832e-01, 2.26554062e-01, 2.82290348e-01, 3.15259813e-01,
    3.17126825e-01, 2.96462994e-01, 2.65674857e-01, 2.32773094e-01,
    2.01237978e-01, 1.72032301e-01, 1.45055925e-01, 1.19864818e-01,
    9.59855725e-02, 7.30587008e-02, 5.09436624e-02, 2.98578330e-02,
    1.05981953e-02, -5.13393126e-03, -1.43927390e-02, -1.29910754e-02,
    3.35597127e-03, 3.60983286e-02, 8.06218643e-02, 1.26896423e-01,
    1.65095810e-01, 1.90567455e-01, 2.03870406e-01, 2.08058185e-01,
    2.06432530e-01, 2.01555065e-01, 1.94995712e-01, 1.87323371e-01,
    1.78220548e-01, 1.66757740e-01, 1.51807782e-01, 1.32385583e-01,
    1.07755075e-01, 7.73374764e-02, 4.06286367e-02, -2.62508497e-03,
    -5.15642505e-02, -1.01694758e-01, -1.38781393e-01, -1.28423046e-01,
    -1.68843850e-02, 2.10679904e-01, 4.61941680e-01, 6.33917410e-01,
    7.14236925e-01, 7.30313699e-01, 6.89197006e-01, 5.33419845e-01,
    3.40293577e-02, -8.97187931e-01, -8.78257926e-01, -4.07850420e-01,
    -1.15070179e-01, 4.90424146e-02, 1.48383677e-01, 2.14338520e-01,
    2.62148731e-01, 2.99825959e-01, 3.32055598e-01, 3.62014476e-01,
    3.92349694e-01, 4.25880934e-01, 4.66359347e-01, 5.19598729e-01,
    5.95221687e-01, 7.07840139e-01, 8.65539963e-01, 9.94858146e-01,
    8.81083557e-01, 5.94487642e-01, 3.95957314e-01, 3.05328147e-01,
    2.75026390e-01, 2.75234401e-01, 2.90926617e-01, 3.14564275e-01,
    3.42225654e-01, 3.71390569e-01, 3.99406941e-01, 4.22480882e-01,
    4.36023959e-01, 4.37573136e-01, 4.30525052e-01, 4.23187639e-01,
    4.23130610e-01, 4.33818813e-01, 4.55584199e-01, 4.87442220e-01,
    5.27198235e-01, 5.68131819e-01, 5.88514948e-01, 5.33791209e-01,
    3.45578713e-01, 1.07150435e-01, -2.72090573e-02, -5.55126055e-02,
    -3.56121078e-02, -5.53511435e-04, 3.75020590e-02, 7.50629317e-02,
    1.11705805e-01, 1.48054951e-01, 1.85116070e-01, 2.24074486e-01,
    2.66168076e-01, 3.12283612e-01, 3.61616289e-01, 4.07818191e-01,
    4.30639960e-01, 3.91084493e-01, 2.69651955e-01, 1.26911518e-01,
    3.43154117e-02, -3.14536872e-03, -8.61188781e-03, 1.98192649e-04,
    1.39655848e-02, 2.80422997e-02, 3.98276603e-02, 4.75450300e-02,
    4.99042927e-02, 4.63752277e-02, 3.77871943e-02, 2.66136250e-02,
    1.62711119e-02, 9.66974725e-03, 8.16623143e-03, 1.15876369e-02,
    1.88831576e-02, 2.87189734e-02, 3.97399594e-02, 5.05801229e-02,
    5.97982875e-02, 6.59109938e-02, 6.76190722e-02, 6.41901431e-02,
    5.58453679e-02, 4.39559657e-02, 3.08242052e-02, 1.89740777e-02,
    1.02887350e-02, 5.54710747e-03, 4.53768076e-03, 6.46854521e-03,
    1.03427527e-02, 1.51661774e-02, 2.00238198e-02, 2.41060864e-02,
    2.67468186e-02, 2.75024451e-02, 2.62517673e-02, 2.32623741e-02,
    1.91617649e-02, 1.47797354e-02, 1.09077112e-02, 8.08705657e-03,
    6.52330978e-03, 6.13787765e-03, 6.69282741e-03, 7.91515450e-03,
    9.57648937e-03, 1.15166973e-02, 1.36219931e-02, 1.57885179e-02,
    1.79224101e-02, 2.00228259e-02, 2.23520758e-02, 2.55663485e-02,
    3.05848204e-02, 3.81531116e-02, 4.84304717e-02, 6.08878402e-02,
    7.43638105e-02, 8.70104796e-02, 9.62237952e-02, 9.91255522e-02,
    9.40922829e-02, 8.24094645e-02, 6.78683795e-02, 5.42861719e-02,
    4.36573307e-02, 3.62154810e-02, 3.13808076e-02, 2.85644816e-02,
    2.75425443e-02, 2.83994176e-02, 3.11546423e-02, 3.53642756e-02,
    3.99950266e-02, 4.36214377e-02, 4.48491464e-02, 4.28673568e-02,
    3.78994193e-02, 3.11697157e-02, 2.42996190e-02, 1.85908945e-02,
    1.46956490e-02, 1.27083411e-02, 1.24216947e-02, 1.35448227e-02,
    1.58246750e-02, 1.90857976e-02, 2.32154167e-02, 2.81168277e-02,
    3.36569622e-02, 3.96329055e-02, 4.57680415e-02, 5.17245555e-02,
    5.71158934e-02, 6.15135183e-02, 6.44636707e-02, 6.55369671e-02,
    6.44208267e-02, 6.10329579e-02, 5.55990849e-02, 4.86387881e-02,
    4.08565687e-02, 3.29937930e-02, 2.57053067e-02, 1.94843197e-02,
    1.46301630e-02, 1.12510971e-02, 9.29879320e-03, 8.62246393e-03,
    9.02598206e-03, 1.03120019e-02, 1.23044967e-02, 1.48468174e-02,
    1.77785030e-02, 2.09040356e-02, 2.39749150e-02, 2.67035311e-02,
    2.88100409e-02, 3.00857452e-02, 3.04497695e-02, 2.99777140e-02,
    2.88893455e-02, 2.74979673e-02, 2.61404411e-02, 2.51141784e-02,
    2.46388840e-02, 2.48452590e-02, 2.57819982e-02, 2.74266460e-02,
    2.96934927e-02, 3.24365082e-02, 3.54531814e-02, 3.84921461e-02,
    4.12635231e-02, 4.34534377e-02, 4.47525633e-02, 4.49124456e-02,
    4.38268769e-02, 4.16076934e-02, 3.86015476e-02, 3.53110625e-02,
    3.22411669e-02, 2.97442527e-02, 2.79424025e-02, 2.67629551e-02,
    2.60564223e-02, 2.57059550e-02, 2.56469713e-02, 2.58116471e-02,
    2.60768882e-02, 2.62603846e-02, 2.61579281e-02, 2.56003281e-02,
    2.45120759e-02, 2.29488253e-02, 2.10913008e-02, 1.91881922e-02,
    1.74738402e-02, 1.61048600e-02, 1.51421796e-02, 1.45699275e-02,
    1.43248187e-02, 1.43214647e-02, 1.44748304e-02, 1.47265133e-02,
    1.50747137e-02, 1.55938187e-02, 1.64237258e-02, 1.77197432e-02,
    1.95842149e-02, 2.20194514e-02, 2.49268498e-02, 2.81429102e-02,
    3.14845169e-02, 3.47816372e-02, 3.78883747e-02, 4.06745128e-02,
    4.30050983e-02, 4.47211600e-02, 4.56417380e-02, 4.56077158e-02,
    4.45680587e-02, 4.26580172e-02, 4.01844134e-02, 3.74918950e-02,
    3.48032788e-02, 3.21533207e-02, 2.94400211e-02, 2.65331974e-02,
    2.33744218e-02, 2.00312112e-02, 1.66940824e-02, 1.36258649e-02,
    1.10902621e-02, 9.29214899e-03, 8.34828765e-03, 8.28809350e-03,
    9.07115206e-03, 1.06072018e-02, 1.27698982e-02, 1.54016347e-02,
    1.83097597e-02, 2.12563043e-02, 2.39477180e-02, 2.60383029e-02,
    2.71679894e-02, 2.70485869e-02, 2.55827427e-02, 2.29531890e-02,
    1.96051540e-02, 1.61071874e-02, 1.29704871e-02, 1.05306364e-02,
    8.92948472e-03, 8.16274397e-03, 8.13897207e-03, 8.71947250e-03,
    9.73595270e-03, 1.09973571e-02, 1.22972400e-02, 1.34294456e-02,
    1.42157925e-02, 1.45430908e-02, 1.43966715e-02, 1.38717763e-02,
    1.31500670e-02, 1.24485436e-02, 1.19648867e-02, 1.18418582e-02,
    1.21574560e-02, 1.29320171e-02, 1.41396013e-02, 1.57157729e-02,
    1.75606740e-02, 1.95402768e-02, 2.14902443e-02, 2.32278239e-02,
    2.45751276e-02, 2.53931166e-02, 2.56174865e-02, 2.52813827e-02,
    2.45126327e-02, 2.35056347e-02, 2.24799096e-02, 2.16390450e-02,
    2.11370458e-02, 2.10543843e-02, 2.13864269e-02, 2.20467078e-02,
    2.28839900e-02, 2.37098211e-02, 2.43343979e-02, 2.46076377e-02,
    2.44572037e-02, 2.39094451e-02, 2.30810583e-02, 2.21428420e-02,
    2.12716248e-02, 2.06098463e-02, 2.02436216e-02, 2.01980510e-02,
    2.04428016e-02, 2.09018449e-02, 2.14651542e-02, 2.20040959e-02,
    2.23930926e-02, 2.25380764e-02, 2.24059834e-02, 2.20433826e-02,
    2.15731614e-02, 2.11679161e-02, 2.10128738e-02, 2.12753315e-02,
    2.20906887e-02, 2.35631838e-02, 2.57735332e-02, 2.87858917e-02,
    3.26479768e-02, 3.73789914e-02, 4.29364274e-02, 4.91502465e-02,
    5.56175696e-02, 6.15811160e-02, 6.58945563e-02, 6.72715107e-02,
    6.49202163e-02, 5.91970471e-02, 5.15781461e-02, 4.38627382e-02,
    3.73713338e-02, 3.27037268e-02, 2.99220046e-02, 2.88140124e-02,
    2.90671107e-02, 3.03396013e-02, 3.22667014e-02, 3.44381619e-02,
    3.63803906e-02, 3.75785220e-02, 3.75676906e-02, 3.60843360e-02,
    3.32005079e-02, 2.93363521e-02, 2.51177322e-02, 2.11601406e-02,
    1.79006274e-02, 1.55427462e-02, 1.40959841e-02, 1.34501403e-02,
    1.34398062e-02, 1.38853108e-02, 1.46156912e-02, 1.54834839e-02,
    1.63777730e-02, 1.72365127e-02, 1.80542472e-02, 1.88800536e-02,
    1.98035727e-02, 2.09324860e-02, 2.23686409e-02, 2.41894730e-02,
    2.64364581e-02, 2.91078548e-02, 3.21497849e-02, 3.54390202e-02,
    3.87538198e-02, 4.17378131e-02, 4.38820278e-02, 4.45793591e-02,
    4.33130258e-02, 3.99545323e-02, 3.49702136e-02, 2.92935818e-02,
    2.39105399e-02, 1.94934736e-02, 1.63065111e-02, 1.43146977e-02,
    1.33338110e-02, 1.31333764e-02, 1.34845884e-02, 1.41741289e-02,
    1.50054208e-02, 1.58016453e-02, 1.64178458e-02, 1.67620249e-02,
    1.68157107e-02, 1.66392774e-02, 1.63524273e-02, 1.60952176e-02,
    1.59885320e-02, 1.61105858e-02, 1.64931741e-02, 1.71297753e-02,
    1.79856971e-02, 1.90055606e-02, 2.01187488e-02, 2.12472709e-02,
    2.23195363e-02, 2.32904926e-02, 2.41620266e-02, 2.49931442e-02,
    2.58909061e-02, 2.69831273e-02, 2.83845813e-02, 3.01715586e-02,
    3.23733726e-02, 3.49789658e-02, 3.79486516e-02, 4.12164189e-02,
    4.46698046e-02, 4.81028924e-02, 5.11579687e-02, 5.33061452e-02,
    5.39491069e-02, 5.26848473e-02, 4.96037190e-02, 4.53327472e-02,
    4.07347011e-02, 3.65288189e-02, 3.31168033e-02, 3.06254497e-02,
    2.90259102e-02, 2.82308510e-02, 2.81463710e-02, 2.86915507e-02,
    2.98019937e-02, 3.14285592e-02, 3.35368690e-02, 3.61097385e-02,
    3.91519422e-02, 4.26939061e-02, 4.67887037e-02, 5.14969864e-02,
    5.68586218e-02, 6.28530042e-02, 6.93487059e-02, 7.60400766e-02,
    8.23761042e-02, 8.75203975e-02, 9.04354599e-02, 9.01952815e-02,
    8.64772132e-02, 7.98947163e-02, 7.18000720e-02, 6.36523279e-02,
    5.64569303e-02, 5.06051477e-02, 4.60357436e-02, 4.24921082e-02,
    3.97135325e-02, 3.75067656e-02, 3.57267877e-02, 3.42323519e-02,
    3.28672709e-02, 3.14828744e-02, 2.99902707e-02, 2.84124872e-02,
    2.68987481e-02, 2.56809900e-02, 2.49934956e-02, 2.50035319e-02,
    2.57839262e-02, 2.73241112e-02, 2.95570510e-02, 3.23831965e-02,
    3.56843619e-02, 3.93277781e-02, 4.31632835e-02, 4.70161987e-02,
    5.06792964e-02, 5.39100291e-02, 5.64448896e-02, 5.80423096e-02,
    5.85493379e-02, 5.79587617e-02, 5.64133038e-02, 5.41459549e-02,
    5.13942611e-02, 4.83387675e-02, 4.50891755e-02, 4.17094638e-02,
    3.82586054e-02, 3.48246737e-02, 3.15372159e-02, 2.85547756e-02,
    2.60356355e-02, 2.41077090e-02, 2.28506916e-02, 2.22940454e-02,
    2.24258796e-02, 2.32046486e-02, 2.45667993e-02, 2.64275040e-02,
    2.86742716e-02, 3.11561997e-02, 3.36748499e-02, 3.59865514e-02,
    3.78277559e-02, 3.89690575e-02, 3.92854937e-02, 3.88098548e-02,
    3.77339874e-02, 3.63524320e-02, 3.49795040e-02, 3.38810486e-02,
    3.32422144e-02, 3.31666816e-02, 3.36910373e-02, 3.48003290e-02,
    3.64372349e-02, 3.85039690e-02, 4.08608740e-02, 4.33291846e-02,
    4.57064839e-02, 4.77979030e-02, 4.94532255e-02, 5.05907327e-02,
    5.11943921e-02, 5.12911240e-02, 5.09279537e-02, 5.01646120e-02,
    4.90808625e-02, 4.77860639e-02, 4.64182344e-02, 4.51272623e-02,
    4.40458749e-02, 4.32570604e-02, 4.27656422e-02, 4.24806332e-02,
    4.22172909e-02, 4.17330184e-02, 4.08066364e-02, 3.93406121e-02,
    3.74250602e-02, 3.53073765e-02, 3.32835823e-02, 3.15909362e-02,
    3.03618520e-02, 2.96374437e-02, 2.94068843e-02, 2.96439819e-02,
    3.03298549e-02, 3.14613845e-02, 3.30496066e-02, 3.51116398e-02,
    3.76582523e-02, 4.06767997e-02, 4.41081556e-02, 4.78169123e-02,
    5.15594116e-02, 5.49652655e-02, 5.75622165e-02, 5.88755653e-02,
    5.85967199e-02, 5.67423465e-02, 5.36888214e-02, 5.00410046e-02,
    4.64242838e-02, 4.33274074e-02, 4.10514314e-02, 3.97371663e-02,
    3.94192481e-02, 4.00719882e-02, 4.16338690e-02, 4.40099802e-02,
    4.70560359e-02, 5.05518443e-02, 5.41794571e-02, 5.75298952e-02,
    6.01595934e-02, 6.16904093e-02, 6.19092791e-02, 6.08192994e-02,
    5.86338994e-02, 5.57355779e-02, 5.26092669e-02, 4.97528909e-02,
    4.75891904e-02, 4.64138917e-02, 4.63923780e-02, 4.75872285e-02,
    4.99898583e-02, 5.35405317e-02, 5.81337442e-02, 6.36132719e-02,
    6.97590615e-02, 7.62586882e-02, 8.26509438e-02, 8.82513935e-02,
    9.21375943e-02, 9.33389268e-02, 9.12959016e-02, 8.63236021e-02,
    7.95925828e-02, 7.25437152e-02, 6.62495328e-02])

# f_2 = gauss_pulse_f(2, eFreq)
# f_2point5 = gauss_pulse_f(2.5, eFreq)

f_factor = 2.067/0.014449/1e15
# f_factor = 1.0


if 0:   # debug purpose
    plt.xlabel('Frequency')
    plt.ylabel('V_tilt')
    # plt.loglog(eFreq, V_SFQ_squre_tilt_interpolate(eFreq), 'b', linewidth=2)
    plt.loglog(twopointfiveps_xf, f_factor*np.abs(twopointfiveps_yf_v1), 'b', linewidth=2)
    # plt.plot(twopointfiveps_v1)
    plt.show()

if 1:  # paper plot
    fig, axs = plt.subplots(2, figsize=(5, 7), gridspec_kw={'hspace': 0.3})
    label_font = 10
    tick_font = 12
    legend_font = 14
    axs[0].plot(twopointfiveps_t, twopointfiveps_v1, 'b', linewidth=1.5, label='                  ')
    # axs[0].plot(twops_t, twops_v2 * 50, 'b', linewidth=2, label=r'Qubit Port $\times$ 50')
    axs[0].plot(twopointfiveps_t, twopointfiveps_v2 * 50, 'r', linewidth=1, label='                  ')

    axs[0].set_xlim([-50, 1000])
    # axs[0].set_ylim([0.0, 0.8])

    axs[0].tick_params(labelsize=tick_font, direction="in", width=1.5, length=6)
    axs[0].set_xlabel('time (ps)', fontsize=label_font)
    axs[0].set_ylabel('Voltage (mV)', fontsize=label_font)
    axs[0].legend(frameon=False, loc=1, prop={'size': 9})

    # sf = 1e3    # scale factor
    E_qp = 6.626*5*1e-24
    # E_qp = 1.0

    # axs[1].plot(halfps_xf, np.abs(halfps_yf))
    # axs[1].plot(oneps_xf, np.abs(oneps_yf))
    # axs[1].plot(eFreq, f_factor*f_factor*2*V_SFQ_squre_tilt_interpolate(eFreq)/R1/E_qp, 'b', linewidth=2, label='            ')
    axs[1].plot(eFreq, f_factor*f_factor*2*eQubit*eCoupler*V_SFQ_squre_tilt_interpolate(eFreq)/R1/E_qp, 'b', linewidth=2, label='            ')
    axs[1].plot(twopointfiveps_xf * 1000, f_factor*f_factor*2*np.abs(twopointfiveps_yf)**2/R2/E_qp, 'r', linewidth=2, label='            ')
    # axs[1].plot(eFreq, eQubit*eCoupler*f_2*5e6/(eFreq*eFreq), 'k-', label='            ')
    # axs[1].plot(eFreq, eQubit*eCoupler*f_2point5*f_2point5*5e8/(eFreq*eFreq), 'k-', label='            ')
    # axs[1].plot(eFreq, sf*eQubit*eCoupler*f_2point5*f_2point5*100/R1, 'k-', label='            ')
    # axs[1].plot(eFreq, f_2point5*f_2point5*100/R1, 'k-', label='            ')

    # axs[1].plot(twopointfiveps_xf * 1000, V_SFQ_squre_tilt/R1, 'k--', label='            ')
    # print('len(V_SFQ_squre_tilt)=', len(V_SFQ_squre_tilt))
    # print('len(eQubit)=', len(eQubit))
    # print('twopointfiveps_xf=', twopointfiveps_xf*1000)
    # print('eFreq=', eFreq)
    # axs[1].plot(eFreq, f_2)
    # axs[1].plot(fiveps_xf, np.abs(fiveps_yf))
    axs[1].set_xscale('log')
    axs[1].set_yscale('log')
    axs[1].set_xlim([50, 1000])
    axs[1].set_ylim([1e-22, 1e-12])
    # axs[1].set_yticks([0.0, 0.4, 0.8, 1.2])
    axs[1].set_xlabel('Frequency (GHz)', fontsize=label_font)
    # axs[1].set_ylabel('Power Spectral Density', fontsize=label_font)
    axs[1].set_ylabel('Energy Spectral Density ($\Delta$/Hz)', fontsize=label_font)
    # axs[1].tick_params(labelsize=tick_font, direction="in", width=1.5, length=6)

    axs[1].tick_params(labelsize=tick_font, axis="x", direction="in", which='both')
    axs[1].tick_params(labelsize=tick_font, axis="y", direction="in", which='both')

    axs[1].tick_params(axis="x", width=1, length=3, which='minor')
    axs[1].tick_params(axis="x", width=1, length=6, which='major')
    axs[1].tick_params(axis="y", width=1, length=3, which='minor')
    axs[1].tick_params(axis="y", width=1, length=6, which='major')
    axs[1].legend(frameon=False, loc=1, prop={'size': 14})

    path = 'Z:\mcdermott-group\data\sfq\SFQMCMPaperWriting\FromPython'
    plt.savefig(path + '\AntennaSFQPulse.pdf', format='pdf', bbox_inches='tight', dpi=1200)
    plt.show()

# plt.figure(figsize=(6, 4))
# plt.plot(twopointfiveps_t, twopointfiveps_v1, 'b', linewidth=4)
# plt.plot(twopointfiveps_t, twopointfiveps_v2*50, 'r', linewidth=4)
# plt.xlim([0, 100])
# plt.ylim([-0.075, 0.35])
# plt.yticks([0, 0.1, 0.2, 0.3])
# plt.tick_params(labelsize=24, direction="in", width=3, length=12)
#
# path = 'Z:\mcdermott-group\data\sfq\SFQMCMPaperWriting\FromPython'
# plt.savefig(path + '\AntennaSFQPulseZoomIn.pdf', format='pdf', bbox_inches='tight', dpi=1200, transparent=True)
# plt.show()
