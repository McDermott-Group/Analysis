from datetime import datetime
from scipy import signal
from dataChest import *
import os
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

#Q1
biases_data_in=[-0.2, -0.18000000000000002, -0.16000000000000003, -0.14000000000000004, -0.12000000000000005, -0.10000000000000006, -0.08000000000000007, -0.06000000000000008, -0.04000000000000009, -0.0200000000000001, -1.1102230246251565e-16, 0.01999999999999988, 0.03999999999999987, 0.05999999999999989, 0.07999999999999985, 0.09999999999999981, 0.11999999999999983, 0.13999999999999985, 0.1599999999999998, 0.17999999999999977, 0.1999999999999998, 0.2199999999999998, 0.23999999999999977, 0.25999999999999973, 0.27999999999999975, 0.29999999999999977, 0.3199999999999998, -0.21, -0.19, -0.17, -0.15000000000000002, -0.13000000000000003, -0.11000000000000004, -0.09000000000000005, -0.07000000000000006, -0.05000000000000007, -0.030000000000000082, -0.010000000000000092, 0.009999999999999898, 0.029999999999999888, 0.049999999999999906, 0.06999999999999987, 0.08999999999999983, 0.10999999999999985, 0.12999999999999987, 0.14999999999999983, 0.1699999999999998, 0.1899999999999998, 0.20999999999999983, 0.2299999999999998, 0.24999999999999975, 0.2699999999999998, 0.2899999999999998, 0.30999999999999983, -0.06, -0.057999999999999996, -0.055999999999999994, -0.05399999999999999, -0.05199999999999999, -0.04999999999999999, -0.04799999999999999, -0.045999999999999985, -0.043999999999999984, -0.04199999999999998, -0.03999999999999998, -0.03799999999999998, -0.035999999999999976, -0.033999999999999975, -0.03199999999999997, -0.02999999999999997, -0.02799999999999997, -0.025999999999999968, -0.023999999999999966, -0.021999999999999964, -0.019999999999999962, -0.01799999999999996, -0.01599999999999996, -0.013999999999999957, -0.011999999999999955, -0.009999999999999953, -0.007999999999999952, -0.00599999999999995, -0.003999999999999948, -0.0019999999999999463, 5.551115123125783e-17, 0.0020000000000000573, 0.004000000000000059, 0.006000000000000061, 0.008000000000000063, 0.010000000000000064, 0.012000000000000066, 0.014000000000000068, 0.01600000000000007, 0.01800000000000007, 0.020000000000000073, 0.022000000000000075, 0.024000000000000077, 0.02600000000000008, 0.02800000000000008, 0.030000000000000082, 0.032000000000000084, 0.034000000000000086, 0.03600000000000009, 0.03800000000000009, 0.04000000000000009, 0.04200000000000009, 0.044000000000000095, 0.046000000000000096, 0.0480000000000001, 0.0500000000000001, 0.0520000000000001, 0.054000000000000103, 0.056000000000000105, 0.05800000000000011, 0.06000000000000011, 0.06200000000000011, 0.06400000000000011, 0.06600000000000011, 0.06800000000000012, 0.07000000000000012, 0.07200000000000012, 0.07400000000000012, 0.07600000000000012, 0.07800000000000012, 0.08000000000000013, 0.08200000000000013, 0.08400000000000013, 0.08600000000000013, 0.08800000000000013]
parity_rate_data_in=[4254.8354309519045, 4025.044988655798, 3549.09037247466, 2964.339020510612, 2302.6513321772704, 1710.1051158781208, 1278.8423950829058, 973.2448172219578, 731.91138172473, 585.8183239342208, 515.8692916163527, 511.02696333432954, 529.0211198429399, 537.0087845831857, 617.4425362709098, 819.5995000792144, 1121.9847875886765, 1502.4247844335664, 2300.8665250546323, 3472.544985361231, 4949.494150173139, 6187.735524988079, 22.57690882520166, 40.59325367761087, 48.945092330882645, 33.631228301149164, 31.73512919292388, 38.831312078595516, 7394.480603477022, 105.60353916441625, 34.45621405265674, 74.33910355336774, 14.841034637937522, 1487.1048005782322, 1073.3674485011632, 934.1961680059243, 643.5840456480713, 528.1692772379434, 516.6967642941963, 509.1057242887633, 514.2166627755696, 567.6984634359316, 673.1868441694508, 924.7333596867833, 1203.3071645391394, 1641.8399869903164, 2211.4237010832085, 2830.8039457411364, 3424.5984468910874, 3853.361414456382, 4164.640160376726, 4372.1450470169575, 15.323090476733837, 29.6988881864453, 939.3564574997758, 948.6485458331348, 954.6077251629004, 919.8728958840809, 917.6760099055106, 894.2544205914708, 920.6380756144115, 809.9562804717376, 784.2028898103225, 769.8699698636044, 736.6797269246919, 716.8398232468134, 699.4910975379378, 691.6916413893168, 673.4018990244741, 664.2440287613366, 637.7177098969028, 637.9776157743032, 616.632770109728, 599.207451968575, 593.7115975196667, 587.7977782660166, 582.0125640436254, 571.375429706195, 552.7972717972165, 541.7302895209405, 547.8311270008612, 542.451709718839, 544.9534321554336, 520.448387943147, 526.9450640479085, 539.8058963985208, 517.5831150354248, 528.3692155440904, 530.2933880263184, 529.2282406253419, 513.1916007039167, 513.8987272627855, 519.7403448717164, 512.2815131702783, 514.8155778803648, 522.6981731136672, 525.2646380274002, 506.63423976866454, 520.0930072925453, 520.363577977929, 519.7369685572642, 531.1736629549698, 500.575110056812, 516.9904418206609, 523.7289969808538, 524.8809153624023, 524.0978190267177, 508.863000504972, 515.5047707369392, 508.1765157242161, 520.4405076761807, 517.1071721007996, 534.9412382873003, 531.6430162920188, 536.2223291144046, 526.2149639355147, 536.3502298488218, 541.4525423222995, 558.9711937296811, 561.0684922417385, 568.9535635963186, 587.3486965172534, 586.1394709970743, 600.7356075846498, 610.6955262057447, 642.7668093721956, 656.5260009897708, 665.9318852336352, 691.0483379934013]

#at -1500uA Flux Bias
biases_data=[-0.23, -0.22, -0.21, -0.19999999999999998, -0.18999999999999997, -0.17999999999999997, -0.16999999999999996, -0.15999999999999995, -0.14999999999999994, -0.13999999999999993, -0.12999999999999992, -0.11999999999999991, -0.1099999999999999]+[-0.0999999999999999, -0.08999999999999989, -0.07999999999999988, -0.06999999999999987, -0.05999999999999986, -0.04999999999999985, -0.03999999999999984, -0.029999999999999832, -0.019999999999999823, -0.009999999999999815]+[-0.009999999999999815, 1.942890293094024e-16, 0.010000000000000203, 0.020000000000000212, 0.03000000000000022, 0.04000000000000023, 0.05000000000000024, 0.06000000000000025, 0.07000000000000026, 0.08000000000000027, 0.09000000000000027, 0.10000000000000028, 0.11000000000000029, 0.1200000000000003, 0.1300000000000003, 0.14000000000000032, 0.15000000000000033, 0.16000000000000034, 0.17000000000000035, 0.18000000000000035, 0.19000000000000036, 0.20000000000000037, 0.21000000000000038, 0.2200000000000004, 0.2300000000000004, 0.2400000000000004, 0.25000000000000044, 0.26000000000000045, 0.27000000000000046]
biases_data+=[-0.086, -0.08399999999999999, -0.08199999999999999, -0.07999999999999999, -0.07799999999999999, -0.07599999999999998, -0.07399999999999998, -0.07199999999999998, -0.06999999999999998, -0.06799999999999998, -0.06599999999999998, -0.06399999999999997, -0.06199999999999997, -0.05999999999999997, -0.05799999999999997, -0.055999999999999966, -0.053999999999999965, -0.05199999999999996, -0.04999999999999996, -0.04799999999999996, -0.04599999999999996, -0.043999999999999956, -0.041999999999999954, -0.03999999999999995, -0.03799999999999995, -0.03599999999999995, -0.03399999999999995, -0.031999999999999945, -0.029999999999999943, -0.02799999999999994, -0.02599999999999994, -0.023999999999999938, -0.021999999999999936, -0.019999999999999934, -0.017999999999999933, -0.01599999999999993, -0.01399999999999993, -0.011999999999999927, -0.009999999999999926, -0.007999999999999924, -0.005999999999999922, -0.00399999999999992, -0.0019999999999999185, 8.326672684688674e-17, 0.002000000000000085, 0.004000000000000087, 0.006000000000000089, 0.00800000000000009, 0.010000000000000092, 0.012000000000000094, 0.014000000000000096, 0.016000000000000097, 0.0180000000000001, 0.0200000000000001, 0.022000000000000103, 0.024000000000000105, 0.026000000000000106, 0.028000000000000108, 0.03000000000000011, 0.03200000000000011, 0.03400000000000011, 0.036000000000000115, 0.03800000000000012, 0.04000000000000012, 0.04200000000000012, 0.04400000000000012, 0.046000000000000124, 0.048000000000000126, 0.05000000000000013, 0.05200000000000013, 0.05400000000000013, 0.05600000000000013, 0.058000000000000135, 0.06000000000000014, 0.06200000000000014, 0.06400000000000014, 0.06600000000000014, 0.06800000000000014, 0.07000000000000015, 0.07200000000000015, 0.07400000000000015, 0.07600000000000015, 0.07800000000000015, 0.08000000000000015, 0.08200000000000016, 0.08400000000000016, 0.08600000000000016, 0.08800000000000016, 0.09000000000000016, 0.09200000000000016, 0.09400000000000017, 0.09600000000000017, 0.09800000000000017, 0.10000000000000017, 0.10200000000000017, 0.10400000000000018, 0.10600000000000018, 0.10800000000000018, 0.11000000000000018, 0.11200000000000018, 0.11400000000000018, 0.11600000000000019, 0.11800000000000019, 0.12000000000000019, 0.12200000000000019, 0.1240000000000002, 0.1260000000000002, -0.087, -0.08499999999999999, -0.08299999999999999, -0.08099999999999999, -0.07899999999999999, -0.07699999999999999, -0.07499999999999998, -0.07299999999999998, -0.07099999999999998, -0.06899999999999998, -0.06699999999999998, -0.06499999999999997, -0.06299999999999997, -0.06099999999999997, -0.05899999999999997, -0.05699999999999997, -0.054999999999999966, -0.052999999999999964, -0.05099999999999996, -0.04899999999999996, -0.04699999999999996, -0.04499999999999996, -0.042999999999999955, -0.04099999999999995, -0.03899999999999995, -0.03699999999999995, -0.03499999999999995, -0.032999999999999946, -0.030999999999999944, -0.028999999999999942, -0.02699999999999994, -0.02499999999999994, -0.022999999999999937, -0.020999999999999935, -0.018999999999999934, -0.016999999999999932, -0.01499999999999993, -0.012999999999999928, -0.010999999999999927, -0.008999999999999925, -0.006999999999999923, -0.004999999999999921, -0.0029999999999999194, -0.0009999999999999176, 0.0010000000000000842, 0.003000000000000086, 0.005000000000000088, 0.0070000000000000895, 0.009000000000000091, 0.011000000000000093, 0.013000000000000095, 0.015000000000000097, 0.0170000000000001, 0.0190000000000001, 0.021000000000000102, 0.023000000000000104, 0.025000000000000105, 0.027000000000000107, 0.02900000000000011, 0.03100000000000011, 0.03300000000000011, 0.035000000000000114, 0.037000000000000116, 0.03900000000000012, 0.04100000000000012, 0.04300000000000012, 0.04500000000000012, 0.047000000000000125, 0.04900000000000013, 0.05100000000000013, 0.05300000000000013, 0.05500000000000013, 0.057000000000000134, 0.059000000000000136, 0.06100000000000014, 0.06300000000000014, 0.06500000000000014, 0.06700000000000014, 0.06900000000000014, 0.07100000000000015, 0.07300000000000015, 0.07500000000000015, 0.07700000000000015, 0.07900000000000015, 0.08100000000000016, 0.08300000000000016, 0.08500000000000016, 0.08700000000000016, 0.08900000000000016, 0.09100000000000016, 0.09300000000000017, 0.09500000000000017, 0.09700000000000017, 0.09900000000000017, 0.10100000000000017, 0.10300000000000017, 0.10500000000000018, 0.10700000000000018, 0.10900000000000018, 0.11100000000000018, 0.11300000000000018, 0.11500000000000019, 0.11700000000000019, 0.11900000000000019, 0.12100000000000019, 0.12300000000000019, 0.1250000000000002, 0.1270000000000002]

parity_rate_data=[4352.8619290474835, 4324.6741296689015, 4185.439926080219, 4021.672270382183, 3869.5722110136785, 3717.891235239366, 3515.7403323454573, 3250.4349241918017, 2860.2231154485585, 2566.74214190265, 2297.0656584846415, 2186.569680890676, 1926.3300192155957]+[1590.1427719735136, 1408.349572293922, 1324.5945674613595, 1478.948063988584, 1391.372057643555, 1560.1913692870132, 933.7380913402126, 834.7181131457261, 748.0732942048238, 528.1476640251769]+[528.1476640251769, 480.50634850176834, 479.0375643650899, 486.4817111593079, 472.08448651911186, 477.6294859958818, 485.52857221326695, 494.4615870180419, 662.2101567472786, 838.2313097951362, 926.7080353742681, 1283.5241886574631, 1640.8995858805374, 1657.30490845654, 1507.836835992653, 1523.998104033416, 1794.3693742440382, 1869.8744904003756, 2233.6676513331845, 2440.6707504111105, 2655.1901122703975, 3064.8462494165615, 3356.2085872617095, 3742.7535535439415, 4179.646574065518, 4274.923385354326, 19.852969742851275, 21.395099781950695, 26.717863469227435]
parity_rate_data+=[1484.581566357603, 1419.9886681109172, 1398.7766618516762, 1418.0239218132094, 1589.573442512057, 1518.0767876793645, 1546.0515838568913, 1627.6530894426817, 1769.9287333070813, 2020.5504176777065, 1928.2497631204897, 1986.8108542322414, 1606.7303700406444, 1927.1654387253905, 1744.1464104737738, 31.540939177830875, 29.793475921388303, 27.662340690008687, 2044.6414138024775, 2251.903067494188, 36.46026431908659, 24.844309223606498, 23.86498408323111, 1209.6502357029672, 890.7904697850563, 866.6280479495554, 860.3312099661122, 823.4360891097591, 817.2370517621529, 786.9289986046854, 750.3134983638076, 758.1624698166205, 732.5284935794973, 718.8650689875841, 672.1495549699151, 626.9836555499962, 588.1263140788366, 560.4821739717079, 519.9134083636861, 494.9198263557782, 469.37784556744543, 466.28639049370787, 497.75003593332383, 461.15555235676135, 472.4210126609307, 455.2061834041536, 459.7318770959593, 467.600335768965, 484.1587390131183, 463.6668011342546, 471.2476097794757, 466.18798651964, 488.4199588822283, 478.91743729012484, 477.525175892698, 481.48739851811183, 489.0913627285609, 480.0604326977449, 499.06754669855746, 488.8722713400098, 480.4714481468744, 474.5951262917472, 462.0795426222396, 456.3272540227028, 453.2747707449197, 449.479905165572, 454.93396745952793, 450.5972403687334, 467.631012786769, 460.84331793574125, 454.534638462352, 464.21938158488786, 456.3971216167079, 476.13984459781943, 479.57614095256844, 503.8162385552535, 532.0159648481866, 558.3922020443677, 593.4948130662871, 629.4497452401607, 684.3345342737342, 719.7259875774893, 714.2516167093435, 733.2041502545546, 766.9849082973678, 803.0011533080276, 806.181655339123, 818.4661495607935, 842.1942955394271, 906.6132307641783, 890.4029623958985, 938.0707596225328, 977.3308962336822, 1079.3376862534187, 1238.1495425498251, 1358.7919192355764, 1406.9973672236965, 1415.5221531369064, 1414.5007660014824, 1393.8565515223681, 1374.7171349616065, 1360.9742551288784, 1382.58558120227, 1403.9871982094164, 1431.165787555181, 1421.5595855063746, 1474.024422532332, 1286.4553617267802, 1251.7611273840735, 1296.4637541679938, 1276.6147400543693, 1278.4601793224208, 1327.2679502388787, 1363.7922692774885, 1422.462070564221, 1444.2661172774135, 1422.7641997172475, 1422.9532380456205, 1378.750020194295, 1413.6866715079334, 1373.2850689629258, 1398.574641593622, 1436.1248519408468, 1466.8857623694876, 1440.5605097170053, 1451.3232053032386, 1452.118172804352, 1216.1673043112946, 1067.842147976669, 947.6568076186442, 914.5905235746608, 889.84874899134, 901.5035520856612, 868.149257387673, 816.728500568761, 825.6353330229008, 802.573813435199, 774.0936092360735, 755.8888584830695, 705.816107478012, 684.1583284992402, 679.5485398104584, 726.9068445702579, 645.0205914463431, 574.4666774334555, 551.4916842759828, 499.91729664281326, 480.4641820553872, 460.9820492816405, 461.0384259082824, 469.14308164618274, 469.1692405880393, 461.0793212265241, 473.6992625468879, 493.9486336382011, 523.8534428572949, 509.5140662443864, 491.5476324305888, 497.92977479230046, 474.76327929950423, 475.2436972860893, 470.05490453825087, 465.3938437056704, 466.8195823511119, 472.0552181619397, 480.26093775335414, 479.81043689637056, 486.6206581267447, 468.2600416756479, 517.9334678828786, 37.166519227914264, 38.41480743521046, 4394.9834228872905, 27.529233001716, 1031.0215009849642, 517.2745461901413, 475.73303667457424, 443.2892843757236, 592.9933118618764, 532.6426250586649, 573.7467653809543, 587.158275532389, 619.9979924316286, 690.1186296327214, 746.6459417058654, 700.8266614731781, 800.736837045127, 827.7769145940691, 716.5385624252406, 730.7210811193979, 775.0650311938999, 836.3233243189525, 927.662253719981, 930.6743257874964, 941.3618690123787, 987.3012436101127, 989.666119048717, 996.4580741071911, 992.039675784956, 1044.28898892997, 1127.569710765131, 1258.4401908384725, 1434.9722556159759, 1516.467359608174, 1433.4284745906848, 1433.1782865449993, 1381.5247741629285, 1326.312218511513, 1344.471520004025, 1378.1381834614692, 1420.9654108528168, 1386.3454756775157, 1390.7752834136027, 1430.085518656828, 1439.271786692096]
#Q3
biases_data_Q3=[-0.23, -0.22, -0.21, -0.19999999999999998, -0.18999999999999997, -0.17999999999999997, -0.16999999999999996, -0.15999999999999995, -0.14999999999999994, -0.13999999999999993, -0.12999999999999992, -0.11999999999999991, -0.1099999999999999, -0.0999999999999999, -0.08999999999999989, -0.07999999999999988, -0.06999999999999987, -0.05999999999999986, -0.04999999999999985, -0.03999999999999984, -0.029999999999999832, -0.019999999999999823, -0.009999999999999815, 1.942890293094024e-16, 0.010000000000000203, 0.020000000000000212, 0.03000000000000022, 0.04000000000000023, 0.05000000000000024, 0.06000000000000025, 0.07000000000000026, 0.08000000000000027, 0.09000000000000027, 0.10000000000000028, 0.11000000000000029, 0.1200000000000003, 0.1300000000000003, 0.14000000000000032, 0.15000000000000033, 0.16000000000000034, 0.17000000000000035, 0.18000000000000035, 0.19000000000000036, 0.20000000000000037, 0.21000000000000038, 0.2200000000000004, 0.2300000000000004, 0.2400000000000004, 0.25000000000000044, 0.26000000000000045, 0.27000000000000046, -0.086, -0.08399999999999999, -0.08199999999999999, -0.07999999999999999, -0.07799999999999999, -0.07599999999999998, -0.07399999999999998, -0.07199999999999998, -0.06999999999999998, -0.06799999999999998, -0.06599999999999998, -0.06399999999999997, -0.06199999999999997, -0.05999999999999997, -0.05799999999999997, -0.055999999999999966, -0.053999999999999965, -0.05199999999999996, -0.04999999999999996, -0.04799999999999996, -0.04599999999999996, -0.043999999999999956, -0.041999999999999954, -0.03999999999999995, -0.03799999999999995, -0.03599999999999995, -0.03399999999999995, -0.031999999999999945, -0.029999999999999943, -0.02799999999999994, -0.02599999999999994, -0.023999999999999938, -0.021999999999999936, -0.019999999999999934, -0.017999999999999933, -0.01599999999999993, -0.01399999999999993, -0.011999999999999927, -0.009999999999999926, -0.007999999999999924, -0.005999999999999922, -0.00399999999999992, -0.0019999999999999185, 8.326672684688674e-17, 0.002000000000000085, 0.004000000000000087, 0.006000000000000089, 0.00800000000000009, 0.010000000000000092, 0.012000000000000094, 0.014000000000000096, 0.016000000000000097, 0.0180000000000001, 0.0200000000000001]+[0.0200000000000001, 0.022000000000000103, 0.024000000000000105, 0.026000000000000106, 0.028000000000000108, 0.03000000000000011, 0.03200000000000011, 0.03400000000000011, 0.036000000000000115, 0.03800000000000012, 0.04000000000000012, 0.04200000000000012, 0.04400000000000012, 0.046000000000000124, 0.048000000000000126, 0.05000000000000013, 0.05200000000000013, 0.05400000000000013, 0.05600000000000013, 0.058000000000000135, 0.06000000000000014, 0.06200000000000014, 0.06400000000000014, 0.06600000000000014, 0.06800000000000014, 0.07000000000000015, 0.07200000000000015, 0.07400000000000015, 0.07600000000000015, 0.07800000000000015, 0.08000000000000015]+[0.08000000000000015, 0.08200000000000016, 0.08400000000000016, 0.08600000000000016, 0.08800000000000016, 0.09000000000000016, 0.09200000000000016, 0.09400000000000017, 0.09600000000000017, 0.09800000000000017, 0.10000000000000017, 0.10200000000000017, 0.10400000000000018, 0.10600000000000018, 0.10800000000000018, 0.11000000000000018, 0.11200000000000018, 0.11400000000000018, 0.11600000000000019, 0.11800000000000019, 0.12000000000000019, 0.12200000000000019, 0.1240000000000002]
parity_rate_data_Q3=[4585.0384027868595, 4538.739447183097, 4473.641913594156, 4395.455338022558, 4218.903228412171, 4057.251143243847, 3947.0100607027293, 3677.361340065246, 3277.293334313241, 3178.660912578685, 4060.1217899901867, 3683.817750894962, 2434.1721264105754, 1921.2972399067235, 1682.3017022136794, 1463.101862649987, 7176.39312314772, 315.3862825063121, 1629.2303220427436, 1113.187351891625, 1029.5426478028605, 823.1038569952714, 618.6121729991078, 539.8610473049292, 25.737013875538388, 9999.802425667882, 2517.6178695658728, 2079.5030053091223, 715.3506611446729, 673.3878053677331, 29.36075032391231, 10.000079841135765, 1016.0440752505784, 1245.8176017246128, 1499.3656609762043, 1278.4668656141337, 1390.2944333260555, 1563.1580369779804, 1756.5194946621825, 2093.7757952507422, 2467.552100543232, 2824.4934781458483, 2908.134454520922, 3205.508766871172, 3546.5291394514907, 3827.1934539062345, 5953.817705959159, 33.28432357694396, 32.265297291816964, 31.723233492465422, 41.524668369645966, 1581.264083087569, 1559.5738183505225, 1512.90664640742, 1486.9837764078031, 1441.908310737864, 1392.6083116661885, 1366.6567510505488, 1343.6960808567042, 1321.4446251870186, 1293.8539926594913, 1261.3637153354523, 1296.2331525404384, 1321.3873846352722, 1378.5005946185106, 1394.6547494045144, 1471.0397186232144, 1499.3466372358455, 1530.989783396921, 1600.9270437333469, 1537.212722558515, 1318.288478318913, 1195.1565965915224, 1106.2080853501334, 1048.1208956381386, 1051.7002038607984, 1018.4950764295853, 1029.5386320668645, 976.539531347189, 997.1978459105482, 947.5447738648686, 919.8848393258414, 872.6753703545448, 850.4809634133464, 791.9645163911306, 757.5327883043907, 707.9417636766815, 669.7671980114529, 658.01568180064, 623.7077233443049, 580.6435039708306, 564.5126396831364, 555.1539508255241, 525.9774172234892, 540.6553107546008, 543.5366085455618, 539.6608240551094, 524.873167357142, 544.0700050183872, 527.4852691045337, 527.3726392966488, 539.8685070816834, 542.4707338599161, 524.8301515250388, 537.6267904827611]+[537.6267904827611, 540.9748471440847, 544.360793836746, 534.8685466654474, 536.7100831167957, 542.7971345213282, 541.5111926417691, 529.7721137575427, 541.5318972721021, 523.1920082616604, 536.3100961426879, 535.0842972038247, 530.740205864999, 540.345262700669, 532.4637802782779, 536.6321480080319, 521.9939498147723, 521.5021874091079, 541.0181926158683, 551.1837790442565, 541.3748494135339, 558.238827178536, 578.3981673321807, 627.8220029823012, 644.1494917013123, 699.1844050458226, 739.8438028685603, 785.1117315172505, 823.470249867888, 873.9710956526717, 895.5172743027252]+[895.5172743027252, 931.5453929689259, 977.1928473360864, 982.1033518923724, 1022.5858409675743, 1026.199753353408, 1049.7821181596532, 1054.4255312935811, 1081.1105150044923, 1140.7008628332087, 1266.8218555760566, 1400.1655980453875, 1561.7120389253628, 1547.0496831136065, 1497.2313408086325, 1497.105704242333, 1423.322269477896, 1381.8980488125135, 1336.2140188497497, 1302.860251756133, 1304.7445949049047, 1279.4654974877417, 1281.8642633277218]

biases=[]
parity_rate=[]
for i in range(len(parity_rate_data)):
    if parity_rate_data[i] < 5000 and parity_rate_data[i] > 0:
        biases.append(biases_data[i])
        parity_rate.append(parity_rate_data[i])

biases_in=[]
parity_rate_in=[]
for i in range(len(parity_rate_data_in)):
    if parity_rate_data_in[i] < 5000 and parity_rate_data_in[i] > 0:
        biases_in.append(biases_data_in[i])
        parity_rate_in.append(parity_rate_data_in[i])

biases_Q3=[]
parity_rate_Q3=[]
for i in range(len(parity_rate_data_Q3)):
    if parity_rate_data_Q3[i] < 5000 and parity_rate_data_Q3[i] > 0:
        biases_Q3.append(biases_data_Q3[i])
        parity_rate_Q3.append(parity_rate_data_Q3[i])

plt.title('Parity Rate vs Radiator Bias')
# plt.plot(4*times, np.abs(I + Q * 1j))
plt.semilogy([(b-0.028)*(490)*(0.02)*484 for b in biases_Q3], parity_rate_Q3,marker='+',linestyle='None')
plt.semilogy([(b-0.028)*(490)*(0.02)*484 for b in biases], parity_rate,marker='.',linestyle='None')
plt.semilogy([(b-0.028)*(490)*(0.02)*484 for b in biases_in], parity_rate_in,marker='x',linestyle='None')


plt.grid(which='both')
plt.ylim(4e2,4e3)
plt.xlim(0,500)
# plt.xlabel('Radiator Bias (mV)')
plt.xlabel('Radiator Frequency (GHz)')
plt.ylabel('Parity Rate (Hz)')
plt.pause(0.1)

print([(b,(b-0.05)*(490)*(0.02)*484) for b in biases])

